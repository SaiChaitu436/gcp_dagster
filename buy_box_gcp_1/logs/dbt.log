[0m13:47:55.964889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539E73DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539E73EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539E6294C0>]}


============================== 13:47:55.964889 | 29a27b51-67fb-417d-bfb8-3d287ee9aaa6 ==============================
[0m13:47:55.964889 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:47:55.964889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:57.362647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B2190D40>]}
[0m13:47:57.425544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B2034CE0>]}
[0m13:47:57.425544 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:47:57.425544 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:47:57.425544 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:47:57.425544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B22144A0>]}
[0m13:47:58.348887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buy_box_gcp_1.example
[0m13:47:58.348887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B25E9910>]}
[0m13:47:58.451958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B25989E0>]}
[0m13:47:58.451958 [info ] [MainThread]: Found 10 models, 478 macros
[0m13:47:58.451958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a27b51-67fb-417d-bfb8-3d287ee9aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B25A1DF0>]}
[0m13:47:58.451958 [info ] [MainThread]: 
[0m13:47:58.451958 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:58.459510 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m13:47:58.459510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:58.459510 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json''
[0m13:47:58.459510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:58.459510 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m13:47:58.459510 [info ] [MainThread]: 
[0m13:47:58.459510 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m13:47:58.459510 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json'
[0m13:47:58.459510 [debug] [MainThread]: Command `dbt run` failed at 13:47:58.459510 after 2.63 seconds
[0m13:47:58.459510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539ED58530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015398DC9B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153B25BCAA0>]}
[0m13:47:58.459510 [debug] [MainThread]: Flushing usage events
[0m13:48:24.776816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CC128BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CC0F0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CB40C6E0>]}


============================== 13:48:24.776816 | 91c466ec-5455-42b2-bda3-ae90812094ed ==============================
[0m13:48:24.776816 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:48:24.776816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:48:25.997882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CB397830>]}
[0m13:48:26.061096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CBFFBE30>]}
[0m13:48:26.061096 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:48:26.061096 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:48:26.119974 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:26.119974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF77C9B0>]}
[0m13:48:26.956615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF8ECBF0>]}
[0m13:48:27.022032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF9BB680>]}
[0m13:48:27.033097 [info ] [MainThread]: Found 10 models, 478 macros
[0m13:48:27.033097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91c466ec-5455-42b2-bda3-ae90812094ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF7BE3F0>]}
[0m13:48:27.033097 [info ] [MainThread]: 
[0m13:48:27.033097 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:48:27.033097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m13:48:27.033097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:27.033097 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json''
[0m13:48:27.033097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:27.033097 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m13:48:27.033097 [info ] [MainThread]: 
[0m13:48:27.033097 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:48:27.045354 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json'
[0m13:48:27.046769 [debug] [MainThread]: Command `dbt run` failed at 13:48:27.046769 after 2.38 seconds
[0m13:48:27.047827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CC0A21E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF72AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282DF8EA690>]}
[0m13:48:27.047827 [debug] [MainThread]: Flushing usage events
[0m13:49:51.917556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371A452720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CEAA8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CEA97F0>]}


============================== 13:49:51.917556 | 02e8d628-fc24-42f7-b5a1-b91cd5be5a80 ==============================
[0m13:49:51.917556 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:49:51.917556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:51.933213 [info ] [MainThread]: dbt version: 1.8.6
[0m13:49:51.944817 [info ] [MainThread]: python version: 3.12.6
[0m13:49:51.944817 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:49:51.947325 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:49:53.015669 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:49:53.015669 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:49:53.015669 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m13:49:53.015669 [info ] [MainThread]: adapter type: bigquery
[0m13:49:53.015669 [info ] [MainThread]: adapter version: 1.8.2
[0m13:49:53.102200 [info ] [MainThread]: Configuration:
[0m13:49:53.103198 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:49:53.103932 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:53.104858 [info ] [MainThread]: Required dependencies:
[0m13:49:53.105380 [debug] [MainThread]: Executing "git --help"
[0m13:49:53.147518 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:53.147518 [debug] [MainThread]: STDERR: "b''"
[0m13:49:53.147518 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:53.147518 [info ] [MainThread]: Connection:
[0m13:49:53.147518 [info ] [MainThread]:   method: service-account
[0m13:49:53.147518 [info ] [MainThread]:   database: dbt-437212
[0m13:49:53.153857 [info ] [MainThread]:   execution_project: dbt-437212
[0m13:49:53.153857 [info ] [MainThread]:   schema: wellbefore
[0m13:49:53.155314 [info ] [MainThread]:   location: US
[0m13:49:53.155314 [info ] [MainThread]:   priority: interactive
[0m13:49:53.155314 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:49:53.155314 [info ] [MainThread]:   impersonate_service_account: None
[0m13:49:53.155314 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:49:53.155314 [info ] [MainThread]:   job_retries: 1
[0m13:49:53.155314 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:49:53.155314 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:49:53.155314 [info ] [MainThread]:   timeout_seconds: 300
[0m13:49:53.155314 [info ] [MainThread]:   client_id: None
[0m13:49:53.155314 [info ] [MainThread]:   token_uri: None
[0m13:49:53.155314 [info ] [MainThread]:   dataproc_region: None
[0m13:49:53.155314 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:49:53.155314 [info ] [MainThread]:   gcs_bucket: None
[0m13:49:53.155314 [info ] [MainThread]:   dataproc_batch: None
[0m13:49:53.155314 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:49:53.155314 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:49:53.155314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:53.155314 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json''
[0m13:49:53.155314 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:49:53.155314 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:49:53.155314 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-db8b5c64db8b36.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:49:53.155314 [debug] [MainThread]: Command `dbt debug` failed at 13:49:53.155314 after 1.35 seconds
[0m13:49:53.155314 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:49:53.155314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CC69BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001372FF7B800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371AAF2780>]}
[0m13:49:53.155314 [debug] [MainThread]: Flushing usage events
[0m13:51:05.352646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002625DA925A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002625DA92750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002625DA932C0>]}


============================== 13:51:05.352646 | 37342de5-d690-47be-bddd-9313ff4c1b48 ==============================
[0m13:51:05.352646 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:51:05.352646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:51:05.373316 [info ] [MainThread]: dbt version: 1.8.6
[0m13:51:05.373316 [info ] [MainThread]: python version: 3.12.6
[0m13:51:05.373316 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:51:05.373316 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:51:06.717563 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:51:06.717563 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:51:06.717563 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m13:51:06.717563 [info ] [MainThread]: adapter type: bigquery
[0m13:51:06.717563 [info ] [MainThread]: adapter version: 1.8.2
[0m13:51:06.816386 [info ] [MainThread]: Configuration:
[0m13:51:06.817387 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:51:06.817387 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:51:06.818385 [info ] [MainThread]: Required dependencies:
[0m13:51:06.819382 [debug] [MainThread]: Executing "git --help"
[0m13:51:06.856973 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:51:06.856973 [debug] [MainThread]: STDERR: "b''"
[0m13:51:06.856973 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:51:06.856973 [info ] [MainThread]: Connection:
[0m13:51:06.856973 [info ] [MainThread]:   method: service-account
[0m13:51:06.856973 [info ] [MainThread]:   database: dbt-437212
[0m13:51:06.856973 [info ] [MainThread]:   execution_project: dbt-437212
[0m13:51:06.856973 [info ] [MainThread]:   schema: wellbefore
[0m13:51:06.856973 [info ] [MainThread]:   location: US
[0m13:51:06.856973 [info ] [MainThread]:   priority: interactive
[0m13:51:06.856973 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:51:06.871967 [info ] [MainThread]:   impersonate_service_account: None
[0m13:51:06.871967 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:51:06.873284 [info ] [MainThread]:   job_retries: 1
[0m13:51:06.873284 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:51:06.873284 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:51:06.873284 [info ] [MainThread]:   timeout_seconds: 300
[0m13:51:06.873284 [info ] [MainThread]:   client_id: None
[0m13:51:06.873284 [info ] [MainThread]:   token_uri: None
[0m13:51:06.873284 [info ] [MainThread]:   dataproc_region: None
[0m13:51:06.873284 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:51:06.873284 [info ] [MainThread]:   gcs_bucket: None
[0m13:51:06.873284 [info ] [MainThread]:   dataproc_batch: None
[0m13:51:06.873284 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:51:06.873284 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:51:06.873284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:06.923863 [debug] [MainThread]: On debug: select 1 as id
[0m13:51:08.429061 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:96338def-d4d1-467d-993e-81069c9c6c5d&page=queryresults
[0m13:51:09.320989 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:51:09.336625 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:51:09.336625 [debug] [MainThread]: Command `dbt debug` succeeded at 13:51:09.336625 after 4.10 seconds
[0m13:51:09.336625 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:51:09.336625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002625B4F68A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026270BDA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262706D7C50>]}
[0m13:51:09.336625 [debug] [MainThread]: Flushing usage events
[0m13:51:25.651367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD3609C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD3609CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD3609D90>]}


============================== 13:51:25.656591 | 0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3 ==============================
[0m13:51:25.656591 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:51:25.656591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_shipping', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:27.453794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE67B90D0>]}
[0m13:51:27.531903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE6344B60>]}
[0m13:51:27.531903 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:51:27.531903 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:51:27.692235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:27.693235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:27.722474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE68DC770>]}
[0m13:51:27.817107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE6A69DF0>]}
[0m13:51:27.817107 [info ] [MainThread]: Found 10 models, 478 macros
[0m13:51:27.817107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE6BDBC20>]}
[0m13:51:27.817107 [info ] [MainThread]: 
[0m13:51:27.817107 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:51:27.817107 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m13:51:27.817107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:29.068109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m13:51:29.069179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:30.308094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE6474860>]}
[0m13:51:30.308094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:30.308094 [info ] [MainThread]: 
[0m13:51:30.323724 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m13:51:30.326019 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_shipping ............................ [RUN]
[0m13:51:30.327071 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_shipping'
[0m13:51:30.328319 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m13:51:30.339343 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m13:51:30.343476 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m13:51:30.374743 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m13:51:30.374743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:30.425455 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m13:51:31.942690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:b83ffa54-5e79-40ef-a1dc-a72745a39ac8&page=queryresults
[0m13:51:31.942690 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:b83ffa54-5e79-40ef-a1dc-a72745a39ac8&page=queryresults
[0m13:51:31.942690 [debug] [Thread-1 (]: Database Error in model src_shipping (models\src\src_shipping.sql)
  Access Denied: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp_1\models\src\src_shipping.sql
[0m13:51:31.959476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f281f2a-b05b-4d3b-9ccc-c1dcd92398d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD2E775C0>]}
[0m13:51:31.960148 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_shipping ................... [[31mERROR[0m in 1.62s]
[0m13:51:31.960437 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m13:51:31.960437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:31.960437 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m13:51:31.960437 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m13:51:31.960437 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m13:51:31.960437 [info ] [MainThread]: 
[0m13:51:31.960437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m13:51:31.960437 [debug] [MainThread]: Command end result
[0m13:51:31.992267 [info ] [MainThread]: 
[0m13:51:31.992267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:31.992267 [info ] [MainThread]: 
[0m13:51:31.992267 [error] [MainThread]:   Database Error in model src_shipping (models\src\src_shipping.sql)
  Access Denied: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp_1\models\src\src_shipping.sql
[0m13:51:31.992267 [info ] [MainThread]: 
[0m13:51:31.992267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:51:32.008524 [debug] [MainThread]: Command `dbt run` failed at 13:51:32.006920 after 6.51 seconds
[0m13:51:32.008524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD2A2F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE68DECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DD3354F50>]}
[0m13:51:32.008524 [debug] [MainThread]: Flushing usage events
[0m13:52:33.685275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195D8234A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195DDB26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195D6A5A60>]}


============================== 13:52:33.685275 | 5007cfdb-e5d7-4a28-b577-129c2096d469 ==============================
[0m13:52:33.685275 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:52:33.685275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:35.347537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5007cfdb-e5d7-4a28-b577-129c2096d469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195E1896A0>]}
[0m13:52:35.420726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5007cfdb-e5d7-4a28-b577-129c2096d469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002196DE593A0>]}
[0m13:52:35.421737 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:52:35.424243 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:52:35.556934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:35.556934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:35.588216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5007cfdb-e5d7-4a28-b577-129c2096d469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219712FB860>]}
[0m13:52:35.682389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5007cfdb-e5d7-4a28-b577-129c2096d469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197157AC90>]}
[0m13:52:35.682389 [info ] [MainThread]: Found 10 models, 478 macros
[0m13:52:35.682389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5007cfdb-e5d7-4a28-b577-129c2096d469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219713A3AA0>]}
[0m13:52:35.682389 [info ] [MainThread]: 
[0m13:52:35.682389 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:52:35.692366 [debug] [MainThread]: Command end result
[0m13:52:35.710114 [info ] [MainThread]: 
[0m13:52:35.725198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:35.726377 [info ] [MainThread]: 
[0m13:52:35.726377 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m13:52:35.726377 [debug] [MainThread]: Command `dbt seed` succeeded at 13:52:35.726377 after 2.16 seconds
[0m13:52:35.726377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195DDB26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197124B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219712FA690>]}
[0m13:52:35.726377 [debug] [MainThread]: Flushing usage events
[0m13:53:06.379016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D780C22930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D780C212B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D780C232F0>]}


============================== 13:53:06.379361 | af566d28-71e0-4a1f-889e-9e2f32ab84e6 ==============================
[0m13:53:06.379361 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:53:06.379361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:08.144369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af566d28-71e0-4a1f-889e-9e2f32ab84e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793733A40>]}
[0m13:53:08.222962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af566d28-71e0-4a1f-889e-9e2f32ab84e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793DE5A00>]}
[0m13:53:08.238557 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:53:08.238557 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:53:08.404680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:08.404680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:08.441444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af566d28-71e0-4a1f-889e-9e2f32ab84e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D780C21370>]}
[0m13:53:08.535063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af566d28-71e0-4a1f-889e-9e2f32ab84e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793F2AEA0>]}
[0m13:53:08.535063 [info ] [MainThread]: Found 10 models, 478 macros
[0m13:53:08.535063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af566d28-71e0-4a1f-889e-9e2f32ab84e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793E8A510>]}
[0m13:53:08.535063 [info ] [MainThread]: 
[0m13:53:08.535063 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:53:08.535063 [debug] [MainThread]: Command end result
[0m13:53:08.581902 [info ] [MainThread]: 
[0m13:53:08.581902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:08.581902 [info ] [MainThread]: 
[0m13:53:08.581902 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m13:53:08.581902 [debug] [MainThread]: Command `dbt seed` succeeded at 13:53:08.581902 after 2.37 seconds
[0m13:53:08.591422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793DE4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D780A9F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D793EB2330>]}
[0m13:53:08.591422 [debug] [MainThread]: Flushing usage events
[0m13:53:41.449898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DF59C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248E1F0F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248E1F0DDF0>]}


============================== 13:53:41.455426 | af256f3a-c038-4c24-aca5-5058101585b6 ==============================
[0m13:53:41.455426 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:53:41.455426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m13:53:43.696350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248E208F7D0>]}
[0m13:53:43.775533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DFB2A420>]}
[0m13:53:43.791147 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:53:43.791147 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:53:43.992664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:53:43.992664 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://seeds\BuyBox_raw_ds_first20_entries.csv
[0m13:53:44.314088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F55299D0>]}
[0m13:53:44.480368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F5607320>]}
[0m13:53:44.492230 [info ] [MainThread]: Found 10 models, 1 seed, 478 macros
[0m13:53:44.492799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F52E3B60>]}
[0m13:53:44.493740 [info ] [MainThread]: 
[0m13:53:44.493740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:44.493740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m13:53:44.493740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:45.922509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m13:53:45.922509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:47.454995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F54D5250>]}
[0m13:53:47.456600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:47.456600 [info ] [MainThread]: 
[0m13:53:47.459518 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m13:53:47.464764 [info ] [Thread-1 (]: 1 of 1 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m13:53:47.465895 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries'
[0m13:53:47.467124 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m13:53:47.468649 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m13:53:47.526755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:54.217607 [debug] [Thread-1 (]: On seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"} */

    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m13:53:54.818491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d4faa226-b487-446c-8a66-c32a39a46eee&page=queryresults
[0m13:53:55.627825 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"
[0m13:53:55.643451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af256f3a-c038-4c24-aca5-5058101585b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DFAC1A00>]}
[0m13:53:55.643451 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 8.18s]
[0m13:53:55.643451 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m13:53:55.643451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:55.643451 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m13:53:55.643451 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m13:53:55.643451 [debug] [MainThread]: Connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries' was properly closed.
[0m13:53:55.659070 [info ] [MainThread]: 
[0m13:53:55.659968 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m13:53:55.661371 [debug] [MainThread]: Command end result
[0m13:53:55.699061 [info ] [MainThread]: 
[0m13:53:55.699061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:55.699061 [info ] [MainThread]: 
[0m13:53:55.699061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:53:55.709096 [debug] [MainThread]: Command `dbt seed` succeeded at 13:53:55.709096 after 14.44 seconds
[0m13:53:55.710957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248E1B750D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F4FF4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DEFE9310>]}
[0m13:53:55.710957 [debug] [MainThread]: Flushing usage events
[0m13:56:02.382170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6BC1C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6DAF96A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6DAF94C0>]}


============================== 13:56:02.382170 | e47c2454-3c81-4e4f-af92-f179b9051157 ==============================
[0m13:56:02.382170 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:56:02.382170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:04.669837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6E6E3950>]}
[0m13:56:04.764043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF0164A270>]}
[0m13:56:04.764043 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:56:04.764043 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 10 files changed.
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_sellers.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notifications.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m13:56:04.957892 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m13:56:05.250386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF019B61B0>]}
[0m13:56:05.345079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01D47F80>]}
[0m13:56:05.345079 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m13:56:05.345079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6E2D6690>]}
[0m13:56:05.345079 [info ] [MainThread]: 
[0m13:56:05.345079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:05.363424 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m13:56:05.364128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.802467 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m13:56:06.802467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:08.137310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01CF93D0>]}
[0m13:56:08.144824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:08.145792 [info ] [MainThread]: 
[0m13:56:08.145792 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m13:56:08.145792 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m13:56:08.153306 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_buybox_offers'
[0m13:56:08.154563 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m13:56:08.165423 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m13:56:08.165423 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m13:56:08.218978 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m13:56:08.220980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:08.277702 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1;


[0m13:56:10.285057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3dfb30c4-2618-4f9f-b37c-0559b30c6071&page=queryresults
[0m13:56:11.115634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01278B00>]}
[0m13:56:11.115634 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.96s]
[0m13:56:11.115634 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m13:56:11.115634 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m13:56:11.115634 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m13:56:11.115634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m13:56:11.115634 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m13:56:11.131264 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m13:56:11.131264 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m13:56:11.139020 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m13:56:11.143184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:11.181223 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_lowest_prices"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1;


[0m13:56:12.652602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:1a82a24a-9f60-47f9-a250-39957092f392&page=queryresults
[0m13:56:13.452595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E03D40>]}
[0m13:56:13.452595 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m13:56:13.468483 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m13:56:13.468483 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m13:56:13.469496 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m13:56:13.470553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m13:56:13.470553 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m13:56:13.474678 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m13:56:13.476738 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m13:56:13.478808 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_summary"
[0m13:56:13.478808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:13.530568 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_summary"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1;


[0m13:56:14.942248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:f56f1cc8-217c-4437-9135-c1695bced71f&page=queryresults
[0m13:56:15.724432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01DFA9F0>]}
[0m13:56:15.724432 [info ] [Thread-1 (]: 3 of 10 OK created sql view model wellbefore.src_notification_summary .......... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m13:56:15.724432 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m13:56:15.724432 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m13:56:15.724432 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m13:56:15.724432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m13:56:15.733518 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m13:56:15.734050 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m13:56:15.734050 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m13:56:15.734050 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notifications"
[0m13:56:15.746678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:15.808082 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notifications"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m13:56:17.386495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:cfb3bd41-f3b9-4276-8293-c202dac44a28&page=queryresults
[0m13:56:18.189850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E75A00>]}
[0m13:56:18.189850 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m13:56:18.198533 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m13:56:18.199830 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m13:56:18.200353 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m13:56:18.201579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m13:56:18.201579 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m13:56:18.205313 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m13:56:18.205313 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m13:56:18.215491 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m13:56:18.218359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:18.263874 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offer_change_trigger"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m13:56:20.115364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fbebf057-be04-42c9-81e8-d82383e09d40&page=queryresults
[0m13:56:20.951214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E81F40>]}
[0m13:56:20.953219 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m13:56:20.955308 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m13:56:20.955308 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m13:56:20.956216 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m13:56:20.958217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m13:56:20.959212 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m13:56:20.962515 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m13:56:20.962515 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m13:56:20.979037 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m13:56:20.980454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:21.024768 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m13:56:22.389802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:158e98ec-1bbd-4dfb-90f2-8c567ba067c8&page=queryresults
[0m13:56:23.173465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E805C0>]}
[0m13:56:23.173465 [info ] [Thread-1 (]: 6 of 10 OK created sql view model wellbefore.src_offers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.22s]
[0m13:56:23.173465 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m13:56:23.173465 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m13:56:23.173465 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m13:56:23.173465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m13:56:23.173465 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m13:56:23.189536 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m13:56:23.190686 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m13:56:23.192665 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m13:56:23.195831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:23.232502 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data;


[0m13:56:24.635014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:ee444c32-a29e-4216-902d-5763979574b3&page=queryresults
[0m13:56:25.416508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E69070>]}
[0m13:56:25.416508 [info ] [Thread-1 (]: 7 of 10 OK created sql view model wellbefore.src_products ...................... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m13:56:25.416508 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m13:56:25.432154 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m13:56:25.432154 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m13:56:25.432154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m13:56:25.432154 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m13:56:25.432154 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m13:56:25.432154 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m13:56:25.432154 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sales_ranking"
[0m13:56:25.432154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:25.498964 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sales_ranking"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers;


[0m13:56:27.068191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:ae8b062d-fcbc-4d7f-9337-49684930613b&page=queryresults
[0m13:56:27.892915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01DF99D0>]}
[0m13:56:27.892915 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m13:56:27.892915 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m13:56:27.892915 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sellers
[0m13:56:27.892915 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m13:56:27.892915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_sellers)
[0m13:56:27.892915 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sellers
[0m13:56:27.910737 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sellers"
[0m13:56:27.912471 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sellers
[0m13:56:27.914019 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sellers"
[0m13:56:27.914019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:27.962548 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.EventTime) AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    EventTime,
    JSON_VALUE(offers.SellerId) AS SellerId,
    JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
    JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m13:56:29.417377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0926b002-45fa-4f5a-b468-34e127f6a077&page=queryresults
[0m13:56:30.207682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01E90B30>]}
[0m13:56:30.207682 [info ] [Thread-1 (]: 9 of 10 OK created sql view model wellbefore.src_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m13:56:30.207682 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sellers
[0m13:56:30.207682 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m13:56:30.214193 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m13:56:30.214193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sellers, now model.buy_box_gcp_1.src_shipping)
[0m13:56:30.214193 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m13:56:30.214193 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m13:56:30.214193 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m13:56:30.214193 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m13:56:30.214193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:30.273345 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m13:56:31.735147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:4ddf3dba-4b3c-4a30-9622-40100cb9adac&page=queryresults
[0m13:56:32.552838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47c2454-3c81-4e4f-af92-f179b9051157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF031E6F00>]}
[0m13:56:32.568469 [info ] [Thread-1 (]: 10 of 10 OK created sql view model wellbefore.src_shipping ..................... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m13:56:32.568469 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m13:56:32.568469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:32.568469 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m13:56:32.568469 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m13:56:32.568469 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m13:56:32.568469 [info ] [MainThread]: 
[0m13:56:32.568469 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 27.22 seconds (27.22s).
[0m13:56:32.578528 [debug] [MainThread]: Command end result
[0m13:56:32.634575 [info ] [MainThread]: 
[0m13:56:32.635575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:32.636577 [info ] [MainThread]: 
[0m13:56:32.636577 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:56:32.639580 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:32.638579 after 30.46 seconds
[0m13:56:32.639580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF01DFFBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6E55DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6E55F500>]}
[0m13:56:32.640581 [debug] [MainThread]: Flushing usage events
[0m14:13:40.851127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002822A493AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002822A4912B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002822A4939B0>]}


============================== 14:13:40.851127 | 1cb1f90d-d1de-4c80-afd2-d52d6c400622 ==============================
[0m14:13:40.851127 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:13:40.851127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select src_shipping', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:13:42.238356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823CF45550>]}
[0m14:13:42.285478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028227F59FA0>]}
[0m14:13:42.285478 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:13:42.301114 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:13:42.434628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:42.434628 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m14:13:42.659884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823DAC5AF0>]}
[0m14:13:42.749108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823DABB230>]}
[0m14:13:42.749108 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m14:13:42.749108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823D94D5B0>]}
[0m14:13:42.749108 [info ] [MainThread]: 
[0m14:13:42.749108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:13:42.749108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:13:42.754711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:44.096939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:13:44.096939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:45.426360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028227F5A1E0>]}
[0m14:13:45.426360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:45.426360 [info ] [MainThread]: 
[0m14:13:45.426360 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m14:13:45.426360 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_shipping ............................ [RUN]
[0m14:13:45.426360 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_shipping'
[0m14:13:45.442260 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m14:13:45.447360 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m14:13:45.448359 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m14:13:45.469607 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m14:13:45.469607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:45.503345 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m14:13:47.011586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:dbcd0e0b-8ffc-4257-8442-ef111a2a21ea&page=queryresults
[0m14:13:47.841794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1f90d-d1de-4c80-afd2-d52d6c400622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823CFB8590>]}
[0m14:13:47.841794 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_shipping ....................... [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m14:13:47.841794 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m14:13:47.841794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:47.841794 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:13:47.841794 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:13:47.841794 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m14:13:47.841794 [info ] [MainThread]: 
[0m14:13:47.841794 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m14:13:47.841794 [debug] [MainThread]: Command end result
[0m14:13:47.871165 [info ] [MainThread]: 
[0m14:13:47.871165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:47.871165 [info ] [MainThread]: 
[0m14:13:47.885815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:47.887625 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:47.887134 after 7.22 seconds
[0m14:13:47.888488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823D8FC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823D67A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002823DAC6900>]}
[0m14:13:47.888488 [debug] [MainThread]: Flushing usage events
[0m14:18:45.855107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EA6C26C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E9899EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EA6C3A70>]}


============================== 14:18:45.855107 | 345b21d8-a726-4e88-9f9e-2938670f2338 ==============================
[0m14:18:45.855107 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:18:45.855107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select src_shipping', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:47.076241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FD57F830>]}
[0m14:18:47.139056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FD5A93A0>]}
[0m14:18:47.139056 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:18:47.139056 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:18:47.259218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:47.259218 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m14:18:47.463735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FDCE5EB0>]}
[0m14:18:47.565839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FDCDB260>]}
[0m14:18:47.566399 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m14:18:47.566920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FD8974A0>]}
[0m14:18:47.568652 [info ] [MainThread]: 
[0m14:18:47.569738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:18:47.570724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:18:47.571228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:48.895076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:18:48.895076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:50.024879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FD9671A0>]}
[0m14:18:50.024879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:50.028889 [info ] [MainThread]: 
[0m14:18:50.033184 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m14:18:50.033184 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_shipping ............................ [RUN]
[0m14:18:50.033184 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_shipping'
[0m14:18:50.035732 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m14:18:50.046750 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m14:18:50.046750 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m14:18:50.090870 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m14:18:50.094465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:50.127302 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        NotificationId,
        offer,
        JSON_VALUE(offer, "$.Shipping.Amount") AS ShippingAmount,
        JSON_VALUE(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_VALUE(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_VALUE(offer, "$.ShippingTime.MaximumHours") AS FLOAT64) AS ShippingMaximumHours,
        CAST(JSON_VALUE(offer, "$.ShippingTime.MinimumHours") AS FLOAT64) AS ShippingMinimumHours,
        JSON_VALUE(offer, "$.ShipsDomestically") AS ShipsDomestically
    FROM 
        flatten_data, 
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers;


[0m14:18:51.482562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:db09ec2d-567d-4306-a809-71b2e11b2470&page=queryresults
[0m14:18:52.313615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '345b21d8-a726-4e88-9f9e-2938670f2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FD966960>]}
[0m14:18:52.314375 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_shipping ....................... [[32mCREATE VIEW (0 processed)[0m in 2.28s]
[0m14:18:52.315405 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m14:18:52.317254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:52.317508 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:18:52.317759 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:18:52.317990 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m14:18:52.317990 [info ] [MainThread]: 
[0m14:18:52.318605 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m14:18:52.319710 [debug] [MainThread]: Command end result
[0m14:18:52.347143 [info ] [MainThread]: 
[0m14:18:52.347143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:52.347143 [info ] [MainThread]: 
[0m14:18:52.347143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:52.347143 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:52.347143 after 6.67 seconds
[0m14:18:52.347143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EA738260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FDBDF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8FDAB0C80>]}
[0m14:18:52.347143 [debug] [MainThread]: Flushing usage events
[0m14:20:38.191283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305A95B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305A021EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305A6FA6F0>]}


============================== 14:20:38.194285 | 4ad15671-d28c-4dfb-a237-abead997a73d ==============================
[0m14:20:38.194285 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:20:38.195284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select src_shipping', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:39.456057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023059AB4D40>]}
[0m14:20:39.512110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306D7E4B90>]}
[0m14:20:39.512930 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:20:39.519937 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:20:39.640650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:39.641652 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m14:20:39.848011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306DF4E480>]}
[0m14:20:39.923551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E09B290>]}
[0m14:20:39.924555 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m14:20:39.924555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306DD2C6B0>]}
[0m14:20:39.926551 [info ] [MainThread]: 
[0m14:20:39.927552 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:20:39.928693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:20:39.929454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:41.074022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:20:41.074022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:42.214686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E0A3950>]}
[0m14:20:42.215685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:42.216681 [info ] [MainThread]: 
[0m14:20:42.221686 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m14:20:42.221686 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_shipping ............................ [RUN]
[0m14:20:42.222686 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_shipping'
[0m14:20:42.223684 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m14:20:42.229989 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m14:20:42.231988 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m14:20:42.259201 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m14:20:42.260257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:42.302593 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_shipping`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers;


[0m14:20:43.621220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:aaf82574-d561-46ca-ab67-836bb544ae8a&page=queryresults
[0m14:20:44.466951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ad15671-d28c-4dfb-a237-abead997a73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306D5985F0>]}
[0m14:20:44.467952 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_shipping ....................... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m14:20:44.468866 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m14:20:44.470652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:44.470652 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:20:44.470652 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:20:44.470652 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m14:20:44.470652 [info ] [MainThread]: 
[0m14:20:44.472164 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m14:20:44.473173 [debug] [MainThread]: Command end result
[0m14:20:44.517556 [info ] [MainThread]: 
[0m14:20:44.518555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:44.518555 [info ] [MainThread]: 
[0m14:20:44.519557 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:20:44.521684 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:44.521684 after 6.51 seconds
[0m14:20:44.521684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305A959370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305AAC7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305AAC7B00>]}
[0m14:20:44.522695 [debug] [MainThread]: Flushing usage events
[0m14:23:00.670676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DB17DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DA79E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DA79DBB0>]}


============================== 14:23:00.670676 | c2c9e2db-b487-4b0d-a61b-07c44cf27dae ==============================
[0m14:23:00.670676 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:23:00.670676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select src_sellers', 'send_anonymous_usage_stats': 'True'}
[0m14:23:01.877044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE0F78F0>]}
[0m14:23:01.939803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EDE17470>]}
[0m14:23:01.939803 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:23:01.939803 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:23:02.064834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:02.064834 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_sellers.sql
[0m14:23:02.290436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE785EE0>]}
[0m14:23:02.363236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE76B1D0>]}
[0m14:23:02.363236 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m14:23:02.363236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE3A2480>]}
[0m14:23:02.363236 [info ] [MainThread]: 
[0m14:23:02.363236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:02.363236 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:23:02.363236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:03.491525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:23:03.491525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:04.747338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EDEC4B00>]}
[0m14:23:04.747338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:04.747338 [info ] [MainThread]: 
[0m14:23:04.747338 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sellers
[0m14:23:04.747338 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_sellers ............................. [RUN]
[0m14:23:04.747338 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_sellers'
[0m14:23:04.747338 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sellers
[0m14:23:04.758585 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sellers"
[0m14:23:04.758585 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sellers
[0m14:23:04.784084 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sellers"
[0m14:23:04.798378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:04.833979 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_sellers`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers;


[0m14:23:06.251357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:6dfd9817-2b5f-41d8-abb1-cd9ae7c137e2&page=queryresults
[0m14:23:07.081969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c9e2db-b487-4b0d-a61b-07c44cf27dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE3A0F50>]}
[0m14:23:07.081969 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_sellers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m14:23:07.081969 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sellers
[0m14:23:07.081969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:07.081969 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:23:07.081969 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:23:07.081969 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_sellers' was properly closed.
[0m14:23:07.081969 [info ] [MainThread]: 
[0m14:23:07.081969 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m14:23:07.081969 [debug] [MainThread]: Command end result
[0m14:23:07.117079 [info ] [MainThread]: 
[0m14:23:07.117079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:07.128587 [info ] [MainThread]: 
[0m14:23:07.128587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:23:07.130146 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:07.130146 after 6.63 seconds
[0m14:23:07.130146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5EE550B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DAC87FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DAC85820>]}
[0m14:23:07.131756 [debug] [MainThread]: Flushing usage events
[0m14:25:51.710768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53259C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A534F3A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A534B75940>]}


============================== 14:25:51.714793 | 41bacd3d-4a00-49e6-9a87-6b52bdf33fd9 ==============================
[0m14:25:51.714793 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:25:51.714793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:53.001273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5350E1190>]}
[0m14:25:53.057499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548029C40>]}
[0m14:25:53.058506 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:25:53.065585 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:25:53.186183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:53.186183 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m14:25:53.401227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5484E85C0>]}
[0m14:25:53.486689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54867B350>]}
[0m14:25:53.486689 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m14:25:53.487701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54824F4D0>]}
[0m14:25:53.489700 [info ] [MainThread]: 
[0m14:25:53.490696 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:25:53.492700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:25:53.492700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:54.775273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:25:54.775273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:55.878076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A547EA59D0>]}
[0m14:25:55.881074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:55.882070 [info ] [MainThread]: 
[0m14:25:55.886077 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m14:25:55.888190 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_products ............................ [RUN]
[0m14:25:55.889678 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_products'
[0m14:25:55.889678 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m14:25:55.899701 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m14:25:55.902674 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m14:25:55.937552 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m14:25:55.939551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:55.977556 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data;


[0m14:25:57.419768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:b76b310c-6b87-45f5-bf91-5802ad52c4cf&page=queryresults
[0m14:25:58.229353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41bacd3d-4a00-49e6-9a87-6b52bdf33fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A547B88770>]}
[0m14:25:58.229353 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_products ....................... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m14:25:58.230354 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m14:25:58.232110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:58.233121 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:25:58.233121 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:25:58.233121 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_products' was properly closed.
[0m14:25:58.233121 [info ] [MainThread]: 
[0m14:25:58.234084 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m14:25:58.235355 [debug] [MainThread]: Command end result
[0m14:25:58.294272 [info ] [MainThread]: 
[0m14:25:58.295284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:58.296331 [info ] [MainThread]: 
[0m14:25:58.297272 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:25:58.298268 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:58.298268 after 6.76 seconds
[0m14:25:58.298268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53259C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5481C2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A534D4ECF0>]}
[0m14:25:58.299269 [debug] [MainThread]: Flushing usage events
[0m14:42:23.648807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197363128A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197363124B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197363131D0>]}


============================== 14:42:23.648807 | 0e00b903-66ca-4980-8d6d-29937268291b ==============================
[0m14:42:23.648807 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:42:23.648807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:42:24.933659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197363883B0>]}
[0m14:42:24.981112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019735345160>]}
[0m14:42:24.981112 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:42:24.996796 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:42:25.060967 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:42:25.061963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197496E5400>]}
[0m14:42:26.175972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197497732F0>]}
[0m14:42:26.251597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197499B4D70>]}
[0m14:42:26.251597 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:42:26.251597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197498631D0>]}
[0m14:42:26.251597 [info ] [MainThread]: 
[0m14:42:26.251597 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:26.251597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:42:26.251597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:27.710470 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:42:27.710470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:28.839203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019748EE6DB0>]}
[0m14:42:28.839203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:28.839203 [info ] [MainThread]: 
[0m14:42:28.854735 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:42:28.854735 [info ] [Thread-1 (]: 1 of 11 START sql view model wellbefore.dim_all_columns ........................ [RUN]
[0m14:42:28.854735 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:42:28.859035 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:42:28.864141 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:42:28.866156 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:42:28.891852 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:42:28.891852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:28.925035 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        `BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES`
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
 
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS no,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,
    
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
 
    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
 
    JSON_EXTRACT_SCALAR(no, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(no, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(no, "$.OfferCount") AS NumberOfOffersCount,
 
    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload AS f1,
    UNNEST(offers) AS offer,
    UNNEST(bbp) AS bbp,
    UNNEST(lop) AS lop,
    UNNEST(neo) AS neo,
    UNNEST(no) AS no,
    UNNEST(lp) AS lp,
    UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload 
ORDER BY ASIN;;


[0m14:42:30.139393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:825f8ebf-e740-407e-aa60-aeb3ae02871b&page=queryresults
[0m14:42:30.139393 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword NO at [33:105]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword NO at [33:105]')
[0m14:42:30.704303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:72085eb1-84d3-4725-90b8-480724df7ff6&page=queryresults
[0m14:42:30.704303 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:72085eb1-84d3-4725-90b8-480724df7ff6&page=queryresults
[0m14:42:30.704303 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected keyword NO at [33:105]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:42:30.704303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019735A23A40>]}
[0m14:42:30.704303 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model wellbefore.dim_all_columns ............... [[31mERROR[0m in 1.85s]
[0m14:42:30.704303 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:42:30.704303 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m14:42:30.718633 [info ] [Thread-1 (]: 2 of 11 START sql table model wellbefore.src_buybox_offers ..................... [RUN]
[0m14:42:30.719625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.src_buybox_offers)
[0m14:42:30.719625 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m14:42:30.725713 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m14:42:30.725713 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m14:42:30.743276 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m14:42:30.743276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:30.791863 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1
    );
  
[0m14:42:32.221500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:bc422f98-4f31-4750-a553-c1f1101266d1&page=queryresults
[0m14:42:34.640142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019748E48650>]}
[0m14:42:34.640142 [info ] [Thread-1 (]: 2 of 11 OK created sql table model wellbefore.src_buybox_offers ................ [[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)[0m in 3.92s]
[0m14:42:34.640142 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m14:42:34.640142 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m14:42:34.640142 [info ] [Thread-1 (]: 3 of 11 START sql table model wellbefore.src_notification_lowest_prices ........ [RUN]
[0m14:42:34.640142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m14:42:34.640142 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m14:42:34.640142 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m14:42:34.656874 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m14:42:34.660884 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m14:42:34.662888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:34.693638 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_lowest_prices"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1
    );
  
[0m14:42:36.051361 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:557ee01d-9826-4b5a-92ed-070fb5dac394&page=queryresults
[0m14:42:38.435323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF63EF0>]}
[0m14:42:38.435323 [info ] [Thread-1 (]: 3 of 11 OK created sql table model wellbefore.src_notification_lowest_prices ... [[32mCREATE TABLE (28.0 rows, 120.8 KiB processed)[0m in 3.80s]
[0m14:42:38.435323 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m14:42:38.435323 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m14:42:38.435323 [info ] [Thread-1 (]: 4 of 11 START sql table model wellbefore.src_notification_summary .............. [RUN]
[0m14:42:38.450961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m14:42:38.450961 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m14:42:38.450961 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m14:42:38.450961 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m14:42:38.450961 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_summary"
[0m14:42:38.450961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:38.502954 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_summary"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1
    );
  
[0m14:42:39.800511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:193d4976-7e2a-4ba3-911b-24d35996eebc&page=queryresults
[0m14:42:42.311521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF7CD40>]}
[0m14:42:42.311521 [info ] [Thread-1 (]: 4 of 11 OK created sql table model wellbefore.src_notification_summary ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 3.88s]
[0m14:42:42.311521 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m14:42:42.311521 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m14:42:42.311521 [info ] [Thread-1 (]: 5 of 11 START sql table model wellbefore.src_notifications ..................... [RUN]
[0m14:42:42.311521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m14:42:42.311521 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m14:42:42.311521 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m14:42:42.325280 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m14:42:42.326967 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notifications"
[0m14:42:42.326967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:42.359803 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notifications"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data
    );
  
[0m14:42:43.734877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:47e1a674-ec5c-4ea5-a75f-9c090dc2ed63&page=queryresults
[0m14:42:46.161851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF9BD10>]}
[0m14:42:46.161851 [info ] [Thread-1 (]: 5 of 11 OK created sql table model wellbefore.src_notifications ................ [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 3.85s]
[0m14:42:46.161851 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m14:42:46.161851 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m14:42:46.161851 [info ] [Thread-1 (]: 6 of 11 START sql table model wellbefore.src_offer_change_trigger .............. [RUN]
[0m14:42:46.161851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m14:42:46.161851 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m14:42:46.161851 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m14:42:46.175966 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m14:42:46.179299 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m14:42:46.184920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:46.228963 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offer_change_trigger"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data
    );
  
[0m14:42:47.546807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:eb7db5f5-cedd-41f3-b837-2ca9fe3b6eed&page=queryresults
[0m14:42:49.927448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF9AF30>]}
[0m14:42:49.929019 [info ] [Thread-1 (]: 6 of 11 OK created sql table model wellbefore.src_offer_change_trigger ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 3.77s]
[0m14:42:49.929019 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m14:42:49.931917 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m14:42:49.931917 [info ] [Thread-1 (]: 7 of 11 START sql table model wellbefore.src_offers ............................ [RUN]
[0m14:42:49.931917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m14:42:49.934619 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m14:42:49.943072 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m14:42:49.944700 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m14:42:49.947387 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m14:42:49.954021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:49.998963 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1
    );
  
[0m14:42:51.442268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:08355a70-798f-4144-920e-f0705ebe22ee&page=queryresults
[0m14:42:55.539422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF9BA40>]}
[0m14:42:55.539422 [info ] [Thread-1 (]: 7 of 11 OK created sql table model wellbefore.src_offers ....................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 5.61s]
[0m14:42:55.539422 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m14:42:55.539422 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m14:42:55.555060 [info ] [Thread-1 (]: 8 of 11 START sql table model wellbefore.src_products .......................... [RUN]
[0m14:42:55.555060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m14:42:55.555060 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m14:42:55.555060 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m14:42:55.555060 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m14:42:55.555060 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m14:42:55.555060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:55.593084 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_products`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data
    );
  
[0m14:42:56.941787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:cc3149a0-3060-4c49-8248-049bc48909c6&page=queryresults
[0m14:42:59.268668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF74860>]}
[0m14:42:59.268668 [info ] [Thread-1 (]: 8 of 11 OK created sql table model wellbefore.src_products ..................... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 3.71s]
[0m14:42:59.268668 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m14:42:59.284332 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m14:42:59.284332 [info ] [Thread-1 (]: 9 of 11 START sql table model wellbefore.src_sales_ranking ..................... [RUN]
[0m14:42:59.284332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m14:42:59.284332 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m14:42:59.284332 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m14:42:59.299990 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m14:42:59.299990 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sales_ranking"
[0m14:42:59.299990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:59.371389 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sales_ranking"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers
    );
  
[0m14:43:00.985706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:348a4ee4-3d73-40e6-932c-c58a2db59880&page=queryresults
[0m14:43:03.605154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF107D0>]}
[0m14:43:03.605154 [info ] [Thread-1 (]: 9 of 11 OK created sql table model wellbefore.src_sales_ranking ................ [[32mCREATE TABLE (43.0 rows, 120.8 KiB processed)[0m in 4.32s]
[0m14:43:03.605154 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m14:43:03.605154 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sellers
[0m14:43:03.605154 [info ] [Thread-1 (]: 10 of 11 START sql table model wellbefore.src_sellers .......................... [RUN]
[0m14:43:03.605154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_sellers)
[0m14:43:03.605154 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sellers
[0m14:43:03.620723 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sellers"
[0m14:43:03.620723 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sellers
[0m14:43:03.644466 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sellers"
[0m14:43:03.652473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:03.715868 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sellers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sellers`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers
    );
  
[0m14:43:05.219691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:abefdde0-2c86-4943-a7b3-0f186116248b&page=queryresults
[0m14:43:07.594897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AFC7380>]}
[0m14:43:07.594897 [info ] [Thread-1 (]: 10 of 11 OK created sql table model wellbefore.src_sellers ..................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 3.99s]
[0m14:43:07.610533 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sellers
[0m14:43:07.610533 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m14:43:07.610533 [info ] [Thread-1 (]: 11 of 11 START sql table model wellbefore.src_shipping ......................... [RUN]
[0m14:43:07.610533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sellers, now model.buy_box_gcp_1.src_shipping)
[0m14:43:07.610533 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m14:43:07.610533 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m14:43:07.610533 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m14:43:07.627002 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m14:43:07.627002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:07.673872 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers
    );
  
[0m14:43:09.335977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:09f103a7-a226-4b0c-ab63-c09ef1f4e987&page=queryresults
[0m14:43:11.980483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e00b903-66ca-4980-8d6d-29937268291b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974AF1C980>]}
[0m14:43:11.980483 [info ] [Thread-1 (]: 11 of 11 OK created sql table model wellbefore.src_shipping .................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.37s]
[0m14:43:11.980483 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m14:43:11.980483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:11.980483 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:43:11.980483 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:43:11.980483 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m14:43:11.980483 [info ] [MainThread]: 
[0m14:43:11.980483 [info ] [MainThread]: Finished running 1 view model, 10 table models in 0 hours 0 minutes and 45.73 seconds (45.73s).
[0m14:43:11.994087 [debug] [MainThread]: Command end result
[0m14:43:12.029639 [info ] [MainThread]: 
[0m14:43:12.029639 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:43:12.029639 [info ] [MainThread]: 
[0m14:43:12.029639 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected keyword NO at [33:105]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:43:12.041964 [info ] [MainThread]: 
[0m14:43:12.042975 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m14:43:12.043614 [debug] [MainThread]: Command `dbt run` failed at 14:43:12.043614 after 48.57 seconds
[0m14:43:12.043614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019749A23FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019749A23860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197499A2B70>]}
[0m14:43:12.043614 [debug] [MainThread]: Flushing usage events
[0m14:43:37.240765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5239FC410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B526369F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B526368920>]}


============================== 14:43:37.240765 | a3295863-8e92-43c4-bd3b-6b2ea990806f ==============================
[0m14:43:37.240765 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:43:37.240765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_all_columns', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:43:38.459542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B53957BBC0>]}
[0m14:43:38.522313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539610980>]}
[0m14:43:38.522313 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:43:38.537950 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:43:38.644423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:38.644423 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m14:43:38.927571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539ADE2A0>]}
[0m14:43:39.024969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539ACB620>]}
[0m14:43:39.024969 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:43:39.024969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B525BFA3C0>]}
[0m14:43:39.024969 [info ] [MainThread]: 
[0m14:43:39.024969 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:39.024969 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:43:39.024969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:40.155030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:43:40.155030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:41.267237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539ADFFE0>]}
[0m14:43:41.267237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:41.267237 [info ] [MainThread]: 
[0m14:43:41.282870 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:43:41.282870 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m14:43:41.282870 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:43:41.285504 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:43:41.293910 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:43:41.293910 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:43:41.311628 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:43:41.311628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:41.359287 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
 
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS no,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,
    
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
 
    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
 
    JSON_EXTRACT_SCALAR(no, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(no, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(no, "$.OfferCount") AS NumberOfOffersCount,
 
    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload AS f1,
    UNNEST(offers) AS offer,
    UNNEST(bbp) AS bbp,
    UNNEST(lop) AS lop,
    UNNEST(neo) AS neo,
    UNNEST(no) AS no,
    UNNEST(lp) AS lp,
    UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload 
ORDER BY ASIN;;


[0m14:43:42.457343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:ff271090-5eec-43c9-9e83-72bc9a570816&page=queryresults
[0m14:43:42.457343 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword NO at [33:105]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword NO at [33:105]')
[0m14:43:43.807716 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:71a7b4bc-05be-4cfc-86bd-2a917b89fea3&page=queryresults
[0m14:43:43.807716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:71a7b4bc-05be-4cfc-86bd-2a917b89fea3&page=queryresults
[0m14:43:43.807716 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected keyword NO at [33:105]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:43:43.824490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3295863-8e92-43c4-bd3b-6b2ea990806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539ACBEC0>]}
[0m14:43:43.825170 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns ................ [[31mERROR[0m in 2.54s]
[0m14:43:43.826309 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:43:43.826808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:43.826808 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:43:43.826808 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:43:43.826808 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m14:43:43.826808 [info ] [MainThread]: 
[0m14:43:43.826808 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m14:43:43.826808 [debug] [MainThread]: Command end result
[0m14:43:43.860538 [info ] [MainThread]: 
[0m14:43:43.860538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:43:43.860538 [info ] [MainThread]: 
[0m14:43:43.860538 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected keyword NO at [33:105]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:43:43.860538 [info ] [MainThread]: 
[0m14:43:43.860538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:43:43.860538 [debug] [MainThread]: Command `dbt run` failed at 14:43:43.860538 after 6.74 seconds
[0m14:43:43.860538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B526368920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5264C1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5264C2C00>]}
[0m14:43:43.860538 [debug] [MainThread]: Flushing usage events
[0m14:44:59.556217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE49513440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE49511F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE495128D0>]}


============================== 14:44:59.556217 | d8071450-ee60-44f7-a626-382709b4c0ac ==============================
[0m14:44:59.556217 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:44:59.556217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m14:45:01.006121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE46F76720>]}
[0m14:45:01.058254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C396AE0>]}
[0m14:45:01.058254 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:45:01.075633 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:45:01.195525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:01.195525 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m14:45:01.390646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5CB2DDC0>]}
[0m14:45:01.490479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5CAF7500>]}
[0m14:45:01.490479 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:45:01.490479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C87C620>]}
[0m14:45:01.497490 [info ] [MainThread]: 
[0m14:45:01.497490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:45:01.497490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:45:01.497490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:02.638368 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:45:02.638368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:03.891300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C793E90>]}
[0m14:45:03.891300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:03.895777 [info ] [MainThread]: 
[0m14:45:03.899784 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:45:03.900782 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m14:45:03.901780 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:45:03.901780 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:45:03.912914 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:45:03.914913 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:45:03.959679 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:45:03.962248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:04.002929 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
 
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,
    
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
 
    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
 
    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
 
    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload AS f1,
    UNNEST(offers) AS offer,
    UNNEST(bbp) AS bbp,
    UNNEST(lop) AS lop,
    UNNEST(neo) AS neo,
    UNNEST(noo) AS noo,
    UNNEST(lp) AS lp,
    UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload 
ORDER BY ASIN;;


[0m14:45:05.480119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e96e3d84-e2eb-46c3-8ad2-6d0c16b35c61&page=queryresults
[0m14:45:05.481114 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [124:15]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [124:15]')
[0m14:45:06.527155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:6e86385d-03ed-4ecc-84a8-a78146893fbc&page=queryresults
[0m14:45:06.527155 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:6e86385d-03ed-4ecc-84a8-a78146893fbc&page=queryresults
[0m14:45:06.527155 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected ";" at [124:15]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:45:06.527155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8071450-ee60-44f7-a626-382709b4c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C751FA0>]}
[0m14:45:06.527155 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns ................ [[31mERROR[0m in 2.63s]
[0m14:45:06.527155 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:45:06.544575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:06.544744 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:45:06.544744 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:45:06.544744 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m14:45:06.544744 [info ] [MainThread]: 
[0m14:45:06.546772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m14:45:06.549032 [debug] [MainThread]: Command end result
[0m14:45:06.580180 [info ] [MainThread]: 
[0m14:45:06.580180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:45:06.580180 [info ] [MainThread]: 
[0m14:45:06.580180 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Unexpected ";" at [124:15]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m14:45:06.593201 [info ] [MainThread]: 
[0m14:45:06.593941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:45:06.596743 [debug] [MainThread]: Command `dbt run` failed at 14:45:06.596232 after 7.17 seconds
[0m14:45:06.597252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C995520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5CA2B9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE5C792300>]}
[0m14:45:06.597252 [debug] [MainThread]: Flushing usage events
[0m14:47:11.223793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B073C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B7749B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B67ECF0>]}


============================== 14:47:11.239445 | a5eadcbe-42b1-4afe-881f-34b9218e8f1c ==============================
[0m14:47:11.239445 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:47:11.239445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_all_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:47:12.461051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3E6835F0>]}
[0m14:47:12.524126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A990B30>]}
[0m14:47:12.524126 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:47:12.524126 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:47:12.647741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:12.647741 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m14:47:12.852458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3EF8E030>]}
[0m14:47:12.944096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3EF8AB10>]}
[0m14:47:12.945111 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:47:12.946018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3EBF2300>]}
[0m14:47:12.947701 [info ] [MainThread]: 
[0m14:47:12.947701 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:47:12.947701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:47:12.947701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:14.060939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:47:14.060939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:15.253735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3EF93C50>]}
[0m14:47:15.253735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:15.253735 [info ] [MainThread]: 
[0m14:47:15.269265 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:47:15.269265 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m14:47:15.269265 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:47:15.269265 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:47:15.275763 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:47:15.281845 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:47:15.300678 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:47:15.300678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:15.352988 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
 
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,
    
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
 
    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
 
    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
 
    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload AS f1,
    UNNEST(offers) AS offer,
    UNNEST(bbp) AS bbp,
    UNNEST(lop) AS lop,
    UNNEST(neo) AS neo,
    UNNEST(noo) AS noo,
    UNNEST(lp) AS lp,
    UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload 
ORDER BY ASIN, EventTime, NotificationId, PublishTime;


[0m14:47:16.679185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:595c3a03-9889-44e2-8af7-d3cb1ab10970&page=queryresults
[0m14:47:17.509967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5eadcbe-42b1-4afe-881f-34b9218e8f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA3E488410>]}
[0m14:47:17.509967 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m14:47:17.509967 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:47:17.509967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:17.509967 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:47:17.509967 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:47:17.509967 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m14:47:17.521567 [info ] [MainThread]: 
[0m14:47:17.521567 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m14:47:17.521567 [debug] [MainThread]: Command end result
[0m14:47:17.551216 [info ] [MainThread]: 
[0m14:47:17.551216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:17.551216 [info ] [MainThread]: 
[0m14:47:17.565201 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:47:17.566232 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:17.566232 after 6.50 seconds
[0m14:47:17.566232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B7DF8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B67ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2B53AF00>]}
[0m14:47:17.566232 [debug] [MainThread]: Flushing usage events
[0m14:52:07.625040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E31A52510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E316F1D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E31A521B0>]}


============================== 14:52:07.625040 | 27eae866-4508-4ee4-b433-eb2c89cd3541 ==============================
[0m14:52:07.625040 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:52:07.625040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_all_columns', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:08.909919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E449490D0>]}
[0m14:52:08.956889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E31A94EC0>]}
[0m14:52:08.956889 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:52:08.972431 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:52:09.098302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:09.098302 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m14:52:09.300748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E45083C20>]}
[0m14:52:09.363523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E45043560>]}
[0m14:52:09.363523 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:52:09.379239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E44CA23C0>]}
[0m14:52:09.379239 [info ] [MainThread]: 
[0m14:52:09.379239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:52:09.379239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:52:09.379239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:10.665502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:52:10.665502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.732911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E45043FB0>]}
[0m14:52:11.732911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:11.732911 [info ] [MainThread]: 
[0m14:52:11.732911 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:52:11.732911 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m14:52:11.748536 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:52:11.749325 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:52:11.755492 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:52:11.756437 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:52:11.772793 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:52:11.772793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:11.819208 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
 
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,
    
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
 
    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,
 
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
 
    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
 
    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
 
    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
 
    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload,
    UNNEST(offers) AS offer,
    UNNEST(bbp) AS bbp,
    UNNEST(lop) AS lop,
    UNNEST(neo) AS neo,
    UNNEST(noo) AS noo,
    UNNEST(lp) AS lp,
    UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1
ORDER BY ASIN, EventTime, NotificationId, PublishTime;


[0m14:52:13.221576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:4b2509e8-6840-4b22-9a3a-bd0dc5a463c3&page=queryresults
[0m14:52:14.083820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27eae866-4508-4ee4-b433-eb2c89cd3541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E445788C0>]}
[0m14:52:14.083820 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m14:52:14.083820 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:52:14.083820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:14.083820 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:52:14.083820 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:52:14.083820 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m14:52:14.083820 [info ] [MainThread]: 
[0m14:52:14.083820 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m14:52:14.083820 [debug] [MainThread]: Command end result
[0m14:52:14.122923 [info ] [MainThread]: 
[0m14:52:14.122923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:14.122923 [info ] [MainThread]: 
[0m14:52:14.122923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:14.122923 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:14.122923 after 6.67 seconds
[0m14:52:14.122923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E44EAA480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E44CE1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E44F80140>]}
[0m14:52:14.122923 [debug] [MainThread]: Flushing usage events
[0m14:54:29.411271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E33CAA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E5FD9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E5FD9DF0>]}


============================== 14:54:29.411271 | ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5 ==============================
[0m14:54:29.411271 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:54:29.411271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_all_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:54:30.650128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F90190D0>]}
[0m14:54:30.713214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F8FB5400>]}
[0m14:54:30.713214 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:54:30.713214 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:54:30.839525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:30.840599 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m14:54:31.050449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F974E0C0>]}
[0m14:54:31.125479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F9713410>]}
[0m14:54:31.125479 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m14:54:31.125479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F93B16A0>]}
[0m14:54:31.125479 [info ] [MainThread]: 
[0m14:54:31.125479 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:54:31.125479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m14:54:31.125479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:32.248835 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m14:54:32.248835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:33.378039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F9280EF0>]}
[0m14:54:33.378039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:33.378039 [info ] [MainThread]: 
[0m14:54:33.378039 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m14:54:33.378039 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m14:54:33.378039 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m14:54:33.388191 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m14:54:33.391829 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:54:33.391829 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m14:54:33.428248 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m14:54:33.429253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:54:33.460046 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1
ORDER BY ASIN, EventTime, NotificationId, PublishTime;


[0m14:54:34.788391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a40ea2c9-dcac-4fc4-a735-f8d6af37f7e0&page=queryresults
[0m14:54:35.587638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3ebd6c-f8af-49b3-b20d-8a2b73d6f4d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F8C3F4A0>]}
[0m14:54:35.587638 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.21s]
[0m14:54:35.587638 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m14:54:35.587638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:35.587638 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m14:54:35.587638 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m14:54:35.587638 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m14:54:35.587638 [info ] [MainThread]: 
[0m14:54:35.587638 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m14:54:35.587638 [debug] [MainThread]: Command end result
[0m14:54:35.627380 [info ] [MainThread]: 
[0m14:54:35.627380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:35.627380 [info ] [MainThread]: 
[0m14:54:35.627380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:54:35.627380 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:35.627380 after 6.39 seconds
[0m14:54:35.627380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E532B500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E6179790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F93B2540>]}
[0m14:54:35.627380 [debug] [MainThread]: Flushing usage events
[0m15:23:04.101693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0559430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9FE399D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9FE39C10>]}


============================== 15:23:04.105694 | 553b673b-5d6b-4465-963f-6d06bad9bd34 ==============================
[0m15:23:04.105694 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:23:04.106692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:05.567380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB3ED7AA0>]}
[0m15:23:05.638753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9FE50AD0>]}
[0m15:23:05.639738 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:23:05.647798 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:23:05.778952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:05.779957 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m15:23:06.010180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB3F739B0>]}
[0m15:23:06.118498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB442B5C0>]}
[0m15:23:06.119492 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m15:23:06.120494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB3FF24E0>]}
[0m15:23:06.121496 [info ] [MainThread]: 
[0m15:23:06.122497 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:23:06.123493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:23:06.124503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:07.527537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:23:07.528539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:08.739936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB4190440>]}
[0m15:23:08.739936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:08.740934 [info ] [MainThread]: 
[0m15:23:08.743935 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:23:08.745932 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:23:08.746934 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:23:08.746934 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:23:08.752931 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:23:08.753955 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:23:08.784497 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:23:08.786496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:08.825770 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice) AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp.Amount) AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp.CurrencyCode) AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1
ORDER BY ASIN, EventTime, NotificationId, PublishTime;


[0m15:23:10.334060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:12ed9c62-05c7-428c-a7bb-7e66060d2c12&page=queryresults
[0m15:23:10.739357 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Cannot access field Payload on a value with type STRING at [35:37]; reason: invalidQuery, location: query, message: Cannot access field Payload on a value with type STRING at [35:37]')
[0m15:23:11.620281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:28e76093-c07b-4360-835a-ad85391203a6&page=queryresults
[0m15:23:12.035068 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:28e76093-c07b-4360-835a-ad85391203a6&page=queryresults
[0m15:23:12.041701 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Cannot access field Payload on a value with type STRING at [35:37]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m15:23:12.042612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553b673b-5d6b-4465-963f-6d06bad9bd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB40CD6A0>]}
[0m15:23:12.043610 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns ................ [[31mERROR[0m in 3.30s]
[0m15:23:12.045613 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:23:12.047611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:12.049178 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:23:12.049178 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:23:12.049178 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:23:12.050184 [info ] [MainThread]: 
[0m15:23:12.050184 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m15:23:12.051186 [debug] [MainThread]: Command end result
[0m15:23:12.086738 [info ] [MainThread]: 
[0m15:23:12.088749 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:23:12.089749 [info ] [MainThread]: 
[0m15:23:12.089749 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Cannot access field Payload on a value with type STRING at [35:37]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m15:23:12.090751 [info ] [MainThread]: 
[0m15:23:12.091762 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:12.093760 [debug] [MainThread]: Command `dbt run` failed at 15:23:12.092761 after 8.19 seconds
[0m15:23:12.093760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9FE399D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB4240EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB3DB6900>]}
[0m15:23:12.094760 [debug] [MainThread]: Flushing usage events
[0m15:24:56.324623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262061232F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026208EA4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026208EA6780>]}


============================== 15:24:56.324623 | b5174e02-a78c-40a2-b4c0-a7f0237de449 ==============================
[0m15:24:56.324623 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:24:56.337632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:24:57.664193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C240D40>]}
[0m15:24:57.721400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026208BE1D60>]}
[0m15:24:57.722400 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:24:57.729260 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:24:57.850350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:57.850350 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m15:24:58.056336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C76DFA0>]}
[0m15:24:58.146748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C7334A0>]}
[0m15:24:58.146748 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m15:24:58.146748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C3D2E10>]}
[0m15:24:58.146748 [info ] [MainThread]: 
[0m15:24:58.146748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:24:58.146748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:24:58.146748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:59.365732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:24:59.365732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:00.475725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C3D25D0>]}
[0m15:25:00.475725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:00.475725 [info ] [MainThread]: 
[0m15:25:00.475725 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:25:00.475725 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:25:00.475725 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:25:00.475725 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:25:00.490829 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:25:00.490829 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:25:00.507034 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:25:00.522668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:00.562361 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1;


[0m15:25:01.947464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7bb4e9fc-b460-42e6-a342-5df86fadd8a3&page=queryresults
[0m15:25:02.767142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5174e02-a78c-40a2-b4c0-a7f0237de449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621BC7B980>]}
[0m15:25:02.767142 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.29s]
[0m15:25:02.782659 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:25:02.782659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:02.782659 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:25:02.782659 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:25:02.782659 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:25:02.782659 [info ] [MainThread]: 
[0m15:25:02.782659 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m15:25:02.782659 [debug] [MainThread]: Command end result
[0m15:25:02.822081 [info ] [MainThread]: 
[0m15:25:02.822081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:02.822081 [info ] [MainThread]: 
[0m15:25:02.822081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:02.822081 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:02.822081 after 6.61 seconds
[0m15:25:02.822081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026206CDEB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002621C66B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262061232F0>]}
[0m15:25:02.822081 [debug] [MainThread]: Flushing usage events
[0m15:28:29.233997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BD672DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BFF5C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BDE29520>]}


============================== 15:28:29.233997 | 3df72889-edec-4bb4-a535-aecc2096b384 ==============================
[0m15:28:29.233997 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:28:29.233997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m15:28:30.454565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BDE7A7B0>]}
[0m15:28:30.517067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BF444BF0>]}
[0m15:28:30.517067 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:28:30.534671 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:28:30.653157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:30.653157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:30.668880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D36A1430>]}
[0m15:28:30.750462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D38A4140>]}
[0m15:28:30.750462 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m15:28:30.750462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D35F79B0>]}
[0m15:28:30.766107 [info ] [MainThread]: 
[0m15:28:30.766107 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:28:30.766107 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:28:30.769247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:32.006582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:28:32.006582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:33.151225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192BF829700>]}
[0m15:28:33.151225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:33.151225 [info ] [MainThread]: 
[0m15:28:33.151225 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:28:33.151225 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:28:33.151225 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:28:33.151225 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:28:33.171336 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:28:33.171336 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:28:33.191310 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:28:33.191310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:33.244093 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1;


[0m15:28:34.577531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:5a820ab6-ef5a-4fb4-9532-c3a78df28abd&page=queryresults
[0m15:28:35.409161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df72889-edec-4bb4-a535-aecc2096b384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D2F38DA0>]}
[0m15:28:35.409161 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m15:28:35.409161 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:28:35.409161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:35.409161 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:28:35.409161 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:28:35.409161 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:28:35.409161 [info ] [MainThread]: 
[0m15:28:35.409161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m15:28:35.424811 [debug] [MainThread]: Command end result
[0m15:28:35.455042 [info ] [MainThread]: 
[0m15:28:35.455042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:35.455042 [info ] [MainThread]: 
[0m15:28:35.455042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:28:35.455042 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:35.455042 after 6.42 seconds
[0m15:28:35.455042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C00FE060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D36CE570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D36A13A0>]}
[0m15:28:35.455042 [debug] [MainThread]: Flushing usage events
[0m15:37:47.552110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EEA3E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EB67AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EF2DDC70>]}


============================== 15:37:47.556127 | 3525ff3e-77c6-4ed8-9dde-bea796c590f4 ==============================
[0m15:37:47.556127 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:37:47.556127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:48.938366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C183452BD0>]}
[0m15:37:48.995354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C18336B650>]}
[0m15:37:48.996308 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:37:49.005703 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:37:49.130123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:49.130123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:49.155458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C183625D90>]}
[0m15:37:49.245399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C183854A70>]}
[0m15:37:49.246418 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m15:37:49.246418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C183652480>]}
[0m15:37:49.248497 [info ] [MainThread]: 
[0m15:37:49.249414 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:37:49.250566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:37:49.250566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:50.478846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:37:50.479846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:51.613213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1836A8E90>]}
[0m15:37:51.613213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:51.614205 [info ] [MainThread]: 
[0m15:37:51.618204 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:37:51.619201 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:37:51.620209 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:37:51.621203 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:37:51.630590 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:37:51.632728 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:37:51.668543 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:37:51.669543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:51.711828 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1;


[0m15:37:53.131390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e3ee7d5c-a26d-428e-b430-821af4b29d3b&page=queryresults
[0m15:37:53.987049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3525ff3e-77c6-4ed8-9dde-bea796c590f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C182EDFCE0>]}
[0m15:37:53.987049 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m15:37:53.988270 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:37:53.990539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:53.990539 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:37:53.990539 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:37:53.990539 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:37:53.990539 [info ] [MainThread]: 
[0m15:37:53.991538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m15:37:53.992575 [debug] [MainThread]: Command end result
[0m15:37:54.020537 [info ] [MainThread]: 
[0m15:37:54.021539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:54.022537 [info ] [MainThread]: 
[0m15:37:54.023534 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:54.024536 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:54.024536 after 6.65 seconds
[0m15:37:54.025542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EB9FCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EE24CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1836106E0>]}
[0m15:37:54.025542 [debug] [MainThread]: Flushing usage events
[0m15:39:03.947334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF1152180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF0D4A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF11524E0>]}


============================== 15:39:03.958843 | 11ca94e0-3bc9-472c-8784-9889366f5058 ==============================
[0m15:39:03.958843 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:39:03.958843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:39:05.169215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B843E6450>]}
[0m15:39:05.242849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF0FCF530>]}
[0m15:39:05.242849 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:39:05.247946 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:39:05.368623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:05.368623 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m15:39:05.576872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF04885C0>]}
[0m15:39:05.649710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B84813500>]}
[0m15:39:05.649710 [info ] [MainThread]: Found 11 models, 1 seed, 478 macros
[0m15:39:05.663265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B844B3800>]}
[0m15:39:05.663265 [info ] [MainThread]: 
[0m15:39:05.665797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:05.665797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:39:05.665797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:06.824593 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:39:06.824593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:07.968598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B84728740>]}
[0m15:39:07.968598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:07.968598 [info ] [MainThread]: 
[0m15:39:07.968598 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:39:07.968598 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:39:07.981126 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:39:07.981126 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:39:07.985772 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:39:07.985772 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:39:08.014880 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:39:08.017918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:08.060650 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lpp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lpp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lpp, "$.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lpp) AS lpp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1;


[0m15:39:09.370289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:20f84d56-3c54-4b74-9a85-a13bb86014c1&page=queryresults
[0m15:39:10.227550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11ca94e0-3bc9-472c-8784-9889366f5058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B83D48680>]}
[0m15:39:10.227550 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m15:39:10.229207 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:39:10.230351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:10.230351 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:39:10.231454 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:39:10.231454 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:39:10.231454 [info ] [MainThread]: 
[0m15:39:10.232357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m15:39:10.233358 [debug] [MainThread]: Command end result
[0m15:39:10.253408 [info ] [MainThread]: 
[0m15:39:10.269183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:10.269183 [info ] [MainThread]: 
[0m15:39:10.269183 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:10.272271 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:10.272271 after 6.44 seconds
[0m15:39:10.272271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BEECF80E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B845CF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B8469D2E0>]}
[0m15:39:10.272271 [debug] [MainThread]: Flushing usage events
[0m10:43:52.619377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD65484D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8723740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8CF9A00>]}


============================== 10:43:52.619377 | 348cce33-6762-47cd-8eb8-7f780f4b9089 ==============================
[0m10:43:52.619377 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:43:52.619377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:52.662579 [info ] [MainThread]: dbt version: 1.8.6
[0m10:43:52.662579 [info ] [MainThread]: python version: 3.12.6
[0m10:43:52.662579 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m10:43:52.665017 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m10:43:55.004268 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m10:43:55.004268 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m10:43:55.004268 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m10:43:55.004268 [info ] [MainThread]: adapter type: bigquery
[0m10:43:55.004268 [info ] [MainThread]: adapter version: 1.8.2
[0m10:43:55.102233 [info ] [MainThread]: Configuration:
[0m10:43:55.110271 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:43:55.110271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:43:55.110271 [info ] [MainThread]: Required dependencies:
[0m10:43:55.110271 [debug] [MainThread]: Executing "git --help"
[0m10:43:55.176288 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:43:55.176288 [debug] [MainThread]: STDERR: "b''"
[0m10:43:55.176288 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:43:55.176288 [info ] [MainThread]: Connection:
[0m10:43:55.179247 [info ] [MainThread]:   method: service-account
[0m10:43:55.180052 [info ] [MainThread]:   database: dbt-437212
[0m10:43:55.180052 [info ] [MainThread]:   execution_project: dbt-437212
[0m10:43:55.180052 [info ] [MainThread]:   schema: wellbefore
[0m10:43:55.180052 [info ] [MainThread]:   location: US
[0m10:43:55.180052 [info ] [MainThread]:   priority: interactive
[0m10:43:55.180052 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:43:55.180052 [info ] [MainThread]:   impersonate_service_account: None
[0m10:43:55.180052 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:43:55.180052 [info ] [MainThread]:   job_retries: 1
[0m10:43:55.180052 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:43:55.180052 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m10:43:55.180052 [info ] [MainThread]:   timeout_seconds: 300
[0m10:43:55.180052 [info ] [MainThread]:   client_id: None
[0m10:43:55.189557 [info ] [MainThread]:   token_uri: None
[0m10:43:55.189557 [info ] [MainThread]:   dataproc_region: None
[0m10:43:55.189557 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:43:55.189557 [info ] [MainThread]:   gcs_bucket: None
[0m10:43:55.189557 [info ] [MainThread]:   dataproc_batch: None
[0m10:43:55.189557 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:43:55.189557 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:43:55.189557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:55.189557 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'expected str, bytes or os.PathLike object, not NoneType'
[0m10:43:55.189557 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:43:55.196158 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:43:55.196158 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  expected str, bytes or os.PathLike object, not NoneType

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:43:55.197665 [debug] [MainThread]: Command `dbt debug` failed at 10:43:55.197665 after 2.81 seconds
[0m10:43:55.197665 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:43:55.200943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD65484D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBEBF0A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBEBF69760>]}
[0m10:43:55.200943 [debug] [MainThread]: Flushing usage events
[0m10:44:37.891466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3AD32840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3D454D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3D456270>]}


============================== 10:44:37.891466 | 3fb138a2-a0f8-47b4-8644-7eac689fbb36 ==============================
[0m10:44:37.891466 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:44:37.891466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:37.914781 [info ] [MainThread]: dbt version: 1.8.6
[0m10:44:37.914781 [info ] [MainThread]: python version: 3.12.6
[0m10:44:37.914781 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m10:44:37.914781 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m10:44:39.075631 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m10:44:39.075631 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m10:44:39.075631 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m10:44:39.075631 [info ] [MainThread]: adapter type: bigquery
[0m10:44:39.075631 [info ] [MainThread]: adapter version: 1.8.2
[0m10:44:39.169373 [info ] [MainThread]: Configuration:
[0m10:44:39.169373 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:44:39.169373 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:44:39.175994 [info ] [MainThread]: Required dependencies:
[0m10:44:39.175994 [debug] [MainThread]: Executing "git --help"
[0m10:44:39.225489 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:44:39.225489 [debug] [MainThread]: STDERR: "b''"
[0m10:44:39.225489 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:44:39.225489 [info ] [MainThread]: Connection:
[0m10:44:39.230392 [info ] [MainThread]:   method: service-account
[0m10:44:39.230392 [info ] [MainThread]:   database: dbt-437212
[0m10:44:39.231821 [info ] [MainThread]:   execution_project: dbt-437212
[0m10:44:39.231821 [info ] [MainThread]:   schema: wellbefore
[0m10:44:39.231821 [info ] [MainThread]:   location: US
[0m10:44:39.231821 [info ] [MainThread]:   priority: interactive
[0m10:44:39.231821 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:44:39.231821 [info ] [MainThread]:   impersonate_service_account: None
[0m10:44:39.231821 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:44:39.231821 [info ] [MainThread]:   job_retries: 1
[0m10:44:39.231821 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:44:39.231821 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m10:44:39.231821 [info ] [MainThread]:   timeout_seconds: 300
[0m10:44:39.231821 [info ] [MainThread]:   client_id: None
[0m10:44:39.240831 [info ] [MainThread]:   token_uri: None
[0m10:44:39.240831 [info ] [MainThread]:   dataproc_region: None
[0m10:44:39.240831 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:44:39.240831 [info ] [MainThread]:   gcs_bucket: None
[0m10:44:39.240831 [info ] [MainThread]:   dataproc_batch: None
[0m10:44:39.240831 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:44:39.240831 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:44:39.240831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:39.298667 [debug] [MainThread]: On debug: select 1 as id
[0m10:44:41.358703 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:89b4d524-37c1-4e6f-b511-24a310c38cac&page=queryresults
[0m10:44:41.358703 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:44:41.358703 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:44:41.358703 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Access Denied: Project dbt-437212: User does not have bigquery.jobs.create permission in project dbt-437212.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:44:41.372600 [debug] [MainThread]: Command `dbt debug` failed at 10:44:41.372420 after 3.61 seconds
[0m10:44:41.372814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:44:41.372814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3D54A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B50517B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B50F2D5B0>]}
[0m10:44:41.372814 [debug] [MainThread]: Flushing usage events
[0m10:45:52.493609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265F7DF91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265F42E5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265F7DF9280>]}


============================== 10:45:52.496701 | 8b9937a3-0ad9-4e63-ab14-8b03ce75c78a ==============================
[0m10:45:52.496701 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:45:52.497731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:45:52.511357 [info ] [MainThread]: dbt version: 1.8.6
[0m10:45:52.512473 [info ] [MainThread]: python version: 3.12.6
[0m10:45:52.512985 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m10:45:52.513524 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m10:45:53.660109 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m10:45:53.661144 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m10:45:53.661144 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m10:45:53.661867 [info ] [MainThread]: adapter type: bigquery
[0m10:45:53.662389 [info ] [MainThread]: adapter version: 1.8.2
[0m10:45:53.758928 [info ] [MainThread]: Configuration:
[0m10:45:53.763453 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:45:53.763453 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:45:53.763453 [info ] [MainThread]: Required dependencies:
[0m10:45:53.763453 [debug] [MainThread]: Executing "git --help"
[0m10:45:53.819367 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:45:53.819896 [debug] [MainThread]: STDERR: "b''"
[0m10:45:53.820432 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:45:53.820975 [info ] [MainThread]: Connection:
[0m10:45:53.822007 [info ] [MainThread]:   method: service-account
[0m10:45:53.822007 [info ] [MainThread]:   database: de-coe
[0m10:45:53.823034 [info ] [MainThread]:   execution_project: de-coe
[0m10:45:53.823545 [info ] [MainThread]:   schema: buybox_dataset
[0m10:45:53.824073 [info ] [MainThread]:   location: US
[0m10:45:53.824945 [info ] [MainThread]:   priority: interactive
[0m10:45:53.825557 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:45:53.826157 [info ] [MainThread]:   impersonate_service_account: None
[0m10:45:53.826776 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:45:53.827402 [info ] [MainThread]:   job_retries: 1
[0m10:45:53.827912 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:45:53.828778 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m10:45:53.829415 [info ] [MainThread]:   timeout_seconds: 300
[0m10:45:53.830031 [info ] [MainThread]:   client_id: None
[0m10:45:53.830543 [info ] [MainThread]:   token_uri: None
[0m10:45:53.831265 [info ] [MainThread]:   dataproc_region: None
[0m10:45:53.831923 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:45:53.832445 [info ] [MainThread]:   gcs_bucket: None
[0m10:45:53.833566 [info ] [MainThread]:   dataproc_batch: None
[0m10:45:53.835073 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:45:53.835597 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:45:53.836272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:53.874707 [debug] [MainThread]: On debug: select 1 as id
[0m10:45:56.013111 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:7cac7846-42f6-47b4-a9cf-5799a1b9cd09&page=queryresults
[0m10:45:57.225900 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:45:57.225900 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:45:57.225900 [debug] [MainThread]: Command `dbt debug` succeeded at 10:45:57.225900 after 4.91 seconds
[0m10:45:57.225900 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:45:57.225900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658B40F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658B5A11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658B3AA0C0>]}
[0m10:45:57.225900 [debug] [MainThread]: Flushing usage events
[0m12:57:04.725477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D912840770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9104557C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D91591F020>]}


============================== 12:57:04.740512 | e74b2153-03ea-4cea-ac4d-8fcefda0daa0 ==============================
[0m12:57:04.740512 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:57:04.740512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:57:04.758058 [info ] [MainThread]: dbt version: 1.8.6
[0m12:57:04.758058 [info ] [MainThread]: python version: 3.12.6
[0m12:57:04.758058 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m12:57:04.758058 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:57:06.216213 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m12:57:06.216213 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m12:57:06.216213 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m12:57:06.216213 [info ] [MainThread]: adapter type: bigquery
[0m12:57:06.216213 [info ] [MainThread]: adapter version: 1.8.2
[0m12:57:06.317849 [info ] [MainThread]: Configuration:
[0m12:57:06.317849 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:57:06.317849 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:57:06.317849 [info ] [MainThread]: Required dependencies:
[0m12:57:06.317849 [debug] [MainThread]: Executing "git --help"
[0m12:57:06.366814 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:57:06.367824 [debug] [MainThread]: STDERR: "b''"
[0m12:57:06.368231 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:57:06.369120 [info ] [MainThread]: Connection:
[0m12:57:06.369120 [info ] [MainThread]:   method: service-account
[0m12:57:06.369120 [info ] [MainThread]:   database: de-coe
[0m12:57:06.369120 [info ] [MainThread]:   execution_project: de-coe
[0m12:57:06.369120 [info ] [MainThread]:   schema: buybox_dataset
[0m12:57:06.369120 [info ] [MainThread]:   location: US
[0m12:57:06.369120 [info ] [MainThread]:   priority: interactive
[0m12:57:06.369120 [info ] [MainThread]:   maximum_bytes_billed: None
[0m12:57:06.369120 [info ] [MainThread]:   impersonate_service_account: None
[0m12:57:06.369120 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m12:57:06.369120 [info ] [MainThread]:   job_retries: 1
[0m12:57:06.369120 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m12:57:06.369120 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m12:57:06.369120 [info ] [MainThread]:   timeout_seconds: 300
[0m12:57:06.369120 [info ] [MainThread]:   client_id: None
[0m12:57:06.369120 [info ] [MainThread]:   token_uri: None
[0m12:57:06.369120 [info ] [MainThread]:   dataproc_region: None
[0m12:57:06.369120 [info ] [MainThread]:   dataproc_cluster_name: None
[0m12:57:06.369120 [info ] [MainThread]:   gcs_bucket: None
[0m12:57:06.369120 [info ] [MainThread]:   dataproc_batch: None
[0m12:57:06.369120 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:57:06.369120 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m12:57:06.369120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:06.420662 [debug] [MainThread]: On debug: select 1 as id
[0m12:57:08.233828 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:0f7f6b47-929f-411a-a25a-e1c5ae58b13d&page=queryresults
[0m12:57:09.238181 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:57:09.238181 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:57:09.238181 [debug] [MainThread]: Command `dbt debug` succeeded at 12:57:09.238181 after 4.69 seconds
[0m12:57:09.238181 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:57:09.238181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D912840770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D929625790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9157DCF20>]}
[0m12:57:09.238181 [debug] [MainThread]: Flushing usage events
[0m12:57:26.178478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0805015B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C080502CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C080501A00>]}


============================== 12:57:26.187995 | 1355216e-30ee-4bc9-a172-7e724733c67c ==============================
[0m12:57:26.187995 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:57:26.187995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m12:57:27.545737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1355216e-30ee-4bc9-a172-7e724733c67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C09362C2C0>]}
[0m12:57:27.598856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1355216e-30ee-4bc9-a172-7e724733c67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C09362C2C0>]}
[0m12:57:27.598856 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:57:27.598856 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:57:27.669156 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:27.669156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1355216e-30ee-4bc9-a172-7e724733c67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0801425A0>]}
[0m12:57:28.876379 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.fct_sellers' (models\fact\fct_sellers.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m12:57:28.878389 [debug] [MainThread]: Command `dbt run` failed at 12:57:28.878389 after 2.81 seconds
[0m12:57:28.878389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C080709C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0940C1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FE4F32F0>]}
[0m12:57:28.879390 [debug] [MainThread]: Flushing usage events
[0m12:58:10.445168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7D0E24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7CEF49B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7D0E3C80>]}


============================== 12:58:10.445168 | 90f40bb2-0a63-4e07-8650-e52948a975ae ==============================
[0m12:58:10.445168 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:58:10.445168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_all_columns', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:11.915139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f40bb2-0a63-4e07-8650-e52948a975ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C10087FB0>]}
[0m12:58:11.990180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f40bb2-0a63-4e07-8650-e52948a975ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7CCD5850>]}
[0m12:58:11.994103 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:58:11.995401 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:58:12.072282 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:58:12.073262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90f40bb2-0a63-4e07-8650-e52948a975ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C108ED0A0>]}
[0m12:58:13.211780 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.dim_all_columns' (models\dim\dim_all_columns.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m12:58:13.211780 [debug] [MainThread]: Command `dbt run` failed at 12:58:13.211780 after 2.90 seconds
[0m12:58:13.211780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7D12B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C106E6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C10BC2420>]}
[0m12:58:13.211780 [debug] [MainThread]: Flushing usage events
[0m13:01:40.440384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0BBEF7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B8DACB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0BC481340>]}


============================== 13:01:40.445569 | c92a8fea-e3c7-4939-83c3-7a6c466ba174 ==============================
[0m13:01:40.445569 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:01:40.446567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:40.467425 [info ] [MainThread]: dbt version: 1.8.6
[0m13:01:40.467425 [info ] [MainThread]: python version: 3.12.6
[0m13:01:40.467425 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:01:40.473094 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:01:41.975070 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:01:41.975519 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:01:41.975519 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m13:01:41.976812 [info ] [MainThread]: adapter type: bigquery
[0m13:01:41.977243 [info ] [MainThread]: adapter version: 1.8.2
[0m13:01:42.073884 [info ] [MainThread]: Configuration:
[0m13:01:42.073884 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:01:42.073884 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:01:42.073884 [info ] [MainThread]: Required dependencies:
[0m13:01:42.073884 [debug] [MainThread]: Executing "git --help"
[0m13:01:42.149752 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:01:42.150781 [debug] [MainThread]: STDERR: "b''"
[0m13:01:42.151820 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:01:42.152628 [info ] [MainThread]: Connection:
[0m13:01:42.154021 [info ] [MainThread]:   method: service-account
[0m13:01:42.155172 [info ] [MainThread]:   database: de-coe
[0m13:01:42.155680 [info ] [MainThread]:   execution_project: de-coe
[0m13:01:42.156633 [info ] [MainThread]:   schema: wellbefore
[0m13:01:42.157686 [info ] [MainThread]:   location: US
[0m13:01:42.158748 [info ] [MainThread]:   priority: interactive
[0m13:01:42.159819 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:01:42.160599 [info ] [MainThread]:   impersonate_service_account: None
[0m13:01:42.161800 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:01:42.162307 [info ] [MainThread]:   job_retries: 1
[0m13:01:42.163372 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:01:42.163892 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:01:42.164423 [info ] [MainThread]:   timeout_seconds: 300
[0m13:01:42.165132 [info ] [MainThread]:   client_id: None
[0m13:01:42.166168 [info ] [MainThread]:   token_uri: None
[0m13:01:42.166700 [info ] [MainThread]:   dataproc_region: None
[0m13:01:42.167751 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:01:42.168340 [info ] [MainThread]:   gcs_bucket: None
[0m13:01:42.169409 [info ] [MainThread]:   dataproc_batch: None
[0m13:01:42.170573 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:01:42.171669 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:01:42.171669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:42.220942 [debug] [MainThread]: On debug: select 1 as id
[0m13:01:43.888074 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:e38feae3-29a7-4216-a443-3952557f03c5&page=queryresults
[0m13:01:43.888074 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:01:43.888074 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:01:43.888074 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Access Denied: Project de-coe: User does not have bigquery.jobs.create permission in project de-coe.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:01:43.888074 [debug] [MainThread]: Command `dbt debug` failed at 13:01:43.888074 after 3.65 seconds
[0m13:01:43.888074 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:01:43.888074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0BC7E2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0BC813EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0BC8BB5F0>]}
[0m13:01:43.888074 [debug] [MainThread]: Flushing usage events
[0m13:01:49.333335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F18B0E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F19262F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F19261D30>]}


============================== 13:01:49.333335 | 27678f44-5105-4e5f-b69f-8557c91ebae0 ==============================
[0m13:01:49.333335 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:01:49.333335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:49.351039 [info ] [MainThread]: dbt version: 1.8.6
[0m13:01:49.351039 [info ] [MainThread]: python version: 3.12.6
[0m13:01:49.356471 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:01:49.357480 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:01:50.555000 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:01:50.556117 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:01:50.557183 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m13:01:50.558248 [info ] [MainThread]: adapter type: bigquery
[0m13:01:50.558795 [info ] [MainThread]: adapter version: 1.8.2
[0m13:01:50.648117 [info ] [MainThread]: Configuration:
[0m13:01:50.649268 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:01:50.650240 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:01:50.651251 [info ] [MainThread]: Required dependencies:
[0m13:01:50.651648 [debug] [MainThread]: Executing "git --help"
[0m13:01:50.692188 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:01:50.692188 [debug] [MainThread]: STDERR: "b''"
[0m13:01:50.692188 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:01:50.692188 [info ] [MainThread]: Connection:
[0m13:01:50.692188 [info ] [MainThread]:   method: service-account
[0m13:01:50.692188 [info ] [MainThread]:   database: dbt-437212
[0m13:01:50.692188 [info ] [MainThread]:   execution_project: dbt-437212
[0m13:01:50.692188 [info ] [MainThread]:   schema: wellbefore
[0m13:01:50.692188 [info ] [MainThread]:   location: US
[0m13:01:50.692188 [info ] [MainThread]:   priority: interactive
[0m13:01:50.692188 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:01:50.692188 [info ] [MainThread]:   impersonate_service_account: None
[0m13:01:50.692188 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:01:50.692188 [info ] [MainThread]:   job_retries: 1
[0m13:01:50.692188 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:01:50.692188 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:01:50.692188 [info ] [MainThread]:   timeout_seconds: 300
[0m13:01:50.692188 [info ] [MainThread]:   client_id: None
[0m13:01:50.692188 [info ] [MainThread]:   token_uri: None
[0m13:01:50.706510 [info ] [MainThread]:   dataproc_region: None
[0m13:01:50.707607 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:01:50.707607 [info ] [MainThread]:   gcs_bucket: None
[0m13:01:50.708682 [info ] [MainThread]:   dataproc_batch: None
[0m13:01:50.708682 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:01:50.708682 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:01:50.708682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:50.741922 [debug] [MainThread]: On debug: select 1 as id
[0m13:01:52.223451 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:62b37fcb-af34-4266-866f-67bafe2314fc&page=queryresults
[0m13:01:53.121168 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:01:53.121168 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:01:53.121168 [debug] [MainThread]: Command `dbt debug` succeeded at 13:01:53.121168 after 3.91 seconds
[0m13:01:53.121168 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:01:53.121168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F18B0E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1983E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1983DAC0>]}
[0m13:01:53.121168 [debug] [MainThread]: Flushing usage events
[0m13:05:35.968847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FD8A9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FD8AB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FE162540>]}


============================== 13:05:35.968847 | 44fcb33d-08fa-4fd1-a23a-27517eb9e2d0 ==============================
[0m13:05:35.968847 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:05:35.968847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:05:35.985968 [info ] [MainThread]: dbt version: 1.8.6
[0m13:05:35.985968 [info ] [MainThread]: python version: 3.12.6
[0m13:05:35.985968 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:05:35.988398 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:05:37.135591 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:05:37.135591 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:05:37.135591 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m13:05:37.135591 [info ] [MainThread]: adapter type: bigquery
[0m13:05:37.135591 [info ] [MainThread]: adapter version: 1.8.2
[0m13:05:37.240662 [info ] [MainThread]: Configuration:
[0m13:05:37.241572 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:05:37.241572 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:05:37.242994 [info ] [MainThread]: Required dependencies:
[0m13:05:37.243482 [debug] [MainThread]: Executing "git --help"
[0m13:05:37.288290 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:05:37.288290 [debug] [MainThread]: STDERR: "b''"
[0m13:05:37.288290 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:05:37.288290 [info ] [MainThread]: Connection:
[0m13:05:37.288290 [info ] [MainThread]:   method: service-account
[0m13:05:37.288290 [info ] [MainThread]:   database: de-coe
[0m13:05:37.288290 [info ] [MainThread]:   execution_project: de-coe
[0m13:05:37.288290 [info ] [MainThread]:   schema: buybox_dataset
[0m13:05:37.288290 [info ] [MainThread]:   location: US
[0m13:05:37.294944 [info ] [MainThread]:   priority: interactive
[0m13:05:37.294944 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:05:37.296417 [info ] [MainThread]:   impersonate_service_account: None
[0m13:05:37.296417 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:05:37.296417 [info ] [MainThread]:   job_retries: 1
[0m13:05:37.296417 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:05:37.296417 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:05:37.296417 [info ] [MainThread]:   timeout_seconds: 300
[0m13:05:37.296417 [info ] [MainThread]:   client_id: None
[0m13:05:37.296417 [info ] [MainThread]:   token_uri: None
[0m13:05:37.296417 [info ] [MainThread]:   dataproc_region: None
[0m13:05:37.296417 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:05:37.296417 [info ] [MainThread]:   gcs_bucket: None
[0m13:05:37.296417 [info ] [MainThread]:   dataproc_batch: None
[0m13:05:37.296417 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:05:37.296417 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:05:37.296417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:37.330324 [debug] [MainThread]: On debug: select 1 as id
[0m13:05:39.009456 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:421ee9ef-082b-4226-b225-8222625326a7&page=queryresults
[0m13:05:39.928956 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:05:39.928956 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:05:39.944056 [debug] [MainThread]: Command `dbt debug` succeeded at 13:05:39.944056 after 4.17 seconds
[0m13:05:39.944056 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:05:39.944056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211910BB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FBD85B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FD17B350>]}
[0m13:05:39.944056 [debug] [MainThread]: Flushing usage events
[0m13:07:35.063520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAC2832C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAB759DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAC283A10>]}


============================== 13:07:35.063520 | 2e7183c5-ec3a-472e-8bc3-c7235c79aa42 ==============================
[0m13:07:35.063520 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:07:35.063520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:36.387096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBEF93C80>]}
[0m13:07:36.449853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBF636E40>]}
[0m13:07:36.449853 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:07:36.467645 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:07:36.516112 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:07:36.516112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAB9927B0>]}
[0m13:07:37.755429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBFD2FD70>]}
[0m13:07:37.845005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBFD2C530>]}
[0m13:07:37.845005 [info ] [MainThread]: Found 16 models, 1 seed, 1 source, 478 macros
[0m13:07:37.845005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC0E51B20>]}
[0m13:07:37.845005 [info ] [MainThread]: 
[0m13:07:37.860634 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:07:37.860634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-coe'
[0m13:07:37.860634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:40.088756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-coe_buybox_dataset'
[0m13:07:40.088756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:41.480349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBFB53680>]}
[0m13:07:41.480349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:41.480349 [info ] [MainThread]: 
[0m13:07:41.489736 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m13:07:41.489736 [info ] [Thread-1 (]: 1 of 1 START sql view model buybox_dataset.dim_all_columns ..................... [RUN]
[0m13:07:41.490893 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m13:07:41.492104 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m13:07:41.501261 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m13:07:41.501261 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m13:07:41.533945 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m13:07:41.543459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:41.598223 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `de-coe`.`buybox_dataset`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM 
            `de-coe`.`buybox_dataset`.`merge_seed_final_table`

),
flatten_payload AS (
    SELECT 
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM 
        source_data
),
flattened_payload_1 AS (
SELECT 
    EventTime,
    ApplicationId,
    NotificationId,
    PublishTime,
    SubscriptionId,
    NotificationType,
    NotificationVersion,
    ASIN,
    ItemCondition,
    MarketplaceId,
    OfferChangeType,
    TimeOfOfferChange,

    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
    JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

    JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
    JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
    JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
    CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
    JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
    JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

    JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
    JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
    JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

    CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
    JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

    JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
    JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

    JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
    JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
    JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

    JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
    CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

    CAST(JSON_EXTRACT_SCALAR(lp, "$.lp.Amount") AS FLOAT64) AS ListPriceAmount,
    JSON_EXTRACT_SCALAR(lp, "$.lp.CurrencyCode") AS ListPriceCurrencyCode

FROM 
    flatten_payload
    LEFT JOIN UNNEST(offers) AS offer
    LEFT JOIN UNNEST(bbp) AS bbp
    LEFT JOIN UNNEST(lop) AS lop
    LEFT JOIN UNNEST(neo) AS neo
    LEFT JOIN UNNEST(noo) AS noo
    LEFT JOIN UNNEST(lp) AS lp
    LEFT JOIN UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload_1;


[0m13:07:43.221099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:d1238c61-f08d-4600-a005-e689244c372b&page=queryresults
[0m13:07:44.155623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7183c5-ec3a-472e-8bc3-c7235c79aa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBED987D0>]}
[0m13:07:44.155623 [info ] [Thread-1 (]: 1 of 1 OK created sql view model buybox_dataset.dim_all_columns ................ [[32mCREATE VIEW (0 processed)[0m in 2.66s]
[0m13:07:44.155623 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m13:07:44.164787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:44.164787 [debug] [MainThread]: Connection 'list_de-coe' was properly closed.
[0m13:07:44.164787 [debug] [MainThread]: Connection 'list_de-coe_buybox_dataset' was properly closed.
[0m13:07:44.164787 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m13:07:44.165904 [info ] [MainThread]: 
[0m13:07:44.166710 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m13:07:44.167718 [debug] [MainThread]: Command end result
[0m13:07:44.274799 [info ] [MainThread]: 
[0m13:07:44.275797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:44.275797 [info ] [MainThread]: 
[0m13:07:44.276797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:07:44.278932 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:44.278932 after 9.40 seconds
[0m13:07:44.281303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC0F8EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC0F8F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC0F8FAA0>]}
[0m13:07:44.283314 [debug] [MainThread]: Flushing usage events
[0m15:54:35.387621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5CA622D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5C340350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5C67C7A0>]}


============================== 15:54:35.387621 | 52ad9de3-34fc-4b60-86ba-aa83809aa980 ==============================
[0m15:54:35.387621 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:54:35.387621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:54:35.403368 [info ] [MainThread]: dbt version: 1.8.6
[0m15:54:35.403368 [info ] [MainThread]: python version: 3.12.6
[0m15:54:35.403368 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m15:54:35.403368 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:54:36.796600 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m15:54:36.796600 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m15:54:36.796600 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m15:54:36.811106 [info ] [MainThread]: adapter type: bigquery
[0m15:54:36.811106 [info ] [MainThread]: adapter version: 1.8.2
[0m15:54:36.903005 [info ] [MainThread]: Configuration:
[0m15:54:36.903005 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:54:36.903005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:54:36.911627 [info ] [MainThread]: Required dependencies:
[0m15:54:36.912133 [debug] [MainThread]: Executing "git --help"
[0m15:54:36.957021 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:54:36.957021 [debug] [MainThread]: STDERR: "b''"
[0m15:54:36.957021 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:54:36.962266 [info ] [MainThread]: Connection:
[0m15:54:36.962266 [info ] [MainThread]:   method: service-account
[0m15:54:36.963839 [info ] [MainThread]:   database: de-coe
[0m15:54:36.963839 [info ] [MainThread]:   execution_project: de-coe
[0m15:54:36.963839 [info ] [MainThread]:   schema: wellbefore
[0m15:54:36.963839 [info ] [MainThread]:   location: US
[0m15:54:36.963839 [info ] [MainThread]:   priority: interactive
[0m15:54:36.963839 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:54:36.963839 [info ] [MainThread]:   impersonate_service_account: None
[0m15:54:36.963839 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:54:36.963839 [info ] [MainThread]:   job_retries: 1
[0m15:54:36.963839 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:54:36.963839 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:54:36.963839 [info ] [MainThread]:   timeout_seconds: 300
[0m15:54:36.963839 [info ] [MainThread]:   client_id: None
[0m15:54:36.963839 [info ] [MainThread]:   token_uri: None
[0m15:54:36.963839 [info ] [MainThread]:   dataproc_region: None
[0m15:54:36.963839 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:54:36.974471 [info ] [MainThread]:   gcs_bucket: None
[0m15:54:36.976460 [info ] [MainThread]:   dataproc_batch: None
[0m15:54:36.978914 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:54:36.980967 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:54:36.980967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:37.013906 [debug] [MainThread]: On debug: select 1 as id
[0m15:54:38.353942 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:899ba6ff-d9c1-4501-9edf-7bb1bba2ae61&page=queryresults
[0m15:54:38.356058 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:54:38.357965 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:54:38.359963 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Access Denied: Project de-coe: User does not have bigquery.jobs.create permission in project de-coe.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:54:38.362639 [debug] [MainThread]: Command `dbt debug` failed at 15:54:38.362639 after 3.16 seconds
[0m15:54:38.362639 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:54:38.362639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E590FCB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E70076B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5CA09AF0>]}
[0m15:54:38.362639 [debug] [MainThread]: Flushing usage events
[0m15:55:13.859039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE61CD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE63699D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE6369220>]}


============================== 15:55:13.859039 | 21783213-c04e-4f36-b3f5-cf87478a1cb7 ==============================
[0m15:55:13.859039 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:55:13.859039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:55:13.882318 [info ] [MainThread]: dbt version: 1.8.6
[0m15:55:13.882318 [info ] [MainThread]: python version: 3.12.6
[0m15:55:13.882318 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m15:55:13.882318 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:55:15.130076 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m15:55:15.130076 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m15:55:15.130076 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m15:55:15.130076 [info ] [MainThread]: adapter type: bigquery
[0m15:55:15.130076 [info ] [MainThread]: adapter version: 1.8.2
[0m15:55:15.241228 [info ] [MainThread]: Configuration:
[0m15:55:15.241802 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:55:15.242989 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:55:15.242989 [info ] [MainThread]: Required dependencies:
[0m15:55:15.243996 [debug] [MainThread]: Executing "git --help"
[0m15:55:15.297509 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:55:15.298514 [debug] [MainThread]: STDERR: "b''"
[0m15:55:15.298514 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:55:15.303341 [info ] [MainThread]: Connection:
[0m15:55:15.305513 [info ] [MainThread]:   method: service-account
[0m15:55:15.306187 [info ] [MainThread]:   database: dbt-437212
[0m15:55:15.306187 [info ] [MainThread]:   execution_project: dbt-437212
[0m15:55:15.308753 [info ] [MainThread]:   schema: wellbefore
[0m15:55:15.315059 [info ] [MainThread]:   location: US
[0m15:55:15.331760 [info ] [MainThread]:   priority: interactive
[0m15:55:15.331760 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:55:15.331760 [info ] [MainThread]:   impersonate_service_account: None
[0m15:55:15.345772 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:55:15.346932 [info ] [MainThread]:   job_retries: 1
[0m15:55:15.347812 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:55:15.350258 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:55:15.350258 [info ] [MainThread]:   timeout_seconds: 300
[0m15:55:15.350258 [info ] [MainThread]:   client_id: None
[0m15:55:15.350258 [info ] [MainThread]:   token_uri: None
[0m15:55:15.350258 [info ] [MainThread]:   dataproc_region: None
[0m15:55:15.350258 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:55:15.350258 [info ] [MainThread]:   gcs_bucket: None
[0m15:55:15.350258 [info ] [MainThread]:   dataproc_batch: None
[0m15:55:15.357024 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:55:15.357530 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:55:15.357530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:15.414508 [debug] [MainThread]: On debug: select 1 as id
[0m15:55:16.745500 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:289bd013-c8ad-49a2-ab59-30b918938913&page=queryresults
[0m15:55:17.701635 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:55:17.701635 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:55:17.701635 [debug] [MainThread]: Command `dbt debug` succeeded at 15:55:17.701635 after 3.97 seconds
[0m15:55:17.701635 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:55:17.701635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE6131FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE654AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AF8C4FF80>]}
[0m15:55:17.701635 [debug] [MainThread]: Flushing usage events
[0m15:55:32.629046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D8012570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D8012990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D80137D0>]}


============================== 15:55:32.637061 | c65cb7cd-db1b-4961-bc6e-664fe192439a ==============================
[0m15:55:32.637061 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:55:32.637061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m15:55:34.118396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EB4D3BC0>]}
[0m15:55:34.181687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EB47B590>]}
[0m15:55:34.181687 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:55:34.181687 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:55:34.290589 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:55:34.291155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EB7DDD30>]}
[0m15:55:35.589306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EBABB3E0>]}
[0m15:55:35.680775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EB8844D0>]}
[0m15:55:35.680775 [info ] [MainThread]: Found 16 models, 1 seed, 1 source, 478 macros
[0m15:55:35.680775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161ECC19C40>]}
[0m15:55:35.680775 [info ] [MainThread]: 
[0m15:55:35.696938 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:55:35.697460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:55:35.697460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:36.981265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:55:36.981265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:38.251404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161ECC115B0>]}
[0m15:55:38.251404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:38.251404 [info ] [MainThread]: 
[0m15:55:38.267059 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m15:55:38.267059 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m15:55:38.267059 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m15:55:38.270446 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m15:55:38.280604 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:55:38.283509 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m15:55:38.299893 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m15:55:38.299893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:38.347878 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
--     FROM 
--             `dbt-437212`.`buybox_dataset`.`merge_seed_final_table`

-- ),
-- flatten_payload AS (
--     SELECT 
--         JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
--         JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
--         JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
--         TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
--         JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
--         JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
--         JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

--         JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
--         JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
--         JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
--         JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
--         JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary") AS lp,
--         JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
--     FROM 
--         source_data
-- ),
-- flattened_payload_1 AS (
-- SELECT 
--     EventTime,
--     ApplicationId,
--     NotificationId,
--     PublishTime,
--     SubscriptionId,
--     NotificationType,
--     NotificationVersion,
--     ASIN,
--     ItemCondition,
--     MarketplaceId,
--     OfferChangeType,
--     TimeOfOfferChange,

--     CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
--     JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

--     JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
--     JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
--     JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
--     CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

--     JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
--     JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
    
--     JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

--     JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
--     JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS BuyBoxLandedPriceAmount,
--     JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

--     JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS BuyBoxListingPriceAmount,
--     JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

--     JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS BuyBoxShippingAmount,
--     JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

--     JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
--     JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

--     CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
--     JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

--     CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
--     JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

--     CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
--     JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

--     JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
--     JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
--     JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

--     JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
--     JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
--     JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

--     JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
--     CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

--     CAST(JSON_EXTRACT_SCALAR(lp, "$.lp.Amount") AS FLOAT64) AS ListPriceAmount,
--     JSON_EXTRACT_SCALAR(lp, "$.lp.CurrencyCode") AS ListPriceCurrencyCode

-- FROM 
--     flatten_payload
--     LEFT JOIN UNNEST(offers) AS offer
--     LEFT JOIN UNNEST(bbp) AS bbp
--     LEFT JOIN UNNEST(lop) AS lop
--     LEFT JOIN UNNEST(neo) AS neo
--     LEFT JOIN UNNEST(noo) AS noo
--     LEFT JOIN UNNEST(lp) AS lp
--     LEFT JOIN UNNEST(sr) AS sr
-- )
-- SELECT *
-- FROM flattened_payload_1

WITH source_data AS (
    SELECT 
        PARSE_JSON(MESSAGE_BODY) AS raw_data
    FROM 
        BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES
),
flatten_payload AS (
    SELECT 
        raw_data:"EventTime"::STRING AS EventTime,
        raw_data:"NotificationMetadata":"ApplicationId"::STRING AS ApplicationId,
        raw_data:"NotificationMetadata":"NotificationId"::STRING AS NotificationId,
        raw_data:"NotificationMetadata":"PublishTime"::TIMESTAMP AS PublishTime,
        raw_data:"NotificationMetadata":"SubscriptionId"::STRING AS SubscriptionId,
        raw_data:"NotificationType"::STRING AS NotificationType,
        raw_data:"NotificationVersion"::STRING AS NotificationVersion,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"ASIN"::STRING AS ASIN,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"ItemCondition"::STRING AS ItemCondition,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"MarketplaceId"::STRING AS MarketplaceId,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"OfferChangeType"::STRING AS OfferChangeType,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"TimeOfOfferChange"::STRING AS TimeOfOfferChange,
        raw_data:"Payload":"AnyOfferChangedNotification":"Offers"::ARRAY AS offers,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"BuyBoxPrices"::ARRAY AS bbp,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"LowestPrices"::ARRAY AS lop,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"NumberOfBuyBoxEligibleOffers"::ARRAY AS neo,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"NumberOfOffers"::ARRAY AS no,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"ListPrice"::ARRAY AS lp,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"SalesRankings"::ARRAY AS sr
    FROM 
        source_data
),
flatten__payload AS (
    SELECT 
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        f1.ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        offer.value:"IsBuyBoxWinner"::BOOLEAN AS IsBuyBoxWinner,
        offer.value:"IsFeaturedMerchant"::BOOLEAN AS IsFeaturedMerchant,
        offer.value:"IsFulfilledByAmazon"::BOOLEAN AS IsFulfilledByAmazon,
        offer.value:"ListingPrice":"Amount"::FLOAT AS ListingPriceAmount,
        offer.value:"ListingPrice":"CurrencyCode"::STRING AS ListingPriceCurrencyCode,
        offer.value:"PrimeInformation":"IsOfferNationalPrime"::BOOLEAN AS IsOfferNationalPrime,
        offer.value:"PrimeInformation":"IsOfferPrime"::BOOLEAN AS IsOfferPrime,
        offer.value:"SellerId"::STRING AS SellerId,
        offer.value:"SellerFeedbackRating":"FeedbackCount"::INTEGER AS SellerFeedbackCount,
        offer.value:"SellerFeedbackRating":"SellerPositiveFeedbackRating"::INTEGER AS SellerPositiveFeedbackRating,
        offer.value:"Shipping":"Amount"::FLOAT AS ShippingAmount,
        offer.value:"Shipping":"CurrencyCode"::STRING AS ShippingCurrencyCode,
        offer.value:"ShippingTime":"AvailabilityType"::STRING AS ShippingAvailabilityType,
        offer.value:"ShippingTime":"MaximumHours"::INTEGER AS ShippingMaxHours,
        offer.value:"ShippingTime":"MinimumHours"::INTEGER AS ShippingMinHours,
        offer.value:"ShipsDomestically"::BOOLEAN AS ShipsDomestically,
        offer.value:"ShipsFrom":"Country"::STRING AS ShipsFromCountry,
        offer.value:"ShipsFrom":"State"::STRING AS ShipsFromState,
        offer.value:"SubCondition"::STRING AS SubCondition,
        bbp.value:"Condition"::STRING AS BuyBoxPricesCondition,
        CAST(bbp.value:"LandedPrice":"Amount"::STRING AS FLOAT) AS BuyBoxLandedPriceAmount,
        bbp.value:"LandedPrice":"CurrencyCode"::STRING AS BuyBoxLandedPriceCurrencyCode,
        CAST(bbp.value:"ListingPrice":"Amount"::STRING AS FLOAT) AS BuyBoxListingPriceAmount,
        bbp.value:"ListingPrice":"CurrencyCode"::STRING AS BuyBoxListingPriceCurrencyCode,
        CAST(bbp.value:"Shipping":"Amount"::STRING AS FLOAT) AS BuyBoxShippingAmount,
        bbp.value:"Shipping":"CurrencyCode"::STRING AS BuyBoxShippingCurrencyCode,
        lop.value:"Condition"::STRING AS LowestPricesCondition,
        lop.value:"FulfillmentChannel"::STRING AS LowestPricesFulfillmentChannel,
        CAST(lop.value:"LandedPrice":"Amount"::STRING AS FLOAT) AS LandedPriceAmount,
        lop.value:"LandedPrice":"CurrencyCode"::STRING AS LandedPriceCurrencyCode,
        CAST(lop.value:"ListingPrice":"Amount"::STRING AS FLOAT) AS LowestPricesListingPriceAmount,
        lop.value:"ListingPrice":"CurrencyCode"::STRING AS LowestPricesListingCurrencyCode,
        CAST(lop.value:"Shipping":"Amount"::STRING AS FLOAT) AS LowestPricesShippingPriceAmount,
        lop.value:"Shipping":"CurrencyCode"::STRING AS LowestPricesShippingCurrencyCode,
        neo.value:"Condition"::STRING AS BuyBoxEligibleOffersCondition,
        neo.value:"FulfillmentChannel"::STRING AS BuyBoxEligibleOffersFulfillmentChannel,
        CAST(neo.value:"OfferCount"::STRING AS INTEGER) AS BuyBoxEligibleOffersCount,
        no.value:"Condition"::STRING AS NumberOfOffersCondition,
        no.value:"FulfillmentChannel"::STRING AS NumberOfOffersFulfillmentChannel,
        CAST(no.value:"OfferCount"::STRING AS INTEGER) AS NumberOfOffersCount,
        sr.value:"ProductCategoryId"::STRING AS SalesRankingsProductCategoryId,
        CAST(sr.value:"Rank"::STRING AS INTEGER) AS SalesRankingsRank,
        CAST(lp.value:"Amount"::STRING AS FLOAT) AS ListPriceAmount,
        lp.value:"CurrencyCode"::STRING AS ListPriceCurrencyCode
    FROM 
        flatten_payload AS f1,
        LATERAL FLATTEN(input => offers) AS offer,
        LATERAL FLATTEN(input => bbp) AS bbp,
        LATERAL FLATTEN(input => lop) AS lop,
        LATERAL FLATTEN(input => neo) AS neo,
        LATERAL FLATTEN(input => no) AS no,
        LATERAL FLATTEN(input => lp) AS lp,
        LATERAL FLATTEN(input => sr) AS sr
)
SELECT *
FROM flatten__payload
ORDER BY ASIN;


[0m15:55:39.994109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fc0f3cc3-651f-47e1-bf4c-5ae9c24b6723&page=queryresults
[0m15:55:39.994109 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ":" at [136:17]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ":" at [136:17]')
[0m15:55:41.114794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c84358d2-2eb6-4c7e-a7dd-3c398b5d943a&page=queryresults
[0m15:55:41.115385 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c84358d2-2eb6-4c7e-a7dd-3c398b5d943a&page=queryresults
[0m15:55:41.131495 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Expected ")" but got ":" at [136:17]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m15:55:41.132325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c65cb7cd-db1b-4961-bc6e-664fe192439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161EB997FE0>]}
[0m15:55:41.132325 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns ................ [[31mERROR[0m in 2.87s]
[0m15:55:41.132325 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m15:55:41.132325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:41.132325 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:55:41.132325 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:55:41.132325 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m15:55:41.132325 [info ] [MainThread]: 
[0m15:55:41.132325 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m15:55:41.132325 [debug] [MainThread]: Command end result
[0m15:55:41.254646 [info ] [MainThread]: 
[0m15:55:41.254646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:55:41.263734 [info ] [MainThread]: 
[0m15:55:41.264777 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Expected ")" but got ":" at [136:17]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m15:55:41.265751 [info ] [MainThread]: 
[0m15:55:41.266585 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:55:41.268284 [debug] [MainThread]: Command `dbt run` failed at 15:55:41.267189 after 8.77 seconds
[0m15:55:41.268284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D4F99130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D5BB96A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D7FED850>]}
[0m15:55:41.269305 [debug] [MainThread]: Flushing usage events
[0m16:02:44.743077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B6F42B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B6F433E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B6F43BF0>]}


============================== 16:02:44.744605 | 37bcbca7-c224-4c2e-9beb-3781692091d7 ==============================
[0m16:02:44.744605 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:02:44.744605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m16:02:46.142539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37bcbca7-c224-4c2e-9beb-3781692091d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CA4B5C10>]}
[0m16:02:46.199974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37bcbca7-c224-4c2e-9beb-3781692091d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CA3BE1E0>]}
[0m16:02:46.199974 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:02:46.206199 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:02:46.357708 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 7 files added, 5 files changed.
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sellers.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notifications.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\sources.yaml
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notificationSummary.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\merge_seed_final_table.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\base_seed_model.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\final_data_table.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification_lowestprices.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_offerchange.sql
[0m16:02:46.366831 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_salesranking.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_buyboxoffers.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_Ranking.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m16:02:46.371844 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:02:46.579741 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.dim_all_columns' (models\dim\dim_all_columns.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m16:02:46.584745 [debug] [MainThread]: Command `dbt run` failed at 16:02:46.584745 after 2.04 seconds
[0m16:02:46.586279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B5F75190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CA521F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CA896780>]}
[0m16:02:46.586279 [debug] [MainThread]: Flushing usage events
[0m16:03:35.624894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA6552DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA6551310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA6552000>]}


============================== 16:03:35.624894 | 7be516ee-cd75-438c-895f-43ab699c876e ==============================
[0m16:03:35.624894 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:03:35.624894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:35.644675 [info ] [MainThread]: dbt version: 1.8.6
[0m16:03:35.644675 [info ] [MainThread]: python version: 3.12.6
[0m16:03:35.644675 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m16:03:35.644675 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m16:03:36.789919 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m16:03:36.794998 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m16:03:36.794998 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
[0m16:03:36.794998 [info ] [MainThread]: adapter type: bigquery
[0m16:03:36.794998 [info ] [MainThread]: adapter version: 1.8.2
[0m16:03:36.887502 [info ] [MainThread]: Configuration:
[0m16:03:36.888418 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:03:36.888418 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:03:36.889998 [info ] [MainThread]: Required dependencies:
[0m16:03:36.890934 [debug] [MainThread]: Executing "git --help"
[0m16:03:36.935037 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:03:36.935037 [debug] [MainThread]: STDERR: "b''"
[0m16:03:36.935037 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:03:36.935037 [info ] [MainThread]: Connection:
[0m16:03:36.935037 [info ] [MainThread]:   method: service-account
[0m16:03:36.935037 [info ] [MainThread]:   database: dbt-437212
[0m16:03:36.935037 [info ] [MainThread]:   execution_project: dbt-437212
[0m16:03:36.935037 [info ] [MainThread]:   schema: wellbefore
[0m16:03:36.941045 [info ] [MainThread]:   location: US
[0m16:03:36.941045 [info ] [MainThread]:   priority: interactive
[0m16:03:36.942307 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:03:36.942307 [info ] [MainThread]:   impersonate_service_account: None
[0m16:03:36.942307 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:03:36.944822 [info ] [MainThread]:   job_retries: 1
[0m16:03:36.944822 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:03:36.944822 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:03:36.944822 [info ] [MainThread]:   timeout_seconds: 300
[0m16:03:36.944822 [info ] [MainThread]:   client_id: None
[0m16:03:36.944822 [info ] [MainThread]:   token_uri: None
[0m16:03:36.944822 [info ] [MainThread]:   dataproc_region: None
[0m16:03:36.944822 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:03:36.944822 [info ] [MainThread]:   gcs_bucket: None
[0m16:03:36.944822 [info ] [MainThread]:   dataproc_batch: None
[0m16:03:36.944822 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:03:36.944822 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:03:36.944822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:36.984844 [debug] [MainThread]: On debug: select 1 as id
[0m16:03:38.585092 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:1dbff980-8af1-4c95-bbfa-28d05e659711&page=queryresults
[0m16:03:39.501279 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:03:39.501279 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:03:39.501279 [debug] [MainThread]: Command `dbt debug` succeeded at 16:03:39.501279 after 3.99 seconds
[0m16:03:39.501279 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:03:39.504872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB9B2C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB91FBCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA5D07620>]}
[0m16:03:39.504872 [debug] [MainThread]: Flushing usage events
[0m16:03:45.731846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054376F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054376DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542CD9100>]}


============================== 16:03:45.734935 | e9f7b51c-3205-41d4-a951-86ddc4b853af ==============================
[0m16:03:45.734935 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:03:45.734935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:03:47.075060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9f7b51c-3205-41d4-a951-86ddc4b853af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020556BA8740>]}
[0m16:03:47.146086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9f7b51c-3205-41d4-a951-86ddc4b853af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205437B94C0>]}
[0m16:03:47.146086 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:03:47.154907 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:03:47.295049 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 7 files added, 5 files changed.
[0m16:03:47.295049 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sellers.sql
[0m16:03:47.305230 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m16:03:47.305230 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m16:03:47.305230 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notifications.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\sources.yaml
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\base_seed_model.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notificationSummary.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification_lowestprices.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_salesranking.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\merge_seed_final_table.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\final_data_table.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_offerchange.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_Ranking.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_buyboxoffers.sql
[0m16:03:47.305834 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:03:47.309968 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m16:03:47.309968 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m16:03:47.309968 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m16:03:47.514916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.dim_all_columns' (models\dim\dim_all_columns.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m16:03:47.524996 [debug] [MainThread]: Command `dbt run` failed at 16:03:47.524673 after 1.90 seconds
[0m16:03:47.526091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205435BD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020556FAD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020556D1EB40>]}
[0m16:03:47.527023 [debug] [MainThread]: Flushing usage events
[0m16:04:36.644868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020226BB45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202276926F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020223FC4800>]}


============================== 16:04:36.644868 | 802301d8-039d-443e-aef8-6649b8171c9f ==============================
[0m16:04:36.644868 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:04:36.644868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m16:04:37.955099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '802301d8-039d-443e-aef8-6649b8171c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023AEE1F10>]}
[0m16:04:38.015009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '802301d8-039d-443e-aef8-6649b8171c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023A4954C0>]}
[0m16:04:38.015009 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:04:38.026472 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:04:38.162488 [debug] [MainThread]: Partial parsing enabled: 11 files deleted, 7 files added, 4 files changed.
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m16:04:38.163489 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sellers.sql
[0m16:04:38.165097 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notifications.sql
[0m16:04:38.165152 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification_lowestprices.sql
[0m16:04:38.165152 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notificationSummary.sql
[0m16:04:38.166147 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\base_seed_model.sql
[0m16:04:38.166147 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_Ranking.sql
[0m16:04:38.166147 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_offerchange.sql
[0m16:04:38.166147 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\merge_seed_final_table.sql
[0m16:04:38.166147 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_buyboxoffers.sql
[0m16:04:38.167192 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification.sql
[0m16:04:38.167192 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_salesranking.sql
[0m16:04:38.167192 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\final_data_table.sql
[0m16:04:38.167192 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m16:04:38.167192 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m16:04:38.168191 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m16:04:38.168191 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:04:38.364712 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.dim_all_columns' (models\dim\dim_all_columns.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m16:04:38.365719 [debug] [MainThread]: Command `dbt run` failed at 16:04:38.365719 after 1.83 seconds
[0m16:04:38.365719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020227A3B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023B307890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202275EABA0>]}
[0m16:04:38.365719 [debug] [MainThread]: Flushing usage events
[0m16:04:59.804690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C1BD03B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C459DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C459CCB0>]}


============================== 16:04:59.812184 | 8211f90d-28dd-4cd1-a61e-226bc934586d ==============================
[0m16:04:59.812184 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:04:59.812184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:01.225233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8211f90d-28dd-4cd1-a61e-226bc934586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C4709190>]}
[0m16:05:01.327032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8211f90d-28dd-4cd1-a61e-226bc934586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C36C05F0>]}
[0m16:05:01.327032 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:05:01.345946 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:05:01.557833 [debug] [MainThread]: Partial parsing enabled: 11 files deleted, 7 files added, 4 files changed.
[0m16:05:01.558874 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notifications.sql
[0m16:05:01.559396 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m16:05:01.559923 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m16:05:01.559923 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m16:05:01.560443 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m16:05:01.560965 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sellers.sql
[0m16:05:01.561490 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m16:05:01.562016 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_offerchange.sql
[0m16:05:01.562542 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notificationSummary.sql
[0m16:05:01.563068 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\base_seed_model.sql
[0m16:05:01.563068 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\final_data_table.sql
[0m16:05:01.563595 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_buyboxoffers.sql
[0m16:05:01.564121 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\merge_seed_final_table.sql
[0m16:05:01.564121 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification_lowestprices.sql
[0m16:05:01.564632 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification.sql
[0m16:05:01.564632 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_salesranking.sql
[0m16:05:01.565155 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_Ranking.sql
[0m16:05:01.565678 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:05:01.566200 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m16:05:01.566200 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m16:05:01.566724 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m16:05:01.859421 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp_1.fct_sellers' (models\fact\fct_sellers.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m16:05:01.862063 [debug] [MainThread]: Command `dbt run` failed at 16:05:01.861539 after 2.17 seconds
[0m16:05:01.862586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C46D7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D7C6E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C3678860>]}
[0m16:05:01.862586 [debug] [MainThread]: Flushing usage events
[0m16:05:41.244900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EAD67CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EAD4B9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EAD67E180>]}


============================== 16:05:41.244900 | 4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43 ==============================
[0m16:05:41.244900 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:05:41.244900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:42.615515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EAD7D3A10>]}
[0m16:05:42.674899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0D942C0>]}
[0m16:05:42.675097 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:05:42.681384 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing enabled: 11 files deleted, 7 files added, 5 files changed.
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sellers.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_notifications.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notificationSummary.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\final_data_table.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification_lowestprices.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_Ranking.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_notification.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_offerchange.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_buyboxoffers.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\merge_seed_final_table.sql
[0m16:05:42.826546 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_salesranking.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\cdc\base_seed_model.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m16:05:42.834677 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m16:05:43.075033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC10ECFE0>]}
[0m16:05:43.144824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0EB9E80>]}
[0m16:05:43.144824 [info ] [MainThread]: Found 1 seed, 13 models, 478 macros
[0m16:05:43.144824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0F4CB60>]}
[0m16:05:43.144824 [info ] [MainThread]: 
[0m16:05:43.144824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:43.144824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:05:43.144824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:44.365145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:05:44.365145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:45.614930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0E22090>]}
[0m16:05:45.614930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:45.614930 [info ] [MainThread]: 
[0m16:05:45.614930 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m16:05:45.614930 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m16:05:45.614930 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m16:05:45.614930 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m16:05:45.628796 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:05:45.628796 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m16:05:45.681205 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:05:45.682221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:45.715123 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(MESSAGE_BODY) AS raw_data
    FROM 
        dbt-437212.wellbefore.dim_all_columns
),
flatten_payload AS (
    SELECT 
        raw_data:"EventTime"::STRING AS EventTime,
        raw_data:"NotificationMetadata":"ApplicationId"::STRING AS ApplicationId,
        raw_data:"NotificationMetadata":"NotificationId"::STRING AS NotificationId,
        raw_data:"NotificationMetadata":"PublishTime"::TIMESTAMP AS PublishTime,
        raw_data:"NotificationMetadata":"SubscriptionId"::STRING AS SubscriptionId,
        raw_data:"NotificationType"::STRING AS NotificationType,
        raw_data:"NotificationVersion"::STRING AS NotificationVersion,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"ASIN"::STRING AS ASIN,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"ItemCondition"::STRING AS ItemCondition,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"MarketplaceId"::STRING AS MarketplaceId,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"OfferChangeType"::STRING AS OfferChangeType,
        raw_data:"Payload":"AnyOfferChangedNotification":"OfferChangeTrigger":"TimeOfOfferChange"::STRING AS TimeOfOfferChange,
        raw_data:"Payload":"AnyOfferChangedNotification":"Offers"::ARRAY AS offers,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"BuyBoxPrices"::ARRAY AS bbp,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"LowestPrices"::ARRAY AS lop,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"NumberOfBuyBoxEligibleOffers"::ARRAY AS neo,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"NumberOfOffers"::ARRAY AS no,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"ListPrice"::ARRAY AS lp,
        raw_data:"Payload":"AnyOfferChangedNotification":"Summary":"SalesRankings"::ARRAY AS sr
    FROM 
        source_data
),
flatten__payload AS (
    SELECT 
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        f1.ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        offer.value:"IsBuyBoxWinner"::BOOLEAN AS IsBuyBoxWinner,
        offer.value:"IsFeaturedMerchant"::BOOLEAN AS IsFeaturedMerchant,
        offer.value:"IsFulfilledByAmazon"::BOOLEAN AS IsFulfilledByAmazon,
        offer.value:"ListingPrice":"Amount"::FLOAT AS ListingPriceAmount,
        offer.value:"ListingPrice":"CurrencyCode"::STRING AS ListingPriceCurrencyCode,
        offer.value:"PrimeInformation":"IsOfferNationalPrime"::BOOLEAN AS IsOfferNationalPrime,
        offer.value:"PrimeInformation":"IsOfferPrime"::BOOLEAN AS IsOfferPrime,
        offer.value:"SellerId"::STRING AS SellerId,
        offer.value:"SellerFeedbackRating":"FeedbackCount"::INTEGER AS SellerFeedbackCount,
        offer.value:"SellerFeedbackRating":"SellerPositiveFeedbackRating"::INTEGER AS SellerPositiveFeedbackRating,
        offer.value:"Shipping":"Amount"::FLOAT AS ShippingAmount,
        offer.value:"Shipping":"CurrencyCode"::STRING AS ShippingCurrencyCode,
        offer.value:"ShippingTime":"AvailabilityType"::STRING AS ShippingAvailabilityType,
        offer.value:"ShippingTime":"MaximumHours"::INTEGER AS ShippingMaxHours,
        offer.value:"ShippingTime":"MinimumHours"::INTEGER AS ShippingMinHours,
        offer.value:"ShipsDomestically"::BOOLEAN AS ShipsDomestically,
        offer.value:"ShipsFrom":"Country"::STRING AS ShipsFromCountry,
        offer.value:"ShipsFrom":"State"::STRING AS ShipsFromState,
        offer.value:"SubCondition"::STRING AS SubCondition,
        bbp.value:"Condition"::STRING AS BuyBoxPricesCondition,
        CAST(bbp.value:"LandedPrice":"Amount"::STRING AS FLOAT) AS BuyBoxLandedPriceAmount,
        bbp.value:"LandedPrice":"CurrencyCode"::STRING AS BuyBoxLandedPriceCurrencyCode,
        CAST(bbp.value:"ListingPrice":"Amount"::STRING AS FLOAT) AS BuyBoxListingPriceAmount,
        bbp.value:"ListingPrice":"CurrencyCode"::STRING AS BuyBoxListingPriceCurrencyCode,
        CAST(bbp.value:"Shipping":"Amount"::STRING AS FLOAT) AS BuyBoxShippingAmount,
        bbp.value:"Shipping":"CurrencyCode"::STRING AS BuyBoxShippingCurrencyCode,
        lop.value:"Condition"::STRING AS LowestPricesCondition,
        lop.value:"FulfillmentChannel"::STRING AS LowestPricesFulfillmentChannel,
        CAST(lop.value:"LandedPrice":"Amount"::STRING AS FLOAT) AS LandedPriceAmount,
        lop.value:"LandedPrice":"CurrencyCode"::STRING AS LandedPriceCurrencyCode,
        CAST(lop.value:"ListingPrice":"Amount"::STRING AS FLOAT) AS LowestPricesListingPriceAmount,
        lop.value:"ListingPrice":"CurrencyCode"::STRING AS LowestPricesListingCurrencyCode,
        CAST(lop.value:"Shipping":"Amount"::STRING AS FLOAT) AS LowestPricesShippingPriceAmount,
        lop.value:"Shipping":"CurrencyCode"::STRING AS LowestPricesShippingCurrencyCode,
        neo.value:"Condition"::STRING AS BuyBoxEligibleOffersCondition,
        neo.value:"FulfillmentChannel"::STRING AS BuyBoxEligibleOffersFulfillmentChannel,
        CAST(neo.value:"OfferCount"::STRING AS INTEGER) AS BuyBoxEligibleOffersCount,
        no.value:"Condition"::STRING AS NumberOfOffersCondition,
        no.value:"FulfillmentChannel"::STRING AS NumberOfOffersFulfillmentChannel,
        CAST(no.value:"OfferCount"::STRING AS INTEGER) AS NumberOfOffersCount,
        sr.value:"ProductCategoryId"::STRING AS SalesRankingsProductCategoryId,
        CAST(sr.value:"Rank"::STRING AS INTEGER) AS SalesRankingsRank,
        CAST(lp.value:"Amount"::STRING AS FLOAT) AS ListPriceAmount,
        lp.value:"CurrencyCode"::STRING AS ListPriceCurrencyCode
    FROM 
        flatten_payload AS f1,
        LATERAL FLATTEN(input => offers) AS offer,
        LATERAL FLATTEN(input => bbp) AS bbp,
        LATERAL FLATTEN(input => lop) AS lop,
        LATERAL FLATTEN(input => neo) AS neo,
        LATERAL FLATTEN(input => no) AS no,
        LATERAL FLATTEN(input => lp) AS lp,
        LATERAL FLATTEN(input => sr) AS sr
)
SELECT *
FROM flatten__payload
ORDER BY ASIN;


[0m16:05:46.914824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:57c34075-52c0-43f9-95ba-5bdd2742db80&page=queryresults
[0m16:05:46.914824 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ":" at [14:17]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ":" at [14:17]')
[0m16:05:47.525021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d9990a65-de18-48ed-b143-5cb0508b03fc&page=queryresults
[0m16:05:47.525021 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d9990a65-de18-48ed-b143-5cb0508b03fc&page=queryresults
[0m16:05:47.545322 [debug] [Thread-1 (]: Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Expected ")" but got ":" at [14:17]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m16:05:47.545322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa7f0d8-bf2d-41ff-8bf0-6a8442111e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC121F9B0>]}
[0m16:05:47.545322 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns ................ [[31mERROR[0m in 1.93s]
[0m16:05:47.545322 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m16:05:47.551415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:47.551415 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:05:47.551415 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:05:47.551415 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m16:05:47.551415 [info ] [MainThread]: 
[0m16:05:47.551415 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m16:05:47.554970 [debug] [MainThread]: Command end result
[0m16:05:47.579486 [info ] [MainThread]: 
[0m16:05:47.579486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:47.579486 [info ] [MainThread]: 
[0m16:05:47.579486 [error] [MainThread]:   Database Error in model dim_all_columns (models\dim\dim_all_columns.sql)
  Syntax error: Expected ")" but got ":" at [14:17]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns.sql
[0m16:05:47.585005 [info ] [MainThread]: 
[0m16:05:47.585005 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:05:47.585005 [debug] [MainThread]: Command `dbt run` failed at 16:05:47.585005 after 6.47 seconds
[0m16:05:47.585005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EAD702300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EACEE3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0E624E0>]}
[0m16:05:47.585005 [debug] [MainThread]: Flushing usage events
[0m16:07:35.657273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA4EC20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA4EC2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA4EC2870>]}


============================== 16:07:35.657273 | bab36b3c-58c3-4f42-951a-7b8d3c4869ba ==============================
[0m16:07:35.657273 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:07:35.660813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:37.004740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB7BA4B60>]}
[0m16:07:37.065104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB83712E0>]}
[0m16:07:37.065104 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:07:37.065104 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:07:37.194943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:37.194943 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m16:07:37.424856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB88E6C60>]}
[0m16:07:37.499672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB8898BF0>]}
[0m16:07:37.499672 [info ] [MainThread]: Found 1 seed, 13 models, 478 macros
[0m16:07:37.499672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB833F440>]}
[0m16:07:37.499672 [info ] [MainThread]: 
[0m16:07:37.499672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:37.499672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:07:37.504902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:38.705159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:07:38.705159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:39.975251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB87B0140>]}
[0m16:07:39.976772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:39.976772 [info ] [MainThread]: 
[0m16:07:39.976772 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m16:07:39.976772 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m16:07:39.984874 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m16:07:39.987095 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m16:07:39.988342 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:07:39.994849 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m16:07:40.025064 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:07:40.025064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:40.061501 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),
flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,
        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode
    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(lp) AS lp,
        UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload;


[0m16:07:41.505046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c943a968-f9e2-43f9-8548-98b7ab5a5d42&page=queryresults
[0m16:07:42.359932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab36b3c-58c3-4f42-951a-7b8d3c4869ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB79EBEC0>]}
[0m16:07:42.359932 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m16:07:42.365079 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m16:07:42.366632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:42.366749 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:07:42.366749 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:07:42.366749 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m16:07:42.366749 [info ] [MainThread]: 
[0m16:07:42.366749 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m16:07:42.366749 [debug] [MainThread]: Command end result
[0m16:07:42.398609 [info ] [MainThread]: 
[0m16:07:42.398609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:42.398609 [info ] [MainThread]: 
[0m16:07:42.404733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:42.404733 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:42.404733 after 6.93 seconds
[0m16:07:42.404733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB76B77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB8748500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB88E69C0>]}
[0m16:07:42.404733 [debug] [MainThread]: Flushing usage events
[0m16:09:02.575053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AF92D23C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AF92D2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AF92D3320>]}


============================== 16:09:02.575053 | cf6dce8f-cf96-40c5-80f2-d5dc9daad35c ==============================
[0m16:09:02.575053 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:09:02.575053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:09:03.875117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C8A7830>]}
[0m16:09:03.927958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C1675C0>]}
[0m16:09:03.927958 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:09:03.939617 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:09:04.065102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:04.065102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:04.094944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C90A630>]}
[0m16:09:04.165085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C9B0140>]}
[0m16:09:04.165085 [info ] [MainThread]: Found 1 seed, 13 models, 478 macros
[0m16:09:04.170096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8CBA01A0>]}
[0m16:09:04.170096 [info ] [MainThread]: 
[0m16:09:04.170096 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:09:04.170096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:09:04.170096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:05.680280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:09:05.680280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:06.925085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C9B1610>]}
[0m16:09:06.925085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:06.928616 [info ] [MainThread]: 
[0m16:09:06.928616 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m16:09:06.934715 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m16:09:06.934715 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m16:09:06.934715 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m16:09:06.945011 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:09:06.945011 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m16:09:06.967168 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:09:06.967168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:07.008039 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),
flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,
        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode
    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(lp) AS lp,
        UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload;


[0m16:09:08.395140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:edb4b32c-3bb6-4b47-b3a9-126cef801c84&page=queryresults
[0m16:09:09.297669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6dce8f-cf96-40c5-80f2-d5dc9daad35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8BE5BBC0>]}
[0m16:09:09.297669 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m16:09:09.297669 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m16:09:09.297669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:09.297669 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:09:09.304683 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:09:09.304805 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m16:09:09.304805 [info ] [MainThread]: 
[0m16:09:09.304805 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m16:09:09.304805 [debug] [MainThread]: Command end result
[0m16:09:09.333002 [info ] [MainThread]: 
[0m16:09:09.333983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:09.334981 [info ] [MainThread]: 
[0m16:09:09.335395 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:09.335395 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:09.335395 after 6.89 seconds
[0m16:09:09.335395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8CBA27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AF8EC8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AF8EC9220>]}
[0m16:09:09.335395 [debug] [MainThread]: Flushing usage events
[0m16:10:25.375015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE00824E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE0082600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE00829C0>]}


============================== 16:10:25.381216 | 20017ee7-ea25-452a-a95a-62d751fa9110 ==============================
[0m16:10:25.381216 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:10:25.383731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:26.989692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3580F80>]}
[0m16:10:27.055136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3486420>]}
[0m16:10:27.055136 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:10:27.066955 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:10:27.125130 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:10:27.129740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ADF7926F0>]}
[0m16:10:28.180205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3912930>]}
[0m16:10:28.250718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3AE8AD0>]}
[0m16:10:28.254944 [info ] [MainThread]: Found 13 models, 1 seed, 478 macros
[0m16:10:28.254944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3B1D460>]}
[0m16:10:28.254944 [info ] [MainThread]: 
[0m16:10:28.254944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:10:28.254944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:10:28.254944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:29.504947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:10:29.504947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:30.774995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3973EC0>]}
[0m16:10:30.774995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:30.774995 [info ] [MainThread]: 
[0m16:10:30.784672 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m16:10:30.784672 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.dim_all_columns ........................ [RUN]
[0m16:10:30.787201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m16:10:30.788134 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m16:10:30.794637 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:10:30.794637 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m16:10:30.835621 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:10:30.835621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:30.874953 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`dim_all_columns`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),
flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,
        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode
    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(lp) AS lp,
        UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload
    );
  
[0m16:10:32.425148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0329fdf4-ca68-469f-baa4-2797131cc7f2&page=queryresults
[0m16:10:35.385140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20017ee7-ea25-452a-a95a-62d751fa9110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF2BA8E00>]}
[0m16:10:35.385140 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wellbefore.dim_all_columns ................... [[32mCREATE TABLE (0.0 rows, 120.8 KiB processed)[0m in 4.60s]
[0m16:10:35.391813 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m16:10:35.391813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:35.391813 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:10:35.391813 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:10:35.391813 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m16:10:35.391813 [info ] [MainThread]: 
[0m16:10:35.394930 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m16:10:35.394930 [debug] [MainThread]: Command end result
[0m16:10:35.421325 [info ] [MainThread]: 
[0m16:10:35.422187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:35.422187 [info ] [MainThread]: 
[0m16:10:35.422187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:10:35.424770 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:35.424770 after 10.18 seconds
[0m16:10:35.424770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AF3850560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ADFC79220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ADFC78FE0>]}
[0m16:10:35.424770 [debug] [MainThread]: Flushing usage events
[0m16:11:37.762506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B5C11F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B5C122D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B5C12480>]}


============================== 16:11:37.765088 | f210efdc-ae2d-4e85-b9f5-6e3b884576c1 ==============================
[0m16:11:37.765088 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:11:37.765088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:39.064890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C9102270>]}
[0m16:11:39.120149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B592F3B0>]}
[0m16:11:39.120149 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:11:39.124835 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:11:39.187105 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:11:39.187105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C93D0DD0>]}
[0m16:11:40.266312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C96C97F0>]}
[0m16:11:40.349363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C9668C50>]}
[0m16:11:40.350449 [info ] [MainThread]: Found 13 models, 1 seed, 478 macros
[0m16:11:40.351531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B51097F0>]}
[0m16:11:40.353608 [info ] [MainThread]: 
[0m16:11:40.354607 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:40.355801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:11:40.355801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:41.572962 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:11:41.573974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:42.805215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C967DDC0>]}
[0m16:11:42.805215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:42.805215 [info ] [MainThread]: 
[0m16:11:42.814737 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m16:11:42.814737 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m16:11:42.814737 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m16:11:42.814737 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m16:11:42.824870 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:11:42.824870 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m16:11:42.845084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:44.126506 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m16:11:44.126506 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),
flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),
flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,
        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,
        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,
        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,
        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode
    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(lp) AS lp,
        UNNEST(sr) AS sr
)
SELECT *
FROM flattened_payload;


[0m16:11:45.044903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:be1f0e94-9d1f-4229-9a8c-97b9930165e4&page=queryresults
[0m16:11:45.905013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f210efdc-ae2d-4e85-b9f5-6e3b884576c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C873B560>]}
[0m16:11:45.905013 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 3.09s]
[0m16:11:45.905013 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m16:11:45.905013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:45.905013 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:11:45.905013 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:11:45.905013 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m16:11:45.905013 [info ] [MainThread]: 
[0m16:11:45.905013 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m16:11:45.905013 [debug] [MainThread]: Command end result
[0m16:11:45.937978 [info ] [MainThread]: 
[0m16:11:45.937978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:45.937978 [info ] [MainThread]: 
[0m16:11:45.937978 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:45.937978 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:45.937978 after 8.32 seconds
[0m16:11:45.937978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B5980500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C969C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C94623F0>]}
[0m16:11:45.937978 [debug] [MainThread]: Flushing usage events
[0m16:12:07.294556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240496146B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240494A2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240494A2F90>]}


============================== 16:12:07.294556 | 9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54 ==============================
[0m16:12:07.294556 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:12:07.304578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'send_anonymous_usage_stats': 'True'}
[0m16:12:08.617199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405C751430>]}
[0m16:12:08.666630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405C6EAF90>]}
[0m16:12:08.674787 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:12:08.679896 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:12:08.804959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:08.804959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:08.834929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405CD76CF0>]}
[0m16:12:08.904888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405D099280>]}
[0m16:12:08.904888 [info ] [MainThread]: Found 13 models, 1 seed, 478 macros
[0m16:12:08.904888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6d58fa-9fe1-4b8d-9ceb-b657dab98c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405CED8D40>]}
[0m16:12:08.904888 [info ] [MainThread]: 
[0m16:12:08.904888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:12:08.913353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:12:08.913353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:10.135089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:10.135089 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:12:10.135089 [info ] [MainThread]: 
[0m16:12:10.135089 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m16:12:10.135089 [error] [MainThread]: Encountered an error:

[0m16:12:10.154874 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 626, in create_schemas
    for ls_future in as_completed(list_futures):
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m16:12:10.154874 [debug] [MainThread]: Command `dbt run` failed at 16:12:10.154874 after 2.98 seconds
[0m16:12:10.154874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049847B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405D096B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049732360>]}
[0m16:12:10.154874 [debug] [MainThread]: Flushing usage events
[0m17:02:47.391184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B73248C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B71C1DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B626DD00>]}


============================== 17:02:47.391184 | c1ef0159-8379-46f8-91ed-911ef5fb0b99 ==============================
[0m17:02:47.391184 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:02:47.391184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:48.876475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B64DDA00>]}
[0m17:02:48.924637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B4F19F40>]}
[0m17:02:48.924637 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:02:48.941397 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:02:49.076979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:02:49.076979 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m17:02:49.344038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CAE82FF0>]}
[0m17:02:49.414415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CAE34080>]}
[0m17:02:49.414415 [info ] [MainThread]: Found 13 models, 1 seed, 478 macros
[0m17:02:49.414415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CAAA0440>]}
[0m17:02:49.423435 [info ] [MainThread]: 
[0m17:02:49.424508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:02:49.425018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m17:02:49.425018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:52.020262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m17:02:52.020262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:53.441720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7470140>]}
[0m17:02:53.458140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:53.458140 [info ] [MainThread]: 
[0m17:02:53.458140 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m17:02:53.458140 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns ......................... [RUN]
[0m17:02:53.458140 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m17:02:53.466370 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m17:02:53.474218 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m17:02:53.475734 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m17:02:53.511140 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m17:02:53.512149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:53.542238 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),

flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),

flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(sr) AS sr
)

SELECT *
FROM flattened_payload;


[0m17:02:55.323647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:aad565fb-8fe7-488d-bd7e-c0c0de52d758&page=queryresults
[0m17:02:56.226647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1ef0159-8379-46f8-91ed-911ef5fb0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C9F787A0>]}
[0m17:02:56.226647 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns .................... [[32mCREATE VIEW (0 processed)[0m in 2.77s]
[0m17:02:56.226647 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m17:02:56.226647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:56.226647 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m17:02:56.226647 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m17:02:56.226647 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns' was properly closed.
[0m17:02:56.226647 [info ] [MainThread]: 
[0m17:02:56.240161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m17:02:56.241006 [debug] [MainThread]: Command end result
[0m17:02:56.259403 [info ] [MainThread]: 
[0m17:02:56.259403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:56.259403 [info ] [MainThread]: 
[0m17:02:56.259403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:56.276224 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:56.276224 after 9.10 seconds
[0m17:02:56.276224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B678A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CAA3FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B6F31160>]}
[0m17:02:56.276224 [debug] [MainThread]: Flushing usage events
[0m17:49:15.138077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5113F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5113F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5113EC90>]}


============================== 17:49:15.155647 | c89cf8b5-cb97-4295-a3ba-03932ebce738 ==============================
[0m17:49:15.155647 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:49:15.156489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:15.156489 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:49:15.156489 [debug] [MainThread]: Command `dbt run` failed at 17:49:15.156489 after 0.19 seconds
[0m17:49:15.156489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E518A85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E517AF4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5113F830>]}
[0m17:49:15.156489 [debug] [MainThread]: Flushing usage events
[0m17:51:18.087117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E67C37D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6A2769C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6A86DAC0>]}


============================== 17:51:18.087117 | bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818 ==============================
[0m17:51:18.087117 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:51:18.087117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:19.577139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7DEF6E40>]}
[0m17:51:19.651603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7D7F7530>]}
[0m17:51:19.651603 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:51:19.656261 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:51:19.724321 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:51:19.727828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E2FD670>]}
[0m17:51:20.632536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E4B5430>]}
[0m17:51:20.695730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E4A9DF0>]}
[0m17:51:20.695730 [info ] [MainThread]: Found 11 models, 478 macros
[0m17:51:20.697268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E4AF170>]}
[0m17:51:20.699377 [info ] [MainThread]: 
[0m17:51:20.700163 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:20.703707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m17:51:20.703707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:21.967867 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m17:51:21.968921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:23.389878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E0B4710>]}
[0m17:51:23.389878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:23.389878 [info ] [MainThread]: 
[0m17:51:23.389878 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m17:51:23.389878 [info ] [Thread-1 (]: 1 of 11 START sql view model wellbefore.dim_all_columns ........................ [RUN]
[0m17:51:23.404884 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m17:51:23.406018 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m17:51:23.409845 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m17:51:23.409845 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m17:51:23.445516 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m17:51:23.445516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:23.478120 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),

flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),

flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(sr) AS sr
)

SELECT *
FROM flattened_payload;


[0m17:51:25.090167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2abe0fd6-384e-4ae7-81f6-a1a1699d7743&page=queryresults
[0m17:51:25.942604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7D64FC20>]}
[0m17:51:25.944036 [info ] [Thread-1 (]: 1 of 11 OK created sql view model wellbefore.dim_all_columns ................... [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m17:51:25.944600 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m17:51:25.945636 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m17:51:25.945636 [info ] [Thread-1 (]: 2 of 11 START sql table model wellbefore.src_buybox_offers ..................... [RUN]
[0m17:51:25.946735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.src_buybox_offers)
[0m17:51:25.946735 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m17:51:25.948744 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m17:51:25.949754 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m17:51:25.957973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:27.292814 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m17:51:27.292814 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1
    );
  
[0m17:51:28.106135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:ee81082f-d211-46c7-a98e-24a704e16049&page=queryresults
[0m17:51:30.915407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E472C90>]}
[0m17:51:30.915407 [info ] [Thread-1 (]: 2 of 11 OK created sql table model wellbefore.src_buybox_offers ................ [[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)[0m in 4.97s]
[0m17:51:30.915407 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m17:51:30.915407 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:51:30.915407 [info ] [Thread-1 (]: 3 of 11 START sql table model wellbefore.src_notification_lowest_prices ........ [RUN]
[0m17:51:30.915407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m17:51:30.915407 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:51:30.915407 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m17:51:30.915407 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:51:30.915407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:32.209686 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m17:51:32.209686 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_lowest_prices"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1
    );
  
[0m17:51:32.939526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a2ad79fb-0b82-475c-8ece-87712d3e9f6f&page=queryresults
[0m17:51:35.824485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F639D60>]}
[0m17:51:35.824485 [info ] [Thread-1 (]: 3 of 11 OK created sql table model wellbefore.src_notification_lowest_prices ... [[32mCREATE TABLE (28.0 rows, 120.8 KiB processed)[0m in 4.91s]
[0m17:51:35.824485 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:51:35.824485 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m17:51:35.824485 [info ] [Thread-1 (]: 4 of 11 START sql table model wellbefore.src_notification_summary .............. [RUN]
[0m17:51:35.824485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m17:51:35.824485 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m17:51:35.824485 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m17:51:35.824485 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m17:51:35.824485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:37.175100 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_summary"
[0m17:51:37.178115 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_summary"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1
    );
  
[0m17:51:37.940384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fc30b6d2-f2f6-4824-a40c-5386fa4ed7db&page=queryresults
[0m17:51:40.948246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F6521E0>]}
[0m17:51:40.948246 [info ] [Thread-1 (]: 4 of 11 OK created sql table model wellbefore.src_notification_summary ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 5.12s]
[0m17:51:40.948246 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m17:51:40.948246 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m17:51:40.948246 [info ] [Thread-1 (]: 5 of 11 START sql table model wellbefore.src_notifications ..................... [RUN]
[0m17:51:40.948246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m17:51:40.948246 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m17:51:40.948246 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m17:51:40.963885 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m17:51:40.966502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:42.242430 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notifications"
[0m17:51:42.259390 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notifications"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data
    );
  
[0m17:51:42.956420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:5aed77d2-944e-4741-a1c8-ab74673b384d&page=queryresults
[0m17:51:45.717745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F673A70>]}
[0m17:51:45.717745 [info ] [Thread-1 (]: 5 of 11 OK created sql table model wellbefore.src_notifications ................ [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.77s]
[0m17:51:45.717745 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m17:51:45.717745 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:51:45.717745 [info ] [Thread-1 (]: 6 of 11 START sql table model wellbefore.src_offer_change_trigger .............. [RUN]
[0m17:51:45.717745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m17:51:45.717745 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:51:45.737464 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m17:51:45.741035 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:51:45.742005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:47.043269 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m17:51:47.056560 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offer_change_trigger"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data
    );
  
[0m17:51:47.756323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:757a3b5e-e16e-4868-b7bd-8bba0beb2a91&page=queryresults
[0m17:51:50.269866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F6710D0>]}
[0m17:51:50.270984 [info ] [Thread-1 (]: 6 of 11 OK created sql table model wellbefore.src_offer_change_trigger ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.55s]
[0m17:51:50.272031 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:51:50.272031 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m17:51:50.272031 [info ] [Thread-1 (]: 7 of 11 START sql table model wellbefore.src_offers ............................ [RUN]
[0m17:51:50.273150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m17:51:50.273150 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m17:51:50.275407 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m17:51:50.276426 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m17:51:50.277467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:51.497810 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m17:51:51.497810 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1
    );
  
[0m17:51:52.164110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fad6546e-5be5-49f1-904c-48f01ae5b584&page=queryresults
[0m17:51:55.251520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F63B0B0>]}
[0m17:51:55.251520 [info ] [Thread-1 (]: 7 of 11 OK created sql table model wellbefore.src_offers ....................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.98s]
[0m17:51:55.251520 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m17:51:55.251520 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m17:51:55.251520 [info ] [Thread-1 (]: 8 of 11 START sql table model wellbefore.src_products .......................... [RUN]
[0m17:51:55.251520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m17:51:55.251520 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m17:51:55.251520 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m17:51:55.267422 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m17:51:55.269997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:57.150774 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m17:51:57.150774 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_products`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data
    );
  
[0m17:51:57.854276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:16573b35-9151-4c79-a231-080231742384&page=queryresults
[0m17:52:01.181039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F5C4650>]}
[0m17:52:01.181039 [info ] [Thread-1 (]: 8 of 11 OK created sql table model wellbefore.src_products ..................... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 5.93s]
[0m17:52:01.181039 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m17:52:01.181039 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m17:52:01.181039 [info ] [Thread-1 (]: 9 of 11 START sql table model wellbefore.src_sales_ranking ..................... [RUN]
[0m17:52:01.181039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m17:52:01.181039 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m17:52:01.181039 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m17:52:01.181039 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m17:52:01.197788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:02.548813 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sales_ranking"
[0m17:52:02.550718 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sales_ranking"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers
    );
  
[0m17:52:03.280582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:1827ea4c-ce06-42a6-9c8f-d0c992599560&page=queryresults
[0m17:52:06.066446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F651190>]}
[0m17:52:06.067512 [info ] [Thread-1 (]: 9 of 11 OK created sql table model wellbefore.src_sales_ranking ................ [[32mCREATE TABLE (43.0 rows, 120.8 KiB processed)[0m in 4.89s]
[0m17:52:06.068565 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m17:52:06.069098 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sellers
[0m17:52:06.069635 [info ] [Thread-1 (]: 10 of 11 START sql table model wellbefore.src_sellers .......................... [RUN]
[0m17:52:06.070673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_sellers)
[0m17:52:06.071190 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sellers
[0m17:52:06.073417 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sellers"
[0m17:52:06.075041 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sellers
[0m17:52:06.077239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:07.341682 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sellers"
[0m17:52:07.341682 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sellers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sellers`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers
    );
  
[0m17:52:08.048293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:cbe146ec-7f58-4549-a24f-8b79b13cfec3&page=queryresults
[0m17:52:10.846287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F65CCE0>]}
[0m17:52:10.846287 [info ] [Thread-1 (]: 10 of 11 OK created sql table model wellbefore.src_sellers ..................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.78s]
[0m17:52:10.846287 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sellers
[0m17:52:10.846287 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m17:52:10.846287 [info ] [Thread-1 (]: 11 of 11 START sql table model wellbefore.src_shipping ......................... [RUN]
[0m17:52:10.855395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sellers, now model.buy_box_gcp_1.src_shipping)
[0m17:52:10.855395 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m17:52:10.855395 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m17:52:10.855395 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m17:52:10.855395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:12.197516 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m17:52:12.197516 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers
    );
  
[0m17:52:12.877917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:225b3ef8-ebaa-47bd-bc5a-10f3d6b2c6d0&page=queryresults
[0m17:52:15.622312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7F9FBE90>]}
[0m17:52:15.623420 [info ] [Thread-1 (]: 11 of 11 OK created sql table model wellbefore.src_shipping .................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.77s]
[0m17:52:15.624612 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m17:52:15.626763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:15.626763 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m17:52:15.626763 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m17:52:15.627764 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m17:52:15.628289 [info ] [MainThread]: 
[0m17:52:15.628400 [info ] [MainThread]: Finished running 1 view model, 10 table models in 0 hours 0 minutes and 54.93 seconds (54.93s).
[0m17:52:15.630454 [debug] [MainThread]: Command end result
[0m17:52:15.660367 [info ] [MainThread]: 
[0m17:52:15.660367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:15.660367 [info ] [MainThread]: 
[0m17:52:15.660367 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:52:15.666785 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:15.666785 after 57.76 seconds
[0m17:52:15.666785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7D7F7F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6AB5F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6AB5D730>]}
[0m17:52:15.666785 [debug] [MainThread]: Flushing usage events
[0m11:36:50.395701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029298FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029298D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029298D2B0>]}


============================== 11:36:50.395701 | 5ce30be7-72bf-41d2-a432-cf70497236a4 ==============================
[0m11:36:50.395701 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:36:50.395701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:36:51.729698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A5FD0260>]}
[0m11:36:51.796576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A5A09D00>]}
[0m11:36:51.796576 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:36:51.796576 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:36:51.913667 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m11:36:51.913667 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://seeds\B00KJ75ISS_1_month.csv
[0m11:36:51.913667 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://seeds\BuyBox_raw_ds_first20_entries.csv
[0m11:36:51.913667 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:36:51.913667 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://models\src\src_sellers.sql
[0m11:36:52.278136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A652FA10>]}
[0m11:36:52.359746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A621A960>]}
[0m11:36:52.359746 [info ] [MainThread]: Found 11 models, 2 seeds, 478 macros
[0m11:36:52.359746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A62C2000>]}
[0m11:36:52.359746 [info ] [MainThread]: 
[0m11:36:52.359746 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:36:52.359746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:36:52.359746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:53.730215 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:36:53.730215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:55.009795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A56D6E70>]}
[0m11:36:55.010718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:55.010718 [info ] [MainThread]: 
[0m11:36:55.014290 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m11:36:55.014995 [info ] [Thread-1 (]: 1 of 2 START seed file wellbefore.B00KJ75ISS_1_month ........................... [RUN]
[0m11:36:55.015425 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp_1.B00KJ75ISS_1_month'
[0m11:36:55.015425 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m11:36:55.016477 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m11:36:55.769433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:14.959430 [debug] [Thread-1 (]: On seed.buy_box_gcp_1.B00KJ75ISS_1_month: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"} */

    alter table `dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month` set OPTIONS()
  
[0m11:37:15.527430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:ee429661-6b52-4284-8582-2ba9451c9cd0&page=queryresults
[0m11:37:16.366697 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp_1.B00KJ75ISS_1_month"
[0m11:37:16.394621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A64FA390>]}
[0m11:37:16.395618 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file wellbefore.B00KJ75ISS_1_month ....................... [[32mINSERT 4834[0m in 21.38s]
[0m11:37:16.396529 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m11:37:16.396529 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m11:37:16.397808 [info ] [Thread-1 (]: 2 of 2 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m11:37:16.397808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.buy_box_gcp_1.B00KJ75ISS_1_month, now seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries)
[0m11:37:16.397808 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m11:37:16.397808 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m11:37:16.397808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:23.791755 [debug] [Thread-1 (]: On seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"} */

    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m11:37:24.326913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9310f0bf-b0ae-4bb6-97d7-abc68fd82f19&page=queryresults
[0m11:37:25.164280 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"
[0m11:37:25.164280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce30be7-72bf-41d2-a432-cf70497236a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A76B8E00>]}
[0m11:37:25.164280 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 8.77s]
[0m11:37:25.164280 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m11:37:25.164280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:25.164280 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:37:25.164280 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:37:25.164280 [debug] [MainThread]: Connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries' was properly closed.
[0m11:37:25.164280 [info ] [MainThread]: 
[0m11:37:25.164280 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 32.80 seconds (32.80s).
[0m11:37:25.164280 [debug] [MainThread]: Command end result
[0m11:37:25.222137 [info ] [MainThread]: 
[0m11:37:25.223231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:25.224152 [info ] [MainThread]: 
[0m11:37:25.225140 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:37:25.227252 [debug] [MainThread]: Command `dbt seed` succeeded at 11:37:25.226155 after 35.01 seconds
[0m11:37:25.227697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029298FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A6049100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029278BBF0>]}
[0m11:37:25.227697 [debug] [MainThread]: Flushing usage events
[0m11:39:12.492209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018700080230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187021AF140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187021AF1D0>]}


============================== 11:39:12.492209 | e9dd5723-52f4-4aa6-9436-e5456bd8a0f6 ==============================
[0m11:39:12.492209 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:39:12.507941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_offers_values', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:13.745909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187159BCAA0>]}
[0m11:39:13.792792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187157B7500>]}
[0m11:39:13.792792 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:39:13.811022 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:39:13.917125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:39:13.917125 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\dim\dim_offers_values.sql
[0m11:39:14.137722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187160B7440>]}
[0m11:39:14.211877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187164F85C0>]}
[0m11:39:14.211877 [info ] [MainThread]: Found 12 models, 2 seeds, 478 macros
[0m11:39:14.216426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871651F650>]}
[0m11:39:14.218303 [info ] [MainThread]: 
[0m11:39:14.220310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:39:14.221404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:39:14.222314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:15.447966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:39:15.447966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:16.678891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871651D190>]}
[0m11:39:16.678891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:16.678891 [info ] [MainThread]: 
[0m11:39:16.678891 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m11:39:16.678891 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_offers_values ....................... [RUN]
[0m11:39:16.693898 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_offers_values'
[0m11:39:16.695207 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m11:39:16.703393 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m11:39:16.705385 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m11:39:16.734731 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_offers_values"
[0m11:39:16.736732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:16.767979 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_offers_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_offers_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers


    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,


    FROM

        flatten_payload,

        UNNEST(offers) AS offer
)

SELECT *

FROM flattened_payload order by ASIN;


[0m11:39:18.364469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c0c5c5ee-7719-4cd1-b462-c30833dec071&page=queryresults
[0m11:39:19.228995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dd5723-52f4-4aa6-9436-e5456bd8a0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018715618710>]}
[0m11:39:19.229996 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_offers_values .................. [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m11:39:19.230995 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m11:39:19.233051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:19.233051 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:39:19.233051 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:39:19.233051 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_offers_values' was properly closed.
[0m11:39:19.234105 [info ] [MainThread]: 
[0m11:39:19.234105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m11:39:19.234105 [debug] [MainThread]: Command end result
[0m11:39:19.271298 [info ] [MainThread]: 
[0m11:39:19.273033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:19.273033 [info ] [MainThread]: 
[0m11:39:19.273033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:19.277254 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:19.276255 after 6.95 seconds
[0m11:39:19.277254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001870296D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187021ACD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187021AF1D0>]}
[0m11:39:19.278253 [debug] [MainThread]: Flushing usage events
[0m11:58:50.922350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562519250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5622BA6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562519610>]}


============================== 11:58:50.926350 | caec647c-3d08-4889-8fa5-8f6de3586e27 ==============================
[0m11:58:50.926350 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:58:50.927354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:52.343225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575AFFC20>]}
[0m11:58:52.404215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5750E5340>]}
[0m11:58:52.405214 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:58:52.410808 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:58:52.549060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:58:52.549060 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m11:58:52.806577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575D090D0>]}
[0m11:58:52.889531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A57604FE00>]}
[0m11:58:52.890534 [info ] [MainThread]: Found 13 models, 2 seeds, 478 macros
[0m11:58:52.891291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575DE0EC0>]}
[0m11:58:52.892340 [info ] [MainThread]: 
[0m11:58:52.894199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:52.898712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:58:52.898712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:54.380039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:58:54.380039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:55.634373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A57604D640>]}
[0m11:58:55.634373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:55.635272 [info ] [MainThread]: 
[0m11:58:55.639319 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m11:58:55.639319 [info ] [Thread-1 (]: 1 of 13 START sql view model wellbefore.dim_all_columns ........................ [RUN]
[0m11:58:55.640268 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m11:58:55.640268 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m11:58:55.646271 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m11:58:55.648272 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m11:58:55.669875 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m11:58:55.676918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:55.719308 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data
    FROM
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries
),

flatten_payload AS (
    SELECT
        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,
        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,
        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,
        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr
    FROM
        source_data
),

flattened_payload AS (
    SELECT
        EventTime,
        ApplicationId,
        NotificationId,
        PublishTime,
        SubscriptionId,
        NotificationType,
        NotificationVersion,
        ASIN,
        ItemCondition,
        MarketplaceId,
        OfferChangeType,
        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,
        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,
        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,
        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,
        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,
        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,
        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,
        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,
        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,
        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,
        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,
        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,
        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,
        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,
        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,
        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,
        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM
        flatten_payload,
        UNNEST(offers) AS offer,
        UNNEST(bbp) AS bbp,
        UNNEST(lop) AS lop,
        UNNEST(neo) AS neo,
        UNNEST(noo) AS noo,
        UNNEST(sr) AS sr
)

SELECT *
FROM flattened_payload;


[0m11:58:57.176121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:36282657-4fc1-4fbe-8ef9-28854f400b97&page=queryresults
[0m11:58:58.019483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575158680>]}
[0m11:58:58.019483 [info ] [Thread-1 (]: 1 of 13 OK created sql view model wellbefore.dim_all_columns ................... [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m11:58:58.035107 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m11:58:58.035107 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m11:58:58.035107 [info ] [Thread-1 (]: 2 of 13 START sql view model wellbefore.dim_offers_values ...................... [RUN]
[0m11:58:58.035107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.dim_offers_values)
[0m11:58:58.035107 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m11:58:58.035107 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m11:58:58.035107 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m11:58:58.035107 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_offers_values"
[0m11:58:58.035107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:58.083019 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_offers_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_offers_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers


    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,


    FROM

        flatten_payload,

        UNNEST(offers) AS offer
)

SELECT *

FROM flattened_payload order by ASIN;


[0m11:58:59.510344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:06f14531-9a85-4735-b9e8-6a207e6d769c&page=queryresults
[0m11:59:00.345354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576115A90>]}
[0m11:59:00.345354 [info ] [Thread-1 (]: 2 of 13 OK created sql view model wellbefore.dim_offers_values ................. [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m11:59:00.345354 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m11:59:00.345354 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m11:59:00.345354 [info ] [Thread-1 (]: 3 of 13 START sql view model wellbefore.dim_summary_values ..................... [RUN]
[0m11:59:00.345354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_offers_values, now model.buy_box_gcp_1.dim_summary_values)
[0m11:59:00.345354 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m11:59:00.345354 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m11:59:00.345354 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m11:59:00.345354 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m11:59:00.345354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:00.393777 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload order by ASIN;


[0m11:59:01.872469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:026dc5bc-869b-4eaa-a925-3030c9d666d4&page=queryresults
[0m11:59:02.707860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576153BC0>]}
[0m11:59:02.709117 [info ] [Thread-1 (]: 3 of 13 OK created sql view model wellbefore.dim_summary_values ................ [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m11:59:02.709980 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m11:59:02.710570 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:59:02.711224 [info ] [Thread-1 (]: 4 of 13 START sql view model wellbefore.fct_sellers ............................ [RUN]
[0m11:59:02.711876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_summary_values, now model.buy_box_gcp_1.fct_sellers)
[0m11:59:02.711876 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:59:02.715972 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:59:02.718008 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:59:02.722023 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:59:02.724080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:02.775152 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers;


[0m11:59:04.198317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:71a90bba-9d14-4e68-ac21-86025f761b73&page=queryresults
[0m11:59:05.134658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576181040>]}
[0m11:59:05.135611 [info ] [Thread-1 (]: 4 of 13 OK created sql view model wellbefore.fct_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m11:59:05.137613 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:59:05.137613 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m11:59:05.138619 [info ] [Thread-1 (]: 5 of 13 START sql table model wellbefore.src_buybox_offers ..................... [RUN]
[0m11:59:05.139610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.fct_sellers, now model.buy_box_gcp_1.src_buybox_offers)
[0m11:59:05.140611 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m11:59:05.144314 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m11:59:05.145434 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m11:59:05.155354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:06.545387 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m11:59:06.545387 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1
    );
  
[0m11:59:07.213834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:baf9550a-61f9-443f-80f1-a5e234f38e8b&page=queryresults
[0m11:59:09.811750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576153BC0>]}
[0m11:59:09.842600 [info ] [Thread-1 (]: 5 of 13 OK created sql table model wellbefore.src_buybox_offers ................ [[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)[0m in 4.67s]
[0m11:59:09.844069 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m11:59:09.844069 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m11:59:09.845158 [info ] [Thread-1 (]: 6 of 13 START sql table model wellbefore.src_notification_lowest_prices ........ [RUN]
[0m11:59:09.847068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m11:59:09.847068 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m11:59:09.856136 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m11:59:09.858071 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m11:59:09.860622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:11.160577 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m11:59:11.163577 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_lowest_prices"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1
    );
  
[0m11:59:12.182912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:4881aa0d-da59-4494-b340-fd8afc30b37c&page=queryresults
[0m11:59:14.909883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A57616E090>]}
[0m11:59:14.911234 [info ] [Thread-1 (]: 6 of 13 OK created sql table model wellbefore.src_notification_lowest_prices ... [[32mCREATE TABLE (28.0 rows, 120.8 KiB processed)[0m in 5.06s]
[0m11:59:14.914282 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m11:59:14.916282 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m11:59:14.918281 [info ] [Thread-1 (]: 7 of 13 START sql table model wellbefore.src_notification_summary .............. [RUN]
[0m11:59:14.920278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m11:59:14.921282 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m11:59:14.926845 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m11:59:14.929421 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m11:59:14.932535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:16.246759 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_summary"
[0m11:59:16.248758 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_summary"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1
    );
  
[0m11:59:16.892848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a9f0d986-9ac6-4b39-91dd-b7605cb72faa&page=queryresults
[0m11:59:20.129622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576152DB0>]}
[0m11:59:20.140805 [info ] [Thread-1 (]: 7 of 13 OK created sql table model wellbefore.src_notification_summary ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 5.21s]
[0m11:59:20.143066 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m11:59:20.143066 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m11:59:20.145105 [info ] [Thread-1 (]: 8 of 13 START sql table model wellbefore.src_notifications ..................... [RUN]
[0m11:59:20.146352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m11:59:20.146352 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m11:59:20.153328 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m11:59:20.156349 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m11:59:20.161337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:21.439854 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notifications"
[0m11:59:21.440854 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notifications"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data
    );
  
[0m11:59:22.033112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a3414c54-eb38-467e-b0cb-5853bc639023&page=queryresults
[0m11:59:24.553070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5761A30B0>]}
[0m11:59:24.555072 [info ] [Thread-1 (]: 8 of 13 OK created sql table model wellbefore.src_notifications ................ [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.41s]
[0m11:59:24.558175 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m11:59:24.558175 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m11:59:24.560160 [info ] [Thread-1 (]: 9 of 13 START sql table model wellbefore.src_offer_change_trigger .............. [RUN]
[0m11:59:24.561901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m11:59:24.561901 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m11:59:24.567005 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m11:59:24.568917 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m11:59:24.572919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:25.795335 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m11:59:25.795335 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offer_change_trigger"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data
    );
  
[0m11:59:26.548431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:bd68ea70-0c68-4584-b83d-e90a8793a730&page=queryresults
[0m11:59:29.029957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5761449B0>]}
[0m11:59:29.032014 [info ] [Thread-1 (]: 9 of 13 OK created sql table model wellbefore.src_offer_change_trigger ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.47s]
[0m11:59:29.033084 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m11:59:29.033975 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m11:59:29.034966 [info ] [Thread-1 (]: 10 of 13 START sql table model wellbefore.src_offers ........................... [RUN]
[0m11:59:29.035973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m11:59:29.035973 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m11:59:29.039077 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m11:59:29.042012 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m11:59:29.045636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:30.495048 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m11:59:30.495999 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1
    );
  
[0m11:59:31.212202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:aa17e104-99c4-48f6-a4f1-be4745610638&page=queryresults
[0m11:59:33.881481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A577535BE0>]}
[0m11:59:33.881481 [info ] [Thread-1 (]: 10 of 13 OK created sql table model wellbefore.src_offers ...................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.85s]
[0m11:59:33.881481 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m11:59:33.881481 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m11:59:33.881481 [info ] [Thread-1 (]: 11 of 13 START sql table model wellbefore.src_products ......................... [RUN]
[0m11:59:33.881481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m11:59:33.881481 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m11:59:33.897464 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m11:59:33.899478 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m11:59:33.901361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:35.180162 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m11:59:35.180162 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_products`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data
    );
  
[0m11:59:35.828045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:21f9f0dc-de56-435c-81c5-b9a43ba0e672&page=queryresults
[0m11:59:39.695739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A577535A30>]}
[0m11:59:39.695739 [info ] [Thread-1 (]: 11 of 13 OK created sql table model wellbefore.src_products .................... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 5.81s]
[0m11:59:39.695739 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m11:59:39.695739 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m11:59:39.695739 [info ] [Thread-1 (]: 12 of 13 START sql table model wellbefore.src_sales_ranking .................... [RUN]
[0m11:59:39.695739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m11:59:39.695739 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m11:59:39.695739 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m11:59:39.711235 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m11:59:39.716985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:41.016397 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sales_ranking"
[0m11:59:41.019346 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sales_ranking"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers
    );
  
[0m11:59:41.613147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:940be860-292b-409b-b361-e815d1e5a53e&page=queryresults
[0m11:59:44.050206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A561D57530>]}
[0m11:59:44.050206 [info ] [Thread-1 (]: 12 of 13 OK created sql table model wellbefore.src_sales_ranking ............... [[32mCREATE TABLE (43.0 rows, 120.8 KiB processed)[0m in 4.35s]
[0m11:59:44.050206 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m11:59:44.050206 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m11:59:44.050206 [info ] [Thread-1 (]: 13 of 13 START sql table model wellbefore.src_shipping ......................... [RUN]
[0m11:59:44.057313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_shipping)
[0m11:59:44.057313 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m11:59:44.057313 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m11:59:44.057313 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m11:59:44.057313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:45.384350 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m11:59:45.386760 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers
    );
  
[0m11:59:46.012388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:59f61313-1e94-4827-b631-dd41df3f810c&page=queryresults
[0m11:59:49.019529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caec647c-3d08-4889-8fa5-8f6de3586e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A576114F80>]}
[0m11:59:49.019529 [info ] [Thread-1 (]: 13 of 13 OK created sql table model wellbefore.src_shipping .................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.97s]
[0m11:59:49.019529 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m11:59:49.019529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:49.019529 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:59:49.019529 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:59:49.028051 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_shipping' was properly closed.
[0m11:59:49.029059 [info ] [MainThread]: 
[0m11:59:49.030060 [info ] [MainThread]: Finished running 4 view models, 9 table models in 0 hours 0 minutes and 56.14 seconds (56.14s).
[0m11:59:49.033489 [debug] [MainThread]: Command end result
[0m11:59:49.080662 [info ] [MainThread]: 
[0m11:59:49.080662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:49.080662 [info ] [MainThread]: 
[0m11:59:49.080662 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m11:59:49.080662 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:49.080662 after 58.35 seconds
[0m11:59:49.080662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5623084A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56186B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A562642990>]}
[0m11:59:49.080662 [debug] [MainThread]: Flushing usage events
[0m12:06:37.073471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C96E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C9156780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C88C0980>]}


============================== 12:06:37.077165 | 03c33826-e061-48c8-8118-d2d003196f9e ==============================
[0m12:06:37.077165 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:06:37.078072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select dim_all-columns_1_month', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:06:38.738204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03c33826-e061-48c8-8118-d2d003196f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DCEE96D0>]}
[0m12:06:38.797378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03c33826-e061-48c8-8118-d2d003196f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8C8D9A0>]}
[0m12:06:38.798380 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:06:38.806411 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:06:38.951684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:06:38.952684 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\dim\dim_all_columns_1_month.sql
[0m12:06:39.194498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03c33826-e061-48c8-8118-d2d003196f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DD3E3170>]}
[0m12:06:39.280906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03c33826-e061-48c8-8118-d2d003196f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DD3A1250>]}
[0m12:06:39.281903 [info ] [MainThread]: Found 14 models, 2 seeds, 478 macros
[0m12:06:39.282904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c33826-e061-48c8-8118-d2d003196f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DD3C07A0>]}
[0m12:06:39.283950 [warn ] [MainThread]: The selection criterion 'dim_all-columns_1_month' does not match any enabled nodes
[0m12:06:39.284647 [info ] [MainThread]: 
[0m12:06:39.285741 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:06:39.286654 [debug] [MainThread]: Command end result
[0m12:06:39.318486 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:39.318486 after 2.45 seconds
[0m12:06:39.319583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C96E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DCF9E8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DD2B7AD0>]}
[0m12:06:39.319583 [debug] [MainThread]: Flushing usage events
[0m12:06:52.675225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7B570380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7E05F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7E05D670>]}


============================== 12:06:52.679016 | c88171a3-74f0-4d7a-99ad-601d2b6b07e1 ==============================
[0m12:06:52.679016 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:06:52.680024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_all_columns_1_month', 'send_anonymous_usage_stats': 'True'}
[0m12:06:54.046727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7BA9A4E0>]}
[0m12:06:54.107871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7D7057C0>]}
[0m12:06:54.108872 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:06:54.116511 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:06:54.250217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:54.251224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:54.278309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11A25BB0>]}
[0m12:06:54.385621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11C693D0>]}
[0m12:06:54.386429 [info ] [MainThread]: Found 14 models, 2 seeds, 478 macros
[0m12:06:54.386983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD118FA870>]}
[0m12:06:54.388548 [info ] [MainThread]: 
[0m12:06:54.389540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:06:54.390589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m12:06:54.391577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:55.607043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m12:06:55.607043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:56.834434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11A7DA30>]}
[0m12:06:56.835638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:56.836638 [info ] [MainThread]: 
[0m12:06:56.840638 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m12:06:56.840638 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns_1_month ................. [RUN]
[0m12:06:56.841639 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns_1_month'
[0m12:06:56.842639 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_1_month
[0m12:06:56.850688 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_1_month"
[0m12:06:56.852693 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_1_month
[0m12:06:56.880056 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns_1_month"
[0m12:06:56.883059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:06:56.920091 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns_1_month: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns_1_month"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_1_month`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),



flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),



flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,



        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,



        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,



        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,



        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,



        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode



    FROM

        flatten_payload,

        UNNEST(offers) AS offer,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)



SELECT *

FROM flattened_payload;


[0m12:06:58.444334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:4b4fd29c-8087-4d9d-8d42-4acba9758c36&page=queryresults
[0m12:06:59.289846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88171a3-74f0-4d7a-99ad-601d2b6b07e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD10EE84D0>]}
[0m12:06:59.290894 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_all_columns_1_month ............ [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m12:06:59.291856 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m12:06:59.292806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:59.292806 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m12:06:59.292806 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m12:06:59.292806 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns_1_month' was properly closed.
[0m12:06:59.294406 [info ] [MainThread]: 
[0m12:06:59.294406 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m12:06:59.296460 [debug] [MainThread]: Command end result
[0m12:06:59.337182 [info ] [MainThread]: 
[0m12:06:59.338432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:59.339439 [info ] [MainThread]: 
[0m12:06:59.340440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:06:59.342446 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:59.342446 after 6.78 seconds
[0m12:06:59.342446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7B570380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7B595BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11A24B90>]}
[0m12:06:59.342446 [debug] [MainThread]: Flushing usage events
[0m12:57:30.800458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5556C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C54801D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5556DCD0>]}


============================== 12:57:30.804457 | 50e40256-b18f-41a5-9474-cc12f6ea19ce ==============================
[0m12:57:30.804457 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:57:30.804870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select dim_summary_values', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:32.255240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C68BFA570>]}
[0m12:57:32.302113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C68B28890>]}
[0m12:57:32.302113 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:57:32.319246 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:57:32.464061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:32.464061 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m12:57:32.668016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C690F33E0>]}
[0m12:57:32.731296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C690B04A0>]}
[0m12:57:32.731296 [info ] [MainThread]: Found 14 models, 2 seeds, 478 macros
[0m12:57:32.746935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C68D535C0>]}
[0m12:57:32.746935 [info ] [MainThread]: 
[0m12:57:32.746935 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:32.746935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m12:57:32.746935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:34.282229 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m12:57:34.282229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:35.520670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C68D529F0>]}
[0m12:57:35.520670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:35.520670 [info ] [MainThread]: 
[0m12:57:35.531216 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m12:57:35.531805 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m12:57:35.532183 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m12:57:35.532183 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m12:57:35.532183 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m12:57:35.532183 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m12:57:35.566349 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m12:57:35.566349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:35.600915 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        NotificationId,

        PublishTime,

        ASIN,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(offers) AS offer,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload order by ASIN;


[0m12:57:37.127632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:98332d0e-3158-43ac-bf2b-3e1b21e84214&page=queryresults
[0m12:57:38.010367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e40256-b18f-41a5-9474-cc12f6ea19ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C681E8320>]}
[0m12:57:38.011368 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_summary_values ................. [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m12:57:38.013366 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m12:57:38.015716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:38.016728 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m12:57:38.017727 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m12:57:38.017727 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m12:57:38.018727 [info ] [MainThread]: 
[0m12:57:38.018727 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m12:57:38.020728 [debug] [MainThread]: Command end result
[0m12:57:38.066902 [info ] [MainThread]: 
[0m12:57:38.066902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:38.066902 [info ] [MainThread]: 
[0m12:57:38.066902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:57:38.066902 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:38.066902 after 7.41 seconds
[0m12:57:38.066902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C54801D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C68D99670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C556EDC70>]}
[0m12:57:38.066902 [debug] [MainThread]: Flushing usage events
[0m15:20:53.738881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5B9B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5B99160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5B98D10>]}


============================== 15:20:53.738881 | 224b4bd1-2b9c-4bfc-ad39-57c12140dd64 ==============================
[0m15:20:53.738881 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:20:53.749888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select variable_summary_table', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:55.280998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE8BEF4A0>]}
[0m15:20:55.329091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE84C4E00>]}
[0m15:20:55.344821 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:20:55.344821 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:20:55.482264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:20:55.482264 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m15:20:55.710261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE92A6480>]}
[0m15:20:55.772632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE96BC500>]}
[0m15:20:55.788245 [info ] [MainThread]: Found 15 models, 2 seeds, 478 macros
[0m15:20:55.789526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE93795B0>]}
[0m15:20:55.789526 [info ] [MainThread]: 
[0m15:20:55.792110 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:55.792110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:20:55.792110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:57.386274 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:20:57.393918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:58.860117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE9353320>]}
[0m15:20:58.860117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:58.860117 [info ] [MainThread]: 
[0m15:20:58.875746 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m15:20:58.875746 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m15:20:58.875746 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m15:20:58.881070 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m15:20:58.885060 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:20:58.885060 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m15:20:58.934736 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:20:58.934736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:58.978823 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    dbt-437212.wellbefore.dim_offers_values AS offers

JOIN 
    dbt-437212.wellbefore.dim_summary_values AS summary
    ON 
        offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
ORDER BY ASIN;
    );
  
[0m15:21:00.233845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a3db09eb-8559-4ff2-a391-b95e79d21f54&page=queryresults
[0m15:21:00.234952 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [99:14]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [99:14]')
[0m15:21:01.431001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3b2e8532-08cc-42bb-8271-a821dd1b4a8f&page=queryresults
[0m15:21:01.431001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3b2e8532-08cc-42bb-8271-a821dd1b4a8f&page=queryresults
[0m15:21:01.431001 [debug] [Thread-1 (]: Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got ";" at [99:14]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m15:21:01.431001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '224b4bd1-2b9c-4bfc-ad39-57c12140dd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE977E330>]}
[0m15:21:01.431001 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wellbefore.variable_summary_table ........ [[31mERROR[0m in 2.56s]
[0m15:21:01.431001 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m15:21:01.442143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:01.443144 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:21:01.443485 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:21:01.443988 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m15:21:01.443988 [info ] [MainThread]: 
[0m15:21:01.443988 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m15:21:01.443988 [debug] [MainThread]: Command end result
[0m15:21:01.490080 [info ] [MainThread]: 
[0m15:21:01.490080 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:01.490080 [info ] [MainThread]: 
[0m15:21:01.490080 [error] [MainThread]:   Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got ";" at [99:14]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m15:21:01.490080 [info ] [MainThread]: 
[0m15:21:01.490080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:01.499089 [debug] [MainThread]: Command `dbt run` failed at 15:21:01.499089 after 7.94 seconds
[0m15:21:01.500003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5475BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD59FF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5BCCC80>]}
[0m15:21:01.500003 [debug] [MainThread]: Flushing usage events
[0m15:21:19.144851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016776BA02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167791779B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016775C2CBF0>]}


============================== 15:21:19.144851 | 5308f1eb-9625-4bfc-aed3-bde9c81c9073 ==============================
[0m15:21:19.144851 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:21:19.160491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select variable_summary_table', 'send_anonymous_usage_stats': 'True'}
[0m15:21:20.479683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167770CA720>]}
[0m15:21:20.530019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670C3AC2F0>]}
[0m15:21:20.543116 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:21:20.543116 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:21:20.683541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:20.683541 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m15:21:20.903518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670D09BA40>]}
[0m15:21:20.997629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670D09BB60>]}
[0m15:21:20.997629 [info ] [MainThread]: Found 15 models, 2 seeds, 478 macros
[0m15:21:20.997629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670CE08E60>]}
[0m15:21:20.997629 [info ] [MainThread]: 
[0m15:21:20.997629 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:21:20.997629 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:21:20.997629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:22.834074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:21:22.834074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:24.256287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670CE0A750>]}
[0m15:21:24.256287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:24.271794 [info ] [MainThread]: 
[0m15:21:24.271794 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m15:21:24.271794 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m15:21:24.271794 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m15:21:24.279415 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m15:21:24.289445 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:21:24.291454 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m15:21:24.328538 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:21:24.330460 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:24.365826 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    dbt-437212.wellbefore.dim_offers_values AS offers

JOIN 
    dbt-437212.wellbefore.dim_summary_values AS summary
    ON 
        offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m15:21:25.997086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9f4246e4-30e4-4d5c-861d-0e28cc577ce4&page=queryresults
[0m15:21:31.923314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5308f1eb-9625-4bfc-aed3-bde9c81c9073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670CB60D10>]}
[0m15:21:31.923314 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wellbefore.variable_summary_table ............ [[32mCREATE TABLE (32.7k rows, 120.8 KiB processed)[0m in 7.65s]
[0m15:21:31.923314 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m15:21:31.923314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:31.923314 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:21:31.923314 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:21:31.923314 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m15:21:31.923314 [info ] [MainThread]: 
[0m15:21:31.923314 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m15:21:31.923314 [debug] [MainThread]: Command end result
[0m15:21:31.973057 [info ] [MainThread]: 
[0m15:21:31.973057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:31.973057 [info ] [MainThread]: 
[0m15:21:31.973057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:31.981565 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:31.981565 after 12.94 seconds
[0m15:21:31.981565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677913E960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016779382CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016778BCFF80>]}
[0m15:21:31.981565 [debug] [MainThread]: Flushing usage events
[0m15:22:56.041127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4E9331880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4E877DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4E877D5E0>]}


============================== 15:22:56.041127 | e6a3c570-c998-4751-88b6-1743885eeb1b ==============================
[0m15:22:56.041127 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:22:56.041127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select variable_summary_table', 'send_anonymous_usage_stats': 'True'}
[0m15:22:56.717018 [error] [MainThread]: Encountered an error:

[0m15:22:56.830673 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\runtime.py", line 71, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 403, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 369, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 325, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 149, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\bigquery\__init__.py", line 1, in <module>
    from dbt.adapters.bigquery.connections import BigQueryConnectionManager  # noqa
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\bigquery\connections.py", line 19, in <module>
    import google.cloud.bigquery
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\__init__.py", line 36, in <module>
    from google.cloud.bigquery.client import Client
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\client.py", line 69, in <module>
    from google.cloud.bigquery import _job_helpers
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\_job_helpers.py", line 47, in <module>
    from google.cloud.bigquery import job
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\job\__init__.py", line 27, in <module>
    from google.cloud.bigquery.job.copy_ import CopyJob
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\job\copy_.py", line 22, in <module>
    from google.cloud.bigquery.table import TableReference
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\table.py", line 65, in <module>
    from google.cloud.bigquery._tqdm_helpers import get_progress_bar
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\_tqdm_helpers.py", line 30, in <module>
    import tqdm.notebook as tqdm_notebook  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\tqdm\notebook.py", line 23, in <module>
    import ipywidgets
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\ipywidgets\__init__.py", line 27, in <module>
    from IPython import get_ipython
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\IPython\__init__.py", line 55, in <module>
    from .terminal.embed import embed
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\IPython\terminal\embed.py", line 14, in <module>
    from IPython.core.magic import Magics, magics_class, line_magic
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\IPython\core\magic.py", line 303, in <module>
    register_line_cell_magic = _function_magic_marker('line_cell')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\IPython\core\magic.py", line 247, in _function_magic_marker
    ds = _docstring_template.format('function', magic_kind)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:22:56.836672 [debug] [MainThread]: Command `dbt run` failed at 15:22:56.836672 after 0.96 seconds
[0m15:22:56.836672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4E8B90800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4F9DF07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4F8F8C4D0>]}
[0m15:22:56.836672 [debug] [MainThread]: Flushing usage events
[0m15:23:09.485975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF0352360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EEFF4A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF0353110>]}


============================== 15:23:09.485975 | f7174d4c-c07a-4b2d-9819-b2f775f0e3e4 ==============================
[0m15:23:09.485975 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:23:09.485975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select variable_summary_table', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:11.154027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83035E20>]}
[0m15:23:11.236263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E838DEF60>]}
[0m15:23:11.237270 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:23:11.244267 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:23:11.386768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:11.387775 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m15:23:11.634843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83E8B530>]}
[0m15:23:11.719337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83E41640>]}
[0m15:23:11.719769 [info ] [MainThread]: Found 15 models, 2 seeds, 478 macros
[0m15:23:11.720777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83D50F50>]}
[0m15:23:11.721878 [info ] [MainThread]: 
[0m15:23:11.722772 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:23:11.724611 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m15:23:11.724611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:13.128793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m15:23:13.129705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.503949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EEF7EB800>]}
[0m15:23:14.503949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:14.503949 [info ] [MainThread]: 
[0m15:23:14.503949 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m15:23:14.503949 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m15:23:14.503949 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m15:23:14.514491 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m15:23:14.521123 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:23:14.521123 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m15:23:14.555196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:16.014667 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m15:23:16.014667 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    dbt-437212.wellbefore.dim_offers_values AS offers

JOIN 
    dbt-437212.wellbefore.dim_summary_values AS summary
    ON 
        offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
GROUP BY
   offers.ASIN, offers.SELLERID, offers.NOTIFICATIONID, offers.ListingPriceAmount, offers.PUBLISHTIME , 
   offers.ISBUYBOXWINNER, offers.ISOFFERPRIME,offers.SHIPSDOMESTICALLY, offers.SHIPPINGMAXHOURS, 
   offers.SHIPPINGMINHOURS, offers.SELLERFEEDBACKCOUNT, offers.SELLERPOSITIVEFEEDBACKRATING, 
   offers.SHIPPINGAMOUNT,summary.BUYBOXLISTINGPRICEAMOUNT
ORDER BY 
    ASIN
    );
  
[0m15:23:17.513515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:6e276f2c-979c-4562-b974-fd38e26fbcad&page=queryresults
[0m15:23:17.951945 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: offers at [100:4]; reason: invalidQuery, location: query, message: Unrecognized name: offers at [100:4]')
[0m15:23:19.379746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0d81e401-5289-4f58-88e7-9e119ca38dd4&page=queryresults
[0m15:23:19.770238 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0d81e401-5289-4f58-88e7-9e119ca38dd4&page=queryresults
[0m15:23:19.786817 [debug] [Thread-1 (]: Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Unrecognized name: offers at [100:4]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m15:23:19.786817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7174d4c-c07a-4b2d-9819-b2f775f0e3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83F0F740>]}
[0m15:23:19.786817 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wellbefore.variable_summary_table ........ [[31mERROR[0m in 5.28s]
[0m15:23:19.786817 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m15:23:19.800195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:19.801214 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m15:23:19.801214 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m15:23:19.801214 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m15:23:19.801214 [info ] [MainThread]: 
[0m15:23:19.802286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m15:23:19.803497 [debug] [MainThread]: Command end result
[0m15:23:19.838369 [info ] [MainThread]: 
[0m15:23:19.838369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:23:19.838369 [info ] [MainThread]: 
[0m15:23:19.838369 [error] [MainThread]:   Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Unrecognized name: offers at [100:4]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m15:23:19.838369 [info ] [MainThread]: 
[0m15:23:19.838369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:19.838369 [debug] [MainThread]: Command `dbt run` failed at 15:23:19.838369 after 10.47 seconds
[0m15:23:19.838369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83CF1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EEDE82330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF0397E30>]}
[0m15:23:19.838369 [debug] [MainThread]: Flushing usage events
[0m16:18:52.223330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258834427B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258830B9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025883442180>]}


============================== 16:18:52.227558 | 23feee50-f2c7-45bf-818e-833378248fc4 ==============================
[0m16:18:52.227558 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:18:52.228623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select dim_summary_values', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:53.992122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258834B9910>]}
[0m16:18:54.092757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025882470C20>]}
[0m16:18:54.093860 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:18:54.103149 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:18:54.265056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:18:54.265711 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m16:18:54.266348 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m16:18:54.499865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025896D6B230>]}
[0m16:18:54.595030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025896E413A0>]}
[0m16:18:54.595030 [info ] [MainThread]: Found 15 models, 2 seeds, 478 macros
[0m16:18:54.595030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025896DB9550>]}
[0m16:18:54.595030 [info ] [MainThread]: 
[0m16:18:54.595030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:54.595030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m16:18:54.595030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:56.006898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m16:18:56.006898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:57.493465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258823B2510>]}
[0m16:18:57.502262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:57.502998 [info ] [MainThread]: 
[0m16:18:57.510739 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m16:18:57.510739 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m16:18:57.510739 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m16:18:57.510739 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m16:18:57.532285 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m16:18:57.540578 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m16:18:57.635252 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m16:18:57.639439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:18:57.712915 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        NotificationId,

        PublishTime,

        ASIN,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(offers) AS offer,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload order by ASIN;


[0m16:19:00.054557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:800b56f0-10a7-40f7-b2d2-9abb796f0d30&page=queryresults
[0m16:19:01.016597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23feee50-f2c7-45bf-818e-833378248fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895F688C0>]}
[0m16:19:01.018086 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_summary_values ................. [[32mCREATE VIEW (0 processed)[0m in 3.50s]
[0m16:19:01.018086 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m16:19:01.024963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:01.024963 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m16:19:01.024963 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m16:19:01.026529 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m16:19:01.026529 [info ] [MainThread]: 
[0m16:19:01.026529 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m16:19:01.030005 [debug] [MainThread]: Command end result
[0m16:19:01.109774 [info ] [MainThread]: 
[0m16:19:01.109774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:01.122792 [info ] [MainThread]: 
[0m16:19:01.123472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:19:01.149114 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:01.149114 after 9.10 seconds
[0m16:19:01.149114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025896AD3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258830393A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258830391C0>]}
[0m16:19:01.149114 [debug] [MainThread]: Flushing usage events
[0m17:40:16.475568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616A4A25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616C845070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616C847920>]}


============================== 17:40:16.481685 | 3a9a3336-2731-42d4-b51f-1f5317bd2032 ==============================
[0m17:40:16.481685 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:40:16.483686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_all_columns_using_joins', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:40:18.909554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9a3336-2731-42d4-b51f-1f5317bd2032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616CFB5670>]}
[0m17:40:18.999021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a9a3336-2731-42d4-b51f-1f5317bd2032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616AB468D0>]}
[0m17:40:19.000118 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:40:19.011798 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:40:19.209017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:40:19.210026 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\dim\dim_all_columns_using_join.sql
[0m17:40:19.515305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a9a3336-2731-42d4-b51f-1f5317bd2032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016100BB7C80>]}
[0m17:40:19.630556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a9a3336-2731-42d4-b51f-1f5317bd2032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016100B74AD0>]}
[0m17:40:19.631601 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m17:40:19.632526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9a3336-2731-42d4-b51f-1f5317bd2032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016100869970>]}
[0m17:40:19.633524 [warn ] [MainThread]: The selection criterion 'dim_all_columns_using_joins' does not match any enabled nodes
[0m17:40:19.635524 [info ] [MainThread]: 
[0m17:40:19.637526 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:40:19.639681 [debug] [MainThread]: Command end result
[0m17:40:19.686580 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:19.686580 after 3.48 seconds
[0m17:40:19.687526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616A4A25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001617F894980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001616D10F050>]}
[0m17:40:19.688607 [debug] [MainThread]: Flushing usage events
[0m17:46:50.488789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023442E632F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343FE24A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023444B70590>]}


============================== 17:46:50.492804 | be01d913-af8d-438d-bf17-a28c8754ddf7 ==============================
[0m17:46:50.492804 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:46:50.493805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_all_columns_using_join', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:52.604648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023445C79370>]}
[0m17:46:52.702230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023445734E00>]}
[0m17:46:52.704250 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:46:52.716006 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:46:52.939625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:52.939625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:52.978515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002345949A9F0>]}
[0m17:46:53.118884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002345939EF60>]}
[0m17:46:53.119898 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m17:46:53.120891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234592B2780>]}
[0m17:46:53.124480 [info ] [MainThread]: 
[0m17:46:53.125476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:46:53.127477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m17:46:53.128476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:55.281883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m17:46:55.282878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:56.649189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023459285880>]}
[0m17:46:56.650197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:56.651196 [info ] [MainThread]: 
[0m17:46:56.656848 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:46:56.658361 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_all_columns_using_join .............. [RUN]
[0m17:46:56.661436 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns_using_join'
[0m17:46:56.662377 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:46:56.676508 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_using_join"
[0m17:46:56.678507 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:46:56.714100 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns_using_join"
[0m17:46:56.716039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:56.759021 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns_using_join: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns_using_join"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_using_join`
  OPTIONS()
  as SELECT *
FROM de-coe.buybox_dataset.src_Offers_Columns AS offers
JOIN de-coe.buybox_dataset.src_Summary_Columns AS summary
ON 
    offers.ASIN = summary.ASIN 
    AND offers.EventTime = summary.EventTime;


[0m17:46:58.303605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:cfa9b4fd-5c25-43d4-8c50-d13944db91d2&page=queryresults
[0m17:46:58.303605 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:cfa9b4fd-5c25-43d4-8c50-d13944db91d2&page=queryresults
[0m17:46:58.310561 [debug] [Thread-1 (]: Database Error in model dim_all_columns_using_join (models\dim\dim_all_columns_using_join.sql)
  Access Denied: Table de-coe:buybox_dataset.src_Offers_Columns: User does not have permission to query table de-coe:buybox_dataset.src_Offers_Columns, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns_using_join.sql
[0m17:46:58.312659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be01d913-af8d-438d-bf17-a28c8754ddf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023458A65C70>]}
[0m17:46:58.313568 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_all_columns_using_join ..... [[31mERROR[0m in 1.65s]
[0m17:46:58.314562 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:46:58.317576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:58.317576 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m17:46:58.318570 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m17:46:58.318570 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_all_columns_using_join' was properly closed.
[0m17:46:58.319135 [info ] [MainThread]: 
[0m17:46:58.319910 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m17:46:58.320601 [debug] [MainThread]: Command end result
[0m17:46:58.358557 [info ] [MainThread]: 
[0m17:46:58.359566 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:58.360566 [info ] [MainThread]: 
[0m17:46:58.362626 [error] [MainThread]:   Database Error in model dim_all_columns_using_join (models\dim\dim_all_columns_using_join.sql)
  Access Denied: Table de-coe:buybox_dataset.src_Offers_Columns: User does not have permission to query table de-coe:buybox_dataset.src_Offers_Columns, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns_using_join.sql
[0m17:46:58.363635 [info ] [MainThread]: 
[0m17:46:58.364637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:46:58.366636 [debug] [MainThread]: Command `dbt run` failed at 17:46:58.366636 after 8.10 seconds
[0m17:46:58.367634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234456E4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234591823C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234591E57C0>]}
[0m17:46:58.367634 [debug] [MainThread]: Flushing usage events
[0m19:11:41.185905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E3F852960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E4233DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E4233DE80>]}


============================== 19:11:41.185905 | 02fd014c-0d30-4828-b7b2-d35e083b31e3 ==============================
[0m19:11:41.185905 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:11:41.185905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_offers_values', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:42.542096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55A52D20>]}
[0m19:11:42.589637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E558C9D00>]}
[0m19:11:42.605375 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:11:42.605375 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:11:42.730070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:11:42.730070 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns_using_join.sql
[0m19:11:42.730070 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m19:11:42.950349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55EC9EE0>]}
[0m19:11:43.029838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E559EF410>]}
[0m19:11:43.029838 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:11:43.029838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55E062A0>]}
[0m19:11:43.029838 [info ] [MainThread]: 
[0m19:11:43.029838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:43.029838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:11:43.029838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:44.813055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:11:44.813055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:46.058965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55CFBC80>]}
[0m19:11:46.058965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:46.058965 [info ] [MainThread]: 
[0m19:11:46.058965 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m19:11:46.058965 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_offers_values ....................... [RUN]
[0m19:11:46.058965 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_offers_values'
[0m19:11:46.058965 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m19:11:46.072699 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m19:11:46.078596 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m19:11:46.097387 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_offers_values"
[0m19:11:46.097387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:46.146627 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_offers_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_offers_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers


    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,


    FROM

        flatten_payload,

        UNNEST(offers) AS offer
)

SELECT *

FROM flattened_payload order by ASIN;


[0m19:11:47.575748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d97301d8-3158-4dfe-8a69-e0808b6c2e36&page=queryresults
[0m19:11:48.465784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd014c-0d30-4828-b7b2-d35e083b31e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55E95E20>]}
[0m19:11:48.465784 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_offers_values .................. [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m19:11:48.465784 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m19:11:48.465784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:48.471295 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:11:48.471295 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:11:48.471295 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_offers_values' was properly closed.
[0m19:11:48.471295 [info ] [MainThread]: 
[0m19:11:48.471295 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m19:11:48.471295 [debug] [MainThread]: Command end result
[0m19:11:48.497628 [info ] [MainThread]: 
[0m19:11:48.497628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:48.512037 [info ] [MainThread]: 
[0m19:11:48.513343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:11:48.514062 [debug] [MainThread]: Command `dbt run` succeeded at 19:11:48.514062 after 7.52 seconds
[0m19:11:48.514062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E3F852960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55C82BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E55213890>]}
[0m19:11:48.514062 [debug] [MainThread]: Flushing usage events
[0m19:12:00.200419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4C7C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F2310410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4585AF0>]}


============================== 19:12:00.217033 | 0b8f3000-36a8-4d3c-9613-7abf61577ed1 ==============================
[0m19:12:00.217033 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:12:00.217033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_summary_values', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:12:01.454600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4CA9F40>]}
[0m19:12:01.517786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F406FFE0>]}
[0m19:12:01.517786 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:12:01.535062 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:12:01.645569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:01.645569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:01.676919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021988412630>]}
[0m19:12:01.757998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198852AF90>]}
[0m19:12:01.757998 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:12:01.757998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198869C6B0>]}
[0m19:12:01.771662 [info ] [MainThread]: 
[0m19:12:01.772168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:12:01.772168 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:12:01.772168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:02.981261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:12:02.981261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:04.255482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F28961B0>]}
[0m19:12:04.255482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:04.255482 [info ] [MainThread]: 
[0m19:12:04.255482 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m19:12:04.255482 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m19:12:04.255482 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m19:12:04.255482 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m19:12:04.273165 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:12:04.280197 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m19:12:04.297957 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:12:04.313470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:04.350640 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload order by ASIN;


[0m19:12:05.841099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7a7c0af0-6d93-4209-bdb4-c5c4fa394ae1&page=queryresults
[0m19:12:06.244615 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: offer at [50:29]; reason: invalidQuery, location: query, message: Unrecognized name: offer at [50:29]')
[0m19:12:07.858621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a0f1fc39-d49f-4efd-b671-1de93a80f48f&page=queryresults
[0m19:12:08.285753 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a0f1fc39-d49f-4efd-b671-1de93a80f48f&page=queryresults
[0m19:12:08.306002 [debug] [Thread-1 (]: Database Error in model dim_summary_values (models\dim\dim_summary_values.sql)
  Unrecognized name: offer at [50:29]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_summary_values.sql
[0m19:12:08.306002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b8f3000-36a8-4d3c-9613-7abf61577ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219887717C0>]}
[0m19:12:08.306002 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_summary_values ............. [[31mERROR[0m in 4.05s]
[0m19:12:08.306002 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m19:12:08.316445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:08.317448 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:12:08.317448 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:12:08.318447 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m19:12:08.318447 [info ] [MainThread]: 
[0m19:12:08.319446 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m19:12:08.322448 [debug] [MainThread]: Command end result
[0m19:12:08.364385 [info ] [MainThread]: 
[0m19:12:08.379290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:08.381127 [info ] [MainThread]: 
[0m19:12:08.381127 [error] [MainThread]:   Database Error in model dim_summary_values (models\dim\dim_summary_values.sql)
  Unrecognized name: offer at [50:29]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_summary_values.sql
[0m19:12:08.381127 [info ] [MainThread]: 
[0m19:12:08.381127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:08.381127 [debug] [MainThread]: Command `dbt run` failed at 19:12:08.381127 after 8.29 seconds
[0m19:12:08.381127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4C7C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4D02390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219886BFD10>]}
[0m19:12:08.381127 [debug] [MainThread]: Flushing usage events
[0m19:13:00.594670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CC5351C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CC7619880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CC76193D0>]}


============================== 19:13:00.594670 | 29c6d680-9073-4800-be38-53753bc285e4 ==============================
[0m19:13:00.594670 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:13:00.594670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_summary_values', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:13:01.834324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDADF5C70>]}
[0m19:13:01.896930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAF41A00>]}
[0m19:13:01.896930 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:13:01.896930 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:13:02.029110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:13:02.029110 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m19:13:02.241492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBC37440>]}
[0m19:13:02.304430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBD30920>]}
[0m19:13:02.320046 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:13:02.321554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBBD60C0>]}
[0m19:13:02.321554 [info ] [MainThread]: 
[0m19:13:02.321554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:13:02.321554 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:13:02.321554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:03.603979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:13:03.604512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:04.860065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDB9FC290>]}
[0m19:13:04.860065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:04.860065 [info ] [MainThread]: 
[0m19:13:04.860065 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m19:13:04.860065 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m19:13:04.860065 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m19:13:04.860065 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m19:13:04.869763 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:13:04.869763 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m19:13:04.899471 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:13:04.899471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:04.936773 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload order by ASIN;


[0m19:13:06.396356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d9b0be10-1ac9-470c-985c-09c0738093c2&page=queryresults
[0m19:13:06.847703 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: ASIN at [116:33]; reason: invalidQuery, location: query, message: Unrecognized name: ASIN at [116:33]')
[0m19:13:07.994789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:289f8ad1-f731-4b23-90e0-32b2e6d92dc1&page=queryresults
[0m19:13:08.422296 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:289f8ad1-f731-4b23-90e0-32b2e6d92dc1&page=queryresults
[0m19:13:08.422296 [debug] [Thread-1 (]: Database Error in model dim_summary_values (models\dim\dim_summary_values.sql)
  Unrecognized name: ASIN at [116:33]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_summary_values.sql
[0m19:13:08.422296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c6d680-9073-4800-be38-53753bc285e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBE03DD0>]}
[0m19:13:08.436395 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.dim_summary_values ............. [[31mERROR[0m in 3.56s]
[0m19:13:08.436395 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m19:13:08.439646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:08.439646 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:13:08.439646 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:13:08.439646 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m19:13:08.439646 [info ] [MainThread]: 
[0m19:13:08.439646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m19:13:08.439646 [debug] [MainThread]: Command end result
[0m19:13:08.477970 [info ] [MainThread]: 
[0m19:13:08.478963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:08.479963 [info ] [MainThread]: 
[0m19:13:08.480964 [error] [MainThread]:   Database Error in model dim_summary_values (models\dim\dim_summary_values.sql)
  Unrecognized name: ASIN at [116:33]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_summary_values.sql
[0m19:13:08.481964 [info ] [MainThread]: 
[0m19:13:08.481964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:13:08.484056 [debug] [MainThread]: Command `dbt run` failed at 19:13:08.484056 after 8.01 seconds
[0m19:13:08.485058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBD73E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDBBD76E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CC5D68350>]}
[0m19:13:08.485058 [debug] [MainThread]: Flushing usage events
[0m19:13:29.409483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B379CD9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B379B6DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37922DAF0>]}


============================== 19:13:29.425215 | cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e ==============================
[0m19:13:29.425215 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:13:29.425215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_summary_values', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:13:30.661526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D249E50>]}
[0m19:13:30.709093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D388950>]}
[0m19:13:30.709093 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:13:30.725265 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:13:30.879468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:13:30.879468 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m19:13:31.083593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D74AD80>]}
[0m19:13:31.163432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D844920>]}
[0m19:13:31.163432 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:13:31.163432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D4E3E30>]}
[0m19:13:31.163432 [info ] [MainThread]: 
[0m19:13:31.163432 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:13:31.163432 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:13:31.163432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:32.377598 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:13:32.377598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:33.657439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D559640>]}
[0m19:13:33.657439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:33.657439 [info ] [MainThread]: 
[0m19:13:33.657439 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m19:13:33.657439 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m19:13:33.657439 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m19:13:33.657439 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m19:13:33.669291 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:13:33.669291 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m19:13:33.700260 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:13:33.700260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:33.738101 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload;


[0m19:13:35.131619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:160daaa0-5004-447c-9298-5ce47602dfaf&page=queryresults
[0m19:13:36.009089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4b4eb6-c8c4-4e51-8a79-ca1acd82452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30C9780B0>]}
[0m19:13:36.009089 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_summary_values ................. [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m19:13:36.009089 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m19:13:36.009089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:36.009089 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:13:36.009089 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:13:36.009089 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m19:13:36.009089 [info ] [MainThread]: 
[0m19:13:36.009089 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m19:13:36.009089 [debug] [MainThread]: Command end result
[0m19:13:36.052256 [info ] [MainThread]: 
[0m19:13:36.053271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:36.053271 [info ] [MainThread]: 
[0m19:13:36.054294 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:13:36.055312 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:36.055312 after 6.75 seconds
[0m19:13:36.056328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3799B2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B379A25280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B379A25070>]}
[0m19:13:36.056328 [debug] [MainThread]: Flushing usage events
[0m19:26:27.451764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D24AD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D4471CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D4473200>]}


============================== 19:26:27.451764 | 02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7 ==============================
[0m19:26:27.451764 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:26:27.461771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_offers_values', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:26:28.742519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D27CA750>]}
[0m19:26:28.794605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E7C48F20>]}
[0m19:26:28.794605 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:26:28.794605 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:26:28.915303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:26:28.915303 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m19:26:29.136167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E7916480>]}
[0m19:26:29.198692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E8740B60>]}
[0m19:26:29.198692 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:26:29.198692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E83185C0>]}
[0m19:26:29.198692 [info ] [MainThread]: 
[0m19:26:29.214303 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:26:29.214303 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:26:29.214303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:31.026271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:26:31.027273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:32.307549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E84FFD10>]}
[0m19:26:32.307549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:32.307549 [info ] [MainThread]: 
[0m19:26:32.322621 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m19:26:32.322621 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_offers_values ....................... [RUN]
[0m19:26:32.322621 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_offers_values'
[0m19:26:32.322621 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m19:26:32.333140 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m19:26:32.333140 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m19:26:32.350946 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_offers_values"
[0m19:26:32.350946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:32.400619 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_offers_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_offers_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers


    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,


    FROM

        flatten_payload,

        UNNEST(offers) AS offer
)

SELECT *

FROM flattened_payload order by ASIN;


[0m19:26:33.890906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:801015e1-08c0-478d-b71f-f404c1f54e92&page=queryresults
[0m19:26:34.722795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e6d3dc-5711-4fcd-9cf9-b109c0a56bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E7878800>]}
[0m19:26:34.722795 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_offers_values .................. [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m19:26:34.722795 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m19:26:34.738298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:34.738298 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:26:34.738298 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:26:34.738298 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_offers_values' was properly closed.
[0m19:26:34.738298 [info ] [MainThread]: 
[0m19:26:34.738298 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m19:26:34.738298 [debug] [MainThread]: Command end result
[0m19:26:34.768102 [info ] [MainThread]: 
[0m19:26:34.768102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:34.768102 [info ] [MainThread]: 
[0m19:26:34.768102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:26:34.768102 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:34.768102 after 7.50 seconds
[0m19:26:34.768102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D4A486B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E85205F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E7A44A40>]}
[0m19:26:34.768102 [debug] [MainThread]: Flushing usage events
[0m19:26:41.319744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA080802C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A958140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A9E9D00>]}


============================== 19:26:41.319744 | c15bb344-14bb-45fe-ac4d-754a5e2f2b9c ==============================
[0m19:26:41.319744 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:26:41.319744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_summary_values', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:42.577199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1E00F680>]}
[0m19:26:42.624134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0AB41550>]}
[0m19:26:42.624134 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:26:42.639796 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:26:42.764323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:42.764323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:42.796249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1E193FB0>]}
[0m19:26:42.874173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1E24AB10>]}
[0m19:26:42.874173 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m19:26:42.874173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1E2EC590>]}
[0m19:26:42.874173 [info ] [MainThread]: 
[0m19:26:42.874173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:26:42.874173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m19:26:42.874173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:44.057062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m19:26:44.057062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:45.321558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1E336270>]}
[0m19:26:45.321558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:45.321558 [info ] [MainThread]: 
[0m19:26:45.321558 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m19:26:45.321558 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.dim_summary_values ...................... [RUN]
[0m19:26:45.321558 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_summary_values'
[0m19:26:45.321558 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m19:26:45.337068 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:26:45.337068 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m19:26:45.369505 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m19:26:45.369505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:45.419960 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload;


[0m19:26:47.046900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a5599720-ae7f-4365-acb0-d3709fa41338&page=queryresults
[0m19:26:47.904487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c15bb344-14bb-45fe-ac4d-754a5e2f2b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1D668620>]}
[0m19:26:47.904487 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.dim_summary_values ................. [[32mCREATE VIEW (0 processed)[0m in 2.58s]
[0m19:26:47.920133 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m19:26:47.920133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:47.924949 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m19:26:47.925548 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m19:26:47.925548 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.dim_summary_values' was properly closed.
[0m19:26:47.925548 [info ] [MainThread]: 
[0m19:26:47.925548 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m19:26:47.928440 [debug] [MainThread]: Command end result
[0m19:26:47.966779 [info ] [MainThread]: 
[0m19:26:47.966779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:47.966779 [info ] [MainThread]: 
[0m19:26:47.966779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:26:47.966779 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:47.966779 after 6.77 seconds
[0m19:26:47.966779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA080802C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A0D59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A0D7500>]}
[0m19:26:47.966779 [debug] [MainThread]: Flushing usage events
[0m11:18:50.502169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325DF72420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325DF726F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325DF734A0>]}


============================== 11:18:50.503748 | 890cabd2-c117-4fbf-84bc-2bfb9eea3de1 ==============================
[0m11:18:50.503748 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:18:50.503748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'send_anonymous_usage_stats': 'True'}
[0m11:18:53.041817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023270B45010>]}
[0m11:18:53.104748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271126C00>]}
[0m11:18:53.104748 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:18:53.104748 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:18:53.285295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:53.285295 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:18:53.495328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271597DA0>]}
[0m11:18:53.573754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271554B30>]}
[0m11:18:53.573754 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:18:53.573754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271591100>]}
[0m11:18:53.573754 [info ] [MainThread]: 
[0m11:18:53.573754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:53.573754 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:18:53.573754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:55.289379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:18:55.289379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:56.513167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325DC12AB0>]}
[0m11:18:56.514934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:56.514934 [info ] [MainThread]: 
[0m11:18:56.529770 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:18:56.529770 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:18:56.529770 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:18:56.529770 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:18:56.538836 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:18:56.542008 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:18:56.570733 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:18:56.572416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:18:56.609370 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon,
        CASE 
            WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
            WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
            WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
            WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
            WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
            WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
            WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
            WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
            WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
            WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
            WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
            WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
            WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
            ELSE 'Unknown Seller'
        END AS SellerName
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT * 
FROM flattened_offers;


[0m11:18:58.082252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e68c004d-3a5a-4d9a-85f8-7d1ed9346912&page=queryresults
[0m11:18:58.503577 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SellerId at [27:18]; reason: invalidQuery, location: query, message: Unrecognized name: SellerId at [27:18]')
[0m11:19:00.109521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fb68b3ad-7297-49da-a5ad-1860245a7bc1&page=queryresults
[0m11:19:00.510271 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fb68b3ad-7297-49da-a5ad-1860245a7bc1&page=queryresults
[0m11:19:00.524331 [debug] [Thread-1 (]: Database Error in model fct_sellers (models\fact\fct_sellers.sql)
  Unrecognized name: SellerId at [27:18]
  compiled Code at target\run\buy_box_gcp_1\models\fact\fct_sellers.sql
[0m11:19:00.537613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '890cabd2-c117-4fbf-84bc-2bfb9eea3de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271556F30>]}
[0m11:19:00.538618 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.fct_sellers .................... [[31mERROR[0m in 3.99s]
[0m11:19:00.539617 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:19:00.541381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:00.541381 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:19:00.541381 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:19:00.541381 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:19:00.541381 [info ] [MainThread]: 
[0m11:19:00.541381 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m11:19:00.541381 [debug] [MainThread]: Command end result
[0m11:19:00.556396 [info ] [MainThread]: 
[0m11:19:00.556396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:19:00.556396 [info ] [MainThread]: 
[0m11:19:00.570763 [error] [MainThread]:   Database Error in model fct_sellers (models\fact\fct_sellers.sql)
  Unrecognized name: SellerId at [27:18]
  compiled Code at target\run\buy_box_gcp_1\models\fact\fct_sellers.sql
[0m11:19:00.571771 [info ] [MainThread]: 
[0m11:19:00.572268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:19:00.572268 [debug] [MainThread]: Command `dbt run` failed at 11:19:00.572268 after 10.26 seconds
[0m11:19:00.572268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023270B26CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023271593E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232713F77A0>]}
[0m11:19:00.572268 [debug] [MainThread]: Flushing usage events
[0m11:27:43.338843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681EF24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681EF23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681EF2900>]}


============================== 11:27:43.338843 | 6117d43a-8c79-4f4a-bff2-53e03205ee5f ==============================
[0m11:27:43.338843 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:27:43.338843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:44.638420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166FF886960>]}
[0m11:27:44.709633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166FF8EA270>]}
[0m11:27:44.709633 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:27:44.709633 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:27:44.833195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:44.848840 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:27:45.044490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001669519B230>]}
[0m11:27:45.111072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016695520950>]}
[0m11:27:45.111072 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:27:45.111072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016695562C30>]}
[0m11:27:45.123168 [info ] [MainThread]: 
[0m11:27:45.123168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:45.123168 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:27:45.123168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:46.314845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:27:46.314845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:47.564111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016695541C10>]}
[0m11:27:47.564111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:27:47.564111 [info ] [MainThread]: 
[0m11:27:47.579739 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:27:47.579739 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:27:47.579739 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:27:47.582967 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:27:47.584105 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:27:47.584105 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:27:47.617019 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:27:47.618016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:27:47.652493 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon,
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT *,
    CASE 
            WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
            WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
            WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
            WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
            WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
            WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
            WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
            WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
            WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
            WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
            WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
            WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
            WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
            ELSE 'Unknown Seller'
        END AS SellerName
FROM flattened_offers;


[0m11:27:49.120929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9ce4592e-7104-4d95-9fb6-30769792bcb7&page=queryresults
[0m11:27:50.104550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6117d43a-8c79-4f4a-bff2-53e03205ee5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016694A586B0>]}
[0m11:27:50.104550 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.fct_sellers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m11:27:50.104550 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:27:50.104550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:50.104550 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:27:50.104550 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:27:50.104550 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:27:50.104550 [info ] [MainThread]: 
[0m11:27:50.104550 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m11:27:50.104550 [debug] [MainThread]: Command end result
[0m11:27:50.134132 [info ] [MainThread]: 
[0m11:27:50.134132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:50.134132 [info ] [MainThread]: 
[0m11:27:50.134132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:27:50.134132 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:50.134132 after 6.98 seconds
[0m11:27:50.134132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166952DC8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166950B4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681AE5220>]}
[0m11:27:50.134132 [debug] [MainThread]: Flushing usage events
[0m11:45:46.988778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10CC92BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10CBC1B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10CC92450>]}


============================== 11:45:46.992393 | d17092ae-a268-4c56-9716-3cd0017800eb ==============================
[0m11:45:46.992393 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:45:46.993473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'send_anonymous_usage_stats': 'True'}
[0m11:45:48.228908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11FC56D80>]}
[0m11:45:48.275786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11FC34CB0>]}
[0m11:45:48.275786 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:45:48.291494 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:45:48.408587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:48.408587 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:45:48.620153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10BCE7440>]}
[0m11:45:48.682767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1202849B0>]}
[0m11:45:48.682767 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:45:48.682767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11FE787D0>]}
[0m11:45:48.682767 [info ] [MainThread]: 
[0m11:45:48.698308 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:45:48.698308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:45:48.698308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:50.210880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:45:50.210880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:51.473229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11FE79D90>]}
[0m11:45:51.473229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:51.473229 [info ] [MainThread]: 
[0m11:45:51.473229 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:45:51.473229 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:45:51.473229 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:45:51.473229 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:45:51.484255 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:45:51.490312 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:45:51.508887 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:45:51.508887 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:45:51.550501 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.B00KJ75ISS_1_month AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon,
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT *,
    CASE 
            WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
            WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
            WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
            WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
            WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
            WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
            WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
            WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
            WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
            WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
            WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
            WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
            WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
            ELSE 'Unknown Seller'
        END AS SellerName
FROM flattened_offers;


[0m11:45:53.045163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:1c0c3904-1b71-4d63-aa9b-27089e8f3f69&page=queryresults
[0m11:45:53.919938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd17092ae-a268-4c56-9716-3cd0017800eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11F7CBCE0>]}
[0m11:45:53.919938 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.fct_sellers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m11:45:53.919938 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:45:53.919938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:53.919938 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:45:53.919938 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:45:53.919938 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:45:53.919938 [info ] [MainThread]: 
[0m11:45:53.919938 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m11:45:53.919938 [debug] [MainThread]: Command end result
[0m11:45:53.941691 [info ] [MainThread]: 
[0m11:45:53.941691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:53.941691 [info ] [MainThread]: 
[0m11:45:53.941691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:53.941691 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:53.941691 after 7.15 seconds
[0m11:45:53.941691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1201D4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11F9B3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10CCD7B00>]}
[0m11:45:53.941691 [debug] [MainThread]: Flushing usage events
[0m11:47:34.895933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015534B19F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001553425F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015534BA1B20>]}


============================== 11:47:34.895933 | c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280 ==============================
[0m11:47:34.895933 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:47:34.895933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:47:36.141718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015547CCA9F0>]}
[0m11:47:36.198298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015547E26A80>]}
[0m11:47:36.198298 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:47:36.198298 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:47:36.341448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:36.342459 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:47:36.542779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015547DE6480>]}
[0m11:47:36.604371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548250BC0>]}
[0m11:47:36.604371 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:47:36.604371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548013DA0>]}
[0m11:47:36.604371 [info ] [MainThread]: 
[0m11:47:36.604371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:36.604371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:47:36.604371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:37.861123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:47:37.861123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:39.070944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548290680>]}
[0m11:47:39.070944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:39.070944 [info ] [MainThread]: 
[0m11:47:39.086583 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:47:39.086583 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:47:39.086583 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:47:39.086583 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:47:39.097480 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:47:39.098506 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:47:39.110484 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:47:39.110484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:47:39.159318 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.B00KJ75ISS_1_month AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon,
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT *,
    CASE 
            WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
            WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
            WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
            WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
            WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
            WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
            WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
            WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
            WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
            WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
            WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
            WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
            WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
            ELSE 'Unknown Seller'
        END AS SellerName
FROM flattened_offers
order by SellerId;


[0m11:47:40.792260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a74db7f3-55e8-4372-99b9-b6684782a44b&page=queryresults
[0m11:47:41.639109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12c9c7d-34fa-4dfc-bb86-ff04f1c3e280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155477886E0>]}
[0m11:47:41.653636 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.fct_sellers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.55s]
[0m11:47:41.655242 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:47:41.655242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:41.655242 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:47:41.655242 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:47:41.655242 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:47:41.655242 [info ] [MainThread]: 
[0m11:47:41.655242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m11:47:41.655242 [debug] [MainThread]: Command end result
[0m11:47:41.677602 [info ] [MainThread]: 
[0m11:47:41.677602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:41.677602 [info ] [MainThread]: 
[0m11:47:41.677602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:41.677602 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:41.677602 after 6.96 seconds
[0m11:47:41.677602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001553425F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015547F49B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015534425AC0>]}
[0m11:47:41.677602 [debug] [MainThread]: Flushing usage events
[0m11:50:55.934250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF849DBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF847DDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF81F8C9B0>]}


============================== 11:50:55.935307 | e6d68963-a3f6-4504-a522-0f599950eec2 ==============================
[0m11:50:55.935307 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:50:55.935307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'send_anonymous_usage_stats': 'True'}
[0m11:50:57.163867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF856883B0>]}
[0m11:50:57.226444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF989546E0>]}
[0m11:50:57.226444 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:50:57.226444 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:50:57.347353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:50:57.363077 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:50:57.560504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF98B105C0>]}
[0m11:50:57.638617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF98FA0830>]}
[0m11:50:57.638617 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:50:57.642181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF98B10C50>]}
[0m11:50:57.642181 [info ] [MainThread]: 
[0m11:50:57.642181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:57.642181 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:50:57.642181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:58.951704 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:50:58.951704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:00.191301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF98B11D90>]}
[0m11:51:00.191301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:00.191301 [info ] [MainThread]: 
[0m11:51:00.191301 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:51:00.206938 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:51:00.207974 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:51:00.207974 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:51:00.214735 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:51:00.215208 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:51:00.232487 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:51:00.232487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:00.265749 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.B00KJ75ISS_1_month AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon,
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT EventTime,SellerId,SellerName,
    CASE 
            WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
            WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
            WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
            WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
            WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
            WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
            WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
            WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
            WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
            WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
            WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
            WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
            WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
            ELSE 'Unknown Seller'
        END AS SellerName,
        IsFeaturedMerchant,IsFulfilledByAmazon
FROM flattened_offers
order by SellerId;


[0m11:51:01.750448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7a6b7073-11a2-4806-9686-53de12b8f4a3&page=queryresults
[0m11:51:02.165080 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SellerName; Did you mean SellerId? at [31:27]; reason: invalidQuery, location: query, message: Unrecognized name: SellerName; Did you mean SellerId? at [31:27]')
[0m11:51:03.656413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:11b45bcb-3b86-4f94-a8fe-5bbc7531eef2&page=queryresults
[0m11:51:04.079141 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:11b45bcb-3b86-4f94-a8fe-5bbc7531eef2&page=queryresults
[0m11:51:04.079141 [debug] [Thread-1 (]: Database Error in model fct_sellers (models\fact\fct_sellers.sql)
  Unrecognized name: SellerName; Did you mean SellerId? at [31:27]
  compiled Code at target\run\buy_box_gcp_1\models\fact\fct_sellers.sql
[0m11:51:04.079141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d68963-a3f6-4504-a522-0f599950eec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF99073A70>]}
[0m11:51:04.079141 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.fct_sellers .................... [[31mERROR[0m in 3.87s]
[0m11:51:04.079141 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:51:04.093723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:04.103828 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:51:04.103828 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:51:04.103828 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:51:04.103828 [info ] [MainThread]: 
[0m11:51:04.103828 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m11:51:04.103828 [debug] [MainThread]: Command end result
[0m11:51:04.132505 [info ] [MainThread]: 
[0m11:51:04.132505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:51:04.132505 [info ] [MainThread]: 
[0m11:51:04.132505 [error] [MainThread]:   Database Error in model fct_sellers (models\fact\fct_sellers.sql)
  Unrecognized name: SellerName; Did you mean SellerId? at [31:27]
  compiled Code at target\run\buy_box_gcp_1\models\fact\fct_sellers.sql
[0m11:51:04.132505 [info ] [MainThread]: 
[0m11:51:04.132505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:04.132505 [debug] [MainThread]: Command `dbt run` failed at 11:51:04.132505 after 8.38 seconds
[0m11:51:04.132505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF84D5DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF98E47F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF858F21E0>]}
[0m11:51:04.132505 [debug] [MainThread]: Flushing usage events
[0m11:52:00.713046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319C3385C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319ECD8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319ECD9DF0>]}


============================== 11:52:00.720572 | 8e3e2fea-faff-469c-887e-7801034a3596 ==============================
[0m11:52:00.720572 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:52:00.720572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_sellers', 'send_anonymous_usage_stats': 'True'}
[0m11:52:01.958178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319EE88C50>]}
[0m11:52:02.015019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319DE34C50>]}
[0m11:52:02.015019 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:52:02.015019 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:52:02.146599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:02.146599 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m11:52:02.350996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B247B860>]}
[0m11:52:02.413917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B2430AA0>]}
[0m11:52:02.413917 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m11:52:02.413917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B2090050>]}
[0m11:52:02.413917 [info ] [MainThread]: 
[0m11:52:02.413917 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:02.429534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:52:02.429534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:03.605699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:52:03.605699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:04.810645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B214A690>]}
[0m11:52:04.810645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:04.810645 [info ] [MainThread]: 
[0m11:52:04.826141 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m11:52:04.826141 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.fct_sellers ............................. [RUN]
[0m11:52:04.826141 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.fct_sellers'
[0m11:52:04.826141 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m11:52:04.832768 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m11:52:04.832768 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m11:52:04.860596 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m11:52:04.860596 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:52:04.897562 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbt-437212.wellbefore.B00KJ75ISS_1_month AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT 
    EventTime,
    SellerId,
    CASE 
        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
        ELSE 'Unknown Seller'
    END AS SellerName,
    IsFeaturedMerchant,
    IsFulfilledByAmazon
FROM 
    flattened_offers
ORDER BY 
    SellerId;


[0m11:52:06.266643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:607afa7a-b1d4-4c26-b95d-34e7f543f65a&page=queryresults
[0m11:52:07.156869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e3e2fea-faff-469c-887e-7801034a3596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B19689B0>]}
[0m11:52:07.157934 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.fct_sellers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m11:52:07.158949 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m11:52:07.159984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:07.159984 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:52:07.161017 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:52:07.161017 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.fct_sellers' was properly closed.
[0m11:52:07.161017 [info ] [MainThread]: 
[0m11:52:07.161017 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m11:52:07.161017 [debug] [MainThread]: Command end result
[0m11:52:07.190136 [info ] [MainThread]: 
[0m11:52:07.190662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:07.191709 [info ] [MainThread]: 
[0m11:52:07.192235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:07.193374 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:07.193374 after 6.60 seconds
[0m11:52:07.193917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001319EAC9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B1F434A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131B20D3560>]}
[0m11:52:07.194453 [debug] [MainThread]: Flushing usage events
[0m14:42:20.168937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE39D7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE39D6F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE39D47A0>]}


============================== 14:42:20.168937 | 4319eab9-9242-42b1-beb3-31282fb13686 ==============================
[0m14:42:20.168937 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:42:20.168937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:42:20.331828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4319eab9-9242-42b1-beb3-31282fb13686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE433D010>]}
[0m14:42:20.362926 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:20.362926 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:20.362926 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:20.362926 after 0.38 seconds
[0m14:42:20.362926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE44DBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE433D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE44EFBC0>]}
[0m14:42:20.362926 [debug] [MainThread]: Flushing usage events
[0m17:22:21.511002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022375A611F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022375A61640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022375A63020>]}


============================== 17:22:21.511002 | 4a1bdfd3-b325-47e4-9ae4-f4e49a2fe1ec ==============================
[0m17:22:21.511002 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:22:21.511002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:23.027576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1bdfd3-b325-47e4-9ae4-f4e49a2fe1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022309582D80>]}
[0m17:22:23.090187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a1bdfd3-b325-47e4-9ae4-f4e49a2fe1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223090E0830>]}
[0m17:23:23.638471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222164D1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222164D18E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222164D3410>]}


============================== 17:23:23.638471 | 3d3f3247-bee3-47f7-a63d-e01b9db868b9 ==============================
[0m17:23:23.638471 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:23:23.638471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:24.904727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222163AAA20>]}
[0m17:23:24.968448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222295BC980>]}
[0m17:23:24.968448 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:23:24.983981 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:23:25.043471 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:23:25.043471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222298915E0>]}
[0m17:23:26.082420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222299896A0>]}
[0m17:23:26.122796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022229B7E5A0>]}
[0m17:23:26.122796 [info ] [MainThread]: Found 16 models, 2 seeds, 478 macros
[0m17:23:26.122796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022229B4C200>]}
[0m17:23:26.129305 [info ] [MainThread]: 
[0m17:23:26.129305 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:26.129305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m17:23:26.129305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:27.745736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3f3247-bee3-47f7-a63d-e01b9db868b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222984F050>]}
[0m17:23:27.745736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:27.745736 [info ] [MainThread]: 
[0m17:23:27.745736 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m17:23:27.745736 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m17:23:27.762040 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m17:23:27.762040 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m17:23:27.762040 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m17:23:27.777061 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m17:23:27.778538 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m17:23:27.778538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.dim_all_columns_1_month)
[0m17:23:27.779524 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_1_month
[0m17:23:27.782161 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_1_month"
[0m17:23:27.782161 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_1_month
[0m17:23:27.782161 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m17:23:27.782161 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:23:27.782161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_1_month, now model.buy_box_gcp_1.dim_all_columns_using_join)
[0m17:23:27.782161 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:23:27.782161 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_using_join"
[0m17:23:27.782161 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:23:27.782161 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m17:23:27.782161 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m17:23:27.782161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_using_join, now model.buy_box_gcp_1.dim_offers_values)
[0m17:23:27.782161 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m17:23:27.782161 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m17:23:27.795515 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_offers_values, now model.buy_box_gcp_1.dim_summary_values)
[0m17:23:27.795731 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m17:23:27.795731 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m17:23:27.795731 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m17:23:27.795731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_summary_values, now model.buy_box_gcp_1.fct_sellers)
[0m17:23:27.795731 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m17:23:27.795731 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m17:23:27.795731 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m17:23:27.795731 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m17:23:27.795731 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m17:23:27.795731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.fct_sellers, now model.buy_box_gcp_1.src_buybox_offers)
[0m17:23:27.795731 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m17:23:27.795731 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m17:23:27.811087 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m17:23:27.812067 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m17:23:27.812067 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:23:27.812067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m17:23:27.813066 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:23:27.814066 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m17:23:27.815065 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:23:27.816075 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m17:23:27.816075 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m17:23:27.817065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m17:23:27.817065 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m17:23:27.818065 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m17:23:27.820075 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m17:23:27.820075 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m17:23:27.821065 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m17:23:27.821065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m17:23:27.821065 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m17:23:27.823065 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m17:23:27.824065 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m17:23:27.825576 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m17:23:27.825576 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:23:27.826585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m17:23:27.827005 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:23:27.829137 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m17:23:27.830129 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:23:27.831133 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m17:23:27.831133 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m17:23:27.832040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m17:23:27.832540 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m17:23:27.833549 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m17:23:27.834548 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m17:23:27.835548 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m17:23:27.835548 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m17:23:27.836548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m17:23:27.836548 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m17:23:27.837548 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m17:23:27.839287 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m17:23:27.840300 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m17:23:27.840300 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m17:23:27.841389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m17:23:27.841389 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m17:23:27.842384 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m17:23:27.844425 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m17:23:27.844659 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m17:23:27.844659 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m17:23:27.844659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_shipping)
[0m17:23:27.844659 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m17:23:27.844659 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m17:23:27.844659 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m17:23:27.844659 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m17:23:27.844659 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m17:23:27.844659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_shipping, now model.buy_box_gcp_1.variable_summary_table)
[0m17:23:27.844659 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m17:23:27.844659 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m17:23:27.844659 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m17:23:27.844659 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m17:23:27.844659 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m17:23:27.844659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.variable_summary_table, now seed.buy_box_gcp_1.B00KJ75ISS_1_month)
[0m17:23:27.844659 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m17:23:27.844659 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m17:23:27.844659 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.B00KJ75ISS_1_month
[0m17:23:27.844659 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m17:23:27.844659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.buy_box_gcp_1.B00KJ75ISS_1_month, now seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries)
[0m17:23:27.844659 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m17:23:27.844659 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m17:23:27.860264 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m17:23:27.860264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:27.860264 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m17:23:27.860264 [debug] [MainThread]: Connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries' was properly closed.
[0m17:23:27.860264 [debug] [MainThread]: Command end result
[0m17:23:27.922763 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m17:23:27.922763 [info ] [MainThread]: Building catalog
[0m17:23:27.925857 [debug] [ThreadPool]: Acquiring new bigquery connection 'dbt-437212.information_schema'
[0m17:23:27.938960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:27.980861 [debug] [ThreadPool]: On dbt-437212.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp_1", "target_name": "dev", "connection_name": "dbt-437212.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dbt-437212`.`wellbefore`.__TABLES__ tables
    left join `dbt-437212`.`wellbefore`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dbt-437212`.`wellbefore`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_products')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('dim_offers_values')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_shipping')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_offers')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('dim_summary_values')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('fct_sellers')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_notifications')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('dim_all_columns_using_join')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('dim_all_columns')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('dim_all_columns_1_month')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('variable_summary_table')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_sales_ranking')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('B00KJ75ISS_1_month')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_notification_lowest_prices')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('BuyBox_raw_ds_first20_entries')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_notification_summary')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_buybox_offers')
                            ) or (
                                upper(table_schema) = upper('wellbefore')
                            and upper(table_name) = upper('src_offer_change_trigger')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dbt-437212`.`wellbefore`.INFORMATION_SCHEMA.COLUMNS columns
    join `dbt-437212`.`wellbefore`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:23:29.444033 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:6390adda-864a-49fe-939e-d5875aa805c4&page=queryresults
[0m17:23:32.191153 [info ] [MainThread]: Catalog written to C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp_1\target\catalog.json
[0m17:23:32.191153 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:23:32.191153 after 8.67 seconds
[0m17:23:32.191153 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:23:32.191153 [debug] [MainThread]: Connection 'dbt-437212.information_schema' was properly closed.
[0m17:23:32.191153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222AFA3B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222AFA0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222AFA0E30>]}
[0m17:23:32.191153 [debug] [MainThread]: Flushing usage events
[0m17:23:46.987488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250B3039D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250B06C85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250AF75CD40>]}


============================== 17:23:46.990587 | 93a4b563-485e-4390-af95-e00d7950045c ==============================
[0m17:23:46.990587 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:23:46.991496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:23:48.350028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93a4b563-485e-4390-af95-e00d7950045c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C6282D80>]}
[0m17:23:48.419445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93a4b563-485e-4390-af95-e00d7950045c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C62E0F50>]}
[0m17:24:53.244136 [error] [MainThread]: Encountered an error:

[0m17:24:53.296322 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:24:53.296322 [debug] [MainThread]: Command `dbt docs serve` failed at 17:24:53.296322 after 66.44 seconds
[0m17:24:53.296322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250B217A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C636A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C6369F10>]}
[0m17:24:53.296322 [debug] [MainThread]: Flushing usage events
[0m18:38:12.150519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FC4BC170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FC77B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FC77B140>]}


============================== 18:38:12.154124 | e4840694-447a-4da8-94dd-2decd84ee57a ==============================
[0m18:38:12.154124 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:38:12.155217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select src_buybox_offers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:13.493884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838F857E60>]}
[0m18:38:13.547778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838F680920>]}
[0m18:38:13.547778 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:38:13.547778 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:38:13.694318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:38:13.704418 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp_1://models\sources.yml
[0m18:38:13.704418 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_buybox_offers.sql
[0m18:38:14.019500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838FE6F0B0>]}
[0m18:38:14.098194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838FE60CE0>]}
[0m18:38:14.098194 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m18:38:14.098194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838FD6C8F0>]}
[0m18:38:14.098194 [info ] [MainThread]: 
[0m18:38:14.098194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:14.098194 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m18:38:14.098194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:15.612300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m18:38:15.612300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:16.919676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FB737CB0>]}
[0m18:38:16.919676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:16.919676 [info ] [MainThread]: 
[0m18:38:16.919676 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m18:38:16.919676 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.src_buybox_offers ...................... [RUN]
[0m18:38:16.919676 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_buybox_offers'
[0m18:38:16.919676 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m18:38:16.935370 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m18:38:16.935370 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m18:38:16.935370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:18.268074 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m18:38:18.268074 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices

    FROM source_data

),

flatten_data_1 AS (

    SELECT

        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,

        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,

        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,



        JSON_VALUE(noo.Condition)AS NumberOfferCondition,

        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,

        JSON_VALUE(noo.OfferCount)AS NumberOfferCount

    FROM flatten_data,

        UNNEST(buyboxprices) AS bop,

        UNNEST(numberOfOffers) AS noo

)



SELECT * FROM flatten_data_1
    );
  
[0m18:38:19.068548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:04fd0430-404e-43ca-9c8d-64dcfcd73164&page=queryresults
[0m18:38:22.126427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4840694-447a-4da8-94dd-2decd84ee57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838F2CBD10>]}
[0m18:38:22.126427 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wellbefore.src_buybox_offers ................. [[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)[0m in 5.21s]
[0m18:38:22.142098 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m18:38:22.142098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:22.142098 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m18:38:22.142098 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m18:38:22.142098 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_buybox_offers' was properly closed.
[0m18:38:22.142098 [info ] [MainThread]: 
[0m18:38:22.142098 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m18:38:22.142098 [debug] [MainThread]: Command end result
[0m18:38:22.159144 [info ] [MainThread]: 
[0m18:38:22.173685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:22.173685 [info ] [MainThread]: 
[0m18:38:22.173685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:38:22.177794 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:22.177794 after 10.25 seconds
[0m18:38:22.178787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838FD3B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FC372120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FC372690>]}
[0m18:38:22.179906 [debug] [MainThread]: Flushing usage events
[0m18:41:01.300717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681698C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026812EBB560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026819457440>]}


============================== 18:41:01.300717 | 713d13e1-0d92-4e12-99d5-b3bcb6a58144 ==============================
[0m18:41:01.300717 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:41:01.300717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select variable_summary_table', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:41:02.599755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026819483410>]}
[0m18:41:02.662886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C2D1880>]}
[0m18:41:02.662886 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:41:02.662886 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 13 files changed.
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notification_summary.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_shipping.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_summary_values.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_products.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\fact\fct_sellers.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offer_change_trigger.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_all_columns.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notification_lowest_prices.sql
[0m18:41:02.821777 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_sales_ranking.sql
[0m18:41:02.825785 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m18:41:02.825785 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_offers.sql
[0m18:41:02.825785 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\src\src_notifications.sql
[0m18:41:02.825785 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\dim_offers_values.sql
[0m18:41:03.069586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C8C69C0>]}
[0m18:41:03.148430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C9984A0>]}
[0m18:41:03.148430 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m18:41:03.148430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C900350>]}
[0m18:41:03.148430 [info ] [MainThread]: 
[0m18:41:03.148430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:03.148430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m18:41:03.148430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:04.403338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m18:41:04.403338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:05.673093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C65A990>]}
[0m18:41:05.673093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:05.673093 [info ] [MainThread]: 
[0m18:41:05.673093 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m18:41:05.673093 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m18:41:05.673093 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m18:41:05.686430 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m18:41:05.695055 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m18:41:05.696549 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m18:41:05.696549 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:06.935784 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m18:41:06.951517 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    `dbt-437212`.`wellbefore`.`dim_all_columns` AS offers

-- JOIN 
--     dbt-437212.wellbefore.dim_summary_values AS summary
--     ON 
--         offers.NotificationId = summary.NotificationId
-- )

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m18:41:07.414731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a5b39f8b-3dd6-403a-ba00-9cf815484667&page=queryresults
[0m18:41:07.414731 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SELECT at [98:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword SELECT at [98:1]')
[0m18:41:08.762961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c01a5180-8078-43ff-9238-d219d8ac5cf0&page=queryresults
[0m18:41:08.763961 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c01a5180-8078-43ff-9238-d219d8ac5cf0&page=queryresults
[0m18:41:08.769961 [debug] [Thread-1 (]: Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got keyword SELECT at [98:1]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m18:41:08.771961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '713d13e1-0d92-4e12-99d5-b3bcb6a58144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C99B980>]}
[0m18:41:08.771961 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wellbefore.variable_summary_table ........ [[31mERROR[0m in 3.10s]
[0m18:41:08.773962 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m18:41:08.775690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:08.776695 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m18:41:08.777442 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m18:41:08.777591 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m18:41:08.777591 [info ] [MainThread]: 
[0m18:41:08.778647 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m18:41:08.780476 [debug] [MainThread]: Command end result
[0m18:41:08.823571 [info ] [MainThread]: 
[0m18:41:08.824717 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:08.825849 [info ] [MainThread]: 
[0m18:41:08.826954 [error] [MainThread]:   Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got keyword SELECT at [98:1]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m18:41:08.827474 [info ] [MainThread]: 
[0m18:41:08.828082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:08.830029 [debug] [MainThread]: Command `dbt run` failed at 18:41:08.830029 after 7.74 seconds
[0m18:41:08.830029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681932FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C65A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002682C74A870>]}
[0m18:41:08.831199 [debug] [MainThread]: Flushing usage events
[0m18:42:22.576908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020340470FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020340471400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020340471820>]}


============================== 18:42:22.576908 | 33a843de-a9a2-45ab-a5ae-2b4eb56af125 ==============================
[0m18:42:22.576908 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:42:22.589916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select variable_summary_table', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:42:24.133548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020352F35670>]}
[0m18:42:24.196457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020353502F60>]}
[0m18:42:24.196457 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:42:24.196457 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:42:24.509527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:24.511303 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m18:42:25.001138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203404C6480>]}
[0m18:42:25.165210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203539F9160>]}
[0m18:42:25.166223 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m18:42:25.166223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203533F2600>]}
[0m18:42:25.169211 [info ] [MainThread]: 
[0m18:42:25.170211 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:42:25.171211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m18:42:25.171737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:26.528629 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m18:42:26.528629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:27.809590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020353A28680>]}
[0m18:42:27.809590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:27.809590 [info ] [MainThread]: 
[0m18:42:27.815686 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m18:42:27.815686 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m18:42:27.815686 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m18:42:27.820594 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m18:42:27.830037 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m18:42:27.830037 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m18:42:27.842878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:29.120607 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m18:42:29.120607 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    `dbt-437212`.`wellbefore`.`dim_all_columns` AS offers

-- JOIN 
--     dbt-437212.wellbefore.dim_summary_values AS summary
--     ON 
--         offers.NotificationId = summary.NotificationId
-- )

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m18:42:29.600681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:eb8507ff-77b3-44fe-be07-48f5fc1ccbd3&page=queryresults
[0m18:42:29.600681 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SELECT at [98:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword SELECT at [98:1]')
[0m18:42:30.273947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:758b1ea2-dfd8-4ea7-99ca-67ef009ffae1&page=queryresults
[0m18:42:30.289533 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:758b1ea2-dfd8-4ea7-99ca-67ef009ffae1&page=queryresults
[0m18:42:30.300050 [debug] [Thread-1 (]: Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got keyword SELECT at [98:1]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m18:42:30.300050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a843de-a9a2-45ab-a5ae-2b4eb56af125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033FB98B60>]}
[0m18:42:30.300050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wellbefore.variable_summary_table ........ [[31mERROR[0m in 2.48s]
[0m18:42:30.300050 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m18:42:30.304778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:30.305313 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m18:42:30.305313 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m18:42:30.305313 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m18:42:30.305313 [info ] [MainThread]: 
[0m18:42:30.305313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m18:42:30.307548 [debug] [MainThread]: Command end result
[0m18:42:30.331490 [info ] [MainThread]: 
[0m18:42:30.331490 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:42:30.331490 [info ] [MainThread]: 
[0m18:42:30.331490 [error] [MainThread]:   Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Syntax error: Expected ")" but got keyword SELECT at [98:1]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m18:42:30.331490 [info ] [MainThread]: 
[0m18:42:30.331490 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:42:30.331490 [debug] [MainThread]: Command `dbt run` failed at 18:42:30.331490 after 7.93 seconds
[0m18:42:30.331490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034031DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002035364BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002035368A600>]}
[0m18:42:30.342104 [debug] [MainThread]: Flushing usage events
[0m07:51:09.857654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025224587DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252245868A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025224587E30>]}


============================== 07:51:09.871783 | d2d1c552-66e3-4824-85f7-5a428aaa90fe ==============================
[0m07:51:09.871783 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:51:09.873290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select variable_summary_table', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:51:12.803891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252245FD220>]}
[0m07:51:12.867008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025234C28BC0>]}
[0m07:51:12.867008 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:51:12.884865 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:51:13.152843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:51:13.152843 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m07:51:13.431874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025237A0B590>]}
[0m07:51:13.557296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025237B24E90>]}
[0m07:51:13.557296 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m07:51:13.557296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252244C34D0>]}
[0m07:51:13.557296 [info ] [MainThread]: 
[0m07:51:13.557296 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:51:13.557296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m07:51:13.557296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:15.020792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m07:51:15.020792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:16.317893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523777AAE0>]}
[0m07:51:16.320090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:16.320090 [info ] [MainThread]: 
[0m07:51:16.337049 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m07:51:16.337049 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m07:51:16.337049 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m07:51:16.337049 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m07:51:16.346461 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m07:51:16.346461 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m07:51:16.360086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:51:17.606385 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m07:51:17.608002 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    `dbt-437212`.`wellbefore`.`dim_all_columns` AS offers

-- JOIN 
--     dbt-437212.wellbefore.dim_summary_values AS summary
--     ON 
--         offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m07:51:18.387909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:02ee8680-0802-4036-a848-216c89dbcf34&page=queryresults
[0m07:51:18.793741 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: summary at [30:9]; reason: invalidQuery, location: query, message: Unrecognized name: summary at [30:9]')
[0m07:51:19.719396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e4bef2d3-8b3e-4928-ba54-85f159b4e7c2&page=queryresults
[0m07:51:20.110309 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e4bef2d3-8b3e-4928-ba54-85f159b4e7c2&page=queryresults
[0m07:51:20.126841 [debug] [Thread-1 (]: Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Unrecognized name: summary at [30:9]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m07:51:20.126841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d1c552-66e3-4824-85f7-5a428aaa90fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025223CD8C80>]}
[0m07:51:20.126841 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wellbefore.variable_summary_table ........ [[31mERROR[0m in 3.79s]
[0m07:51:20.126841 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m07:51:20.138333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:20.138333 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m07:51:20.138333 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m07:51:20.138333 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m07:51:20.138333 [info ] [MainThread]: 
[0m07:51:20.138333 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m07:51:20.138333 [debug] [MainThread]: Command end result
[0m07:51:20.165738 [info ] [MainThread]: 
[0m07:51:20.165738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:51:20.165738 [info ] [MainThread]: 
[0m07:51:20.165738 [error] [MainThread]:   Database Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  Unrecognized name: summary at [30:9]
  compiled Code at target\run\buy_box_gcp_1\models\dim\variable_summary_table.sql
[0m07:51:20.165738 [info ] [MainThread]: 
[0m07:51:20.165738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:51:20.174250 [debug] [MainThread]: Command `dbt run` failed at 07:51:20.174250 after 10.50 seconds
[0m07:51:20.174250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252376C4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522418A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522418A390>]}
[0m07:51:20.174250 [debug] [MainThread]: Flushing usage events
[0m07:56:05.806826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3C12B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3BF3DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3C12BA40>]}


============================== 07:56:05.806826 | fbae8f01-c1aa-47ba-b8f1-3537a988d855 ==============================
[0m07:56:05.806826 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:56:05.806826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:56:07.213487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbae8f01-c1aa-47ba-b8f1-3537a988d855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F1D34D0>]}
[0m07:56:07.275996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbae8f01-c1aa-47ba-b8f1-3537a988d855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4D31F440>]}
[0m07:56:07.275996 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:56:07.294012 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:56:07.435523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:56:07.435523 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m07:56:07.621115 [error] [MainThread]: Encountered an error:
Compilation Error in model variable_summary_table (models\dim\variable_summary_table.sql)
  expected token ',', got '='
    line 2
      --     materialized='table'
[0m07:56:07.622088 [debug] [MainThread]: Command `dbt run` failed at 07:56:07.622088 after 2.02 seconds
[0m07:56:07.622088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3C12B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F515430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F5A4470>]}
[0m07:56:07.624301 [debug] [MainThread]: Flushing usage events
[0m07:56:55.462269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AFC908C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF8E26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AFC90E90>]}


============================== 07:56:55.462269 | 86dfb101-d3e8-4570-8270-049fc8d19528 ==============================
[0m07:56:55.462269 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:56:55.462269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:56:56.831600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD6C6A50>]}
[0m07:56:56.894688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C2B73020>]}
[0m07:56:56.894688 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:56:56.894688 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:56:57.066495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:56:57.066495 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp_1://models\dim\variable_summary_table.sql
[0m07:56:57.302415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C2D57440>]}
[0m07:56:57.397265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C2E5B140>]}
[0m07:56:57.407968 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m07:56:57.407968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C323C6B0>]}
[0m07:56:57.407968 [info ] [MainThread]: 
[0m07:56:57.412476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:56:57.412476 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m07:56:57.412476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:58.775976 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m07:56:58.775976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:59.997746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD72A930>]}
[0m07:56:59.997746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:00.013386 [info ] [MainThread]: 
[0m07:57:00.018938 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns
[0m07:57:00.018938 [info ] [Thread-1 (]: 1 of 16 START sql view model wellbefore.dim_all_columns ........................ [RUN]
[0m07:57:00.018938 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'
[0m07:57:00.022957 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns
[0m07:57:00.027138 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns"
[0m07:57:00.035410 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns
[0m07:57:00.107625 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns"
[0m07:57:00.107625 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:57:00.139614 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`

),



flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),



flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,



        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,



        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,



        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,



        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,



        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode



    FROM

        flatten_payload,

        UNNEST(offers) AS offer,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)



SELECT *

FROM flattened_payload;


[0m07:57:01.957226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:45759018-ad4d-40b0-b831-f1d365a235bf&page=queryresults
[0m07:57:02.978011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF3B8E30>]}
[0m07:57:02.978011 [info ] [Thread-1 (]: 1 of 16 OK created sql view model wellbefore.dim_all_columns ................... [[32mCREATE VIEW (0 processed)[0m in 2.96s]
[0m07:57:02.978011 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns
[0m07:57:02.978011 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m07:57:02.978011 [info ] [Thread-1 (]: 2 of 16 START sql view model wellbefore.dim_all_columns_1_month ................ [RUN]
[0m07:57:02.978011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.dim_all_columns_1_month)
[0m07:57:02.978011 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_1_month
[0m07:57:02.994698 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_1_month"
[0m07:57:02.994698 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_1_month
[0m07:57:02.994698 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns_1_month"
[0m07:57:02.994698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:03.036294 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns_1_month: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns_1_month"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_1_month`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        dbt-437212.wellbefore.B00KJ75ISS_1_month

),



flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,  -- Access the entire ListPrice object

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),



flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,



        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,



        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,



        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,



        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,



        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,



        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode



    FROM

        flatten_payload,

        UNNEST(offers) AS offer,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)



SELECT *

FROM flattened_payload;


[0m07:57:04.421036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:4d386f3c-8f86-4828-a285-8799aa818c06&page=queryresults
[0m07:57:05.434018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C32C6780>]}
[0m07:57:05.434018 [info ] [Thread-1 (]: 2 of 16 OK created sql view model wellbefore.dim_all_columns_1_month ........... [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m07:57:05.434018 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_1_month
[0m07:57:05.434018 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m07:57:05.434018 [info ] [Thread-1 (]: 3 of 16 START sql view model wellbefore.dim_all_columns_using_join ............. [RUN]
[0m07:57:05.434018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_1_month, now model.buy_box_gcp_1.dim_all_columns_using_join)
[0m07:57:05.434018 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_all_columns_using_join
[0m07:57:05.434018 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_all_columns_using_join"
[0m07:57:05.434018 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_all_columns_using_join
[0m07:57:05.450377 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_all_columns_using_join"
[0m07:57:05.450377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:05.486106 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_all_columns_using_join: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_all_columns_using_join"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_using_join`
  OPTIONS()
  as SELECT *
FROM dbt-437212.wellbefore.dim_offers_values AS offers
JOIN dbt-437212.wellbefore.dim_summary_values AS summary
ON 
    offers.ASIN = summary.ASIN 
    AND offers.EventTime = summary.EventTime;


[0m07:57:06.888344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:8336c3da-9e72-437f-a041-f6ca328fb68b&page=queryresults
[0m07:57:07.369476 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name EventTime at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name EventTime at [6:6]')
[0m07:57:08.389832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d4dfe3d4-b2a3-42eb-b291-8c5bfab989da&page=queryresults
[0m07:57:08.795473 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d4dfe3d4-b2a3-42eb-b291-8c5bfab989da&page=queryresults
[0m07:57:08.795473 [debug] [Thread-1 (]: Database Error in model dim_all_columns_using_join (models\dim\dim_all_columns_using_join.sql)
  CREATE VIEW has columns with duplicate name EventTime at [6:6]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns_using_join.sql
[0m07:57:08.795473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C32CC1D0>]}
[0m07:57:08.795473 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model wellbefore.dim_all_columns_using_join .... [[31mERROR[0m in 3.36s]
[0m07:57:08.795473 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_all_columns_using_join
[0m07:57:08.795473 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_offers_values
[0m07:57:08.806428 [info ] [Thread-1 (]: 4 of 16 START sql view model wellbefore.dim_offers_values ...................... [RUN]
[0m07:57:08.806428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_using_join, now model.buy_box_gcp_1.dim_offers_values)
[0m07:57:08.806428 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_offers_values
[0m07:57:08.808949 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_offers_values"
[0m07:57:08.808949 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_offers_values
[0m07:57:08.818004 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_offers_values"
[0m07:57:08.820037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:08.853337 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_offers_values: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_offers_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers


    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsBuyBoxWinner") AS BOOLEAN) AS IsBuyBoxWinner,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFeaturedMerchant") AS BOOLEAN) AS IsFeaturedMerchant,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.IsFulfilledByAmazon") AS BOOLEAN) AS IsFulfilledByAmazon,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.Amount") AS FLOAT64) AS ListingPriceAmount,

        JSON_EXTRACT_SCALAR(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferNationalPrime") AS BOOLEAN) AS IsOfferNationalPrime,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.PrimeInformation.IsOfferPrime") AS BOOLEAN) AS IsOfferPrime,

        JSON_EXTRACT_SCALAR(offer, "$.SellerId") AS SellerId,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.FeedbackCount") AS INT64) AS SellerFeedbackCount,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.SellerFeedbackRating.SellerPositiveFeedbackRating") AS INT64) AS SellerPositiveFeedbackRating,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.Shipping.Amount") AS FLOAT64) AS ShippingAmount,

        JSON_EXTRACT_SCALAR(offer, "$.Shipping.CurrencyCode") AS ShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.AvailabilityType") AS ShippingAvailabilityType,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MaximumHours") AS INT64) AS ShippingMaxHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShippingTime.MinimumHours") AS INT64) AS ShippingMinHours,

        CAST(JSON_EXTRACT_SCALAR(offer, "$.ShipsDomestically") AS BOOLEAN) AS ShipsDomestically,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.Country") AS ShipsFromCountry,

        JSON_EXTRACT_SCALAR(offer, "$.ShipsFrom.State") AS ShipsFromState,

        JSON_EXTRACT_SCALAR(offer, "$.SubCondition") AS SubCondition,


    FROM

        flatten_payload,

        UNNEST(offers) AS offer
)

SELECT *

FROM flattened_payload order by ASIN;


[0m07:57:10.259615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:56903356-698e-4d3e-adb7-eeb1e153ad08&page=queryresults
[0m07:57:11.169814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C468EF60>]}
[0m07:57:11.169814 [info ] [Thread-1 (]: 4 of 16 OK created sql view model wellbefore.dim_offers_values ................. [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m07:57:11.169814 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_offers_values
[0m07:57:11.169814 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.dim_summary_values
[0m07:57:11.169814 [info ] [Thread-1 (]: 5 of 16 START sql view model wellbefore.dim_summary_values ..................... [RUN]
[0m07:57:11.169814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_offers_values, now model.buy_box_gcp_1.dim_summary_values)
[0m07:57:11.169814 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.dim_summary_values
[0m07:57:11.169814 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.dim_summary_values"
[0m07:57:11.169814 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.dim_summary_values
[0m07:57:11.169814 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.dim_summary_values"
[0m07:57:11.169814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:11.219173 [debug] [Thread-1 (]: On model.buy_box_gcp_1.dim_summary_values: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.dim_summary_values"} */


  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`
  OPTIONS()
  as WITH source_data AS (

    SELECT

        JSON_EXTRACT(MESSAGE_BODY, "$") AS raw_data

    FROM

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`

),

flatten_payload AS (

    SELECT

        JSON_EXTRACT_SCALAR(raw_data, "$.EventTime") AS EventTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.ApplicationId") AS ApplicationId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.PublishTime")) AS PublishTime,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationMetadata.SubscriptionId") AS SubscriptionId,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationType") AS NotificationType,

        JSON_EXTRACT_SCALAR(raw_data, "$.NotificationVersion") AS NotificationVersion,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition") AS ItemCondition,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId") AS MarketplaceId,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType") AS OfferChangeType,

        JSON_EXTRACT_SCALAR(raw_data, "$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange") AS TimeOfOfferChange,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices") AS bbp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.LowestPrices") AS lop,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers") AS neo,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers") AS noo,

        JSON_EXTRACT(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.ListPrice") AS lp,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Summary.SalesRankings") AS sr

    FROM

        source_data

),

flattened_payload AS (

    SELECT

        EventTime,

        ApplicationId,

        NotificationId,

        PublishTime,

        SubscriptionId,

        NotificationType,

        NotificationVersion,

        ASIN,

        ItemCondition,

        MarketplaceId,

        OfferChangeType,

        TimeOfOfferChange,

        JSON_EXTRACT_SCALAR(bbp, "$.Condition") AS BuyBoxPricesCondition,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.Amount") AS FLOAT64) AS BuyBoxLandedPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.LandedPrice.CurrencyCode") AS BuyBoxLandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.Amount") AS FLOAT64) AS BuyBoxListingPriceAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.ListingPrice.CurrencyCode") AS BuyBoxListingPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(bbp, "$.Shipping.Amount") AS FLOAT64) AS BuyBoxShippingAmount,

        JSON_EXTRACT_SCALAR(bbp, "$.Shipping.CurrencyCode") AS BuyBoxShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(lop, "$.Condition") AS LowestPricesCondition,

        JSON_EXTRACT_SCALAR(lop, "$.FulfillmentChannel") AS LowestPricesFulfillmentChannel,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.Amount") AS FLOAT64) AS LandedPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.LandedPrice.CurrencyCode") AS LandedPriceCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.Amount") AS FLOAT64) AS LowestPricesListingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.ListingPrice.CurrencyCode") AS LowestPricesListingCurrencyCode,

        CAST(JSON_EXTRACT_SCALAR(lop, "$.Shipping.Amount") AS FLOAT64) AS LowestPricesShippingPriceAmount,

        JSON_EXTRACT_SCALAR(lop, "$.Shipping.CurrencyCode") AS LowestPricesShippingCurrencyCode,

        JSON_EXTRACT_SCALAR(neo, "$.Condition") AS BuyBoxEligibleOffersCondition,

        JSON_EXTRACT_SCALAR(neo, "$.FulfillmentChannel") AS BuyBoxEligibleOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(neo, "$.OfferCount") AS BuyBoxEligibleOffersCount,

        JSON_EXTRACT_SCALAR(noo, "$.Condition") AS NumberOfOffersCondition,

        JSON_EXTRACT_SCALAR(noo, "$.FulfillmentChannel") AS NumberOfOffersFulfillmentChannel,

        JSON_EXTRACT_SCALAR(noo, "$.OfferCount") AS NumberOfOffersCount,

        JSON_EXTRACT_SCALAR(sr, "$.ProductCategoryId") AS SalesRankingsProductCategoryId,

        CAST(JSON_EXTRACT_SCALAR(sr, "$.Rank") AS INT64) AS SalesRankingsRank,

        CAST(JSON_EXTRACT_SCALAR(lp, "$.Amount") AS FLOAT64) AS ListPriceAmount,

        JSON_EXTRACT_SCALAR(lp, "$.CurrencyCode") AS ListPriceCurrencyCode

    FROM

        flatten_payload,

        UNNEST(bbp) AS bbp,

        UNNEST(lop) AS lop,

        UNNEST(neo) AS neo,

        UNNEST(noo) AS noo,

        UNNEST(sr) AS sr

)

SELECT *

FROM flattened_payload;


[0m07:57:12.599851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:5014eded-a7ef-4290-9bb8-d02d36f3a860&page=queryresults
[0m07:57:13.626498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47797F0>]}
[0m07:57:13.626498 [info ] [Thread-1 (]: 5 of 16 OK created sql view model wellbefore.dim_summary_values ................ [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m07:57:13.626498 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.dim_summary_values
[0m07:57:13.626498 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.fct_sellers
[0m07:57:13.626498 [info ] [Thread-1 (]: 6 of 16 START sql view model wellbefore.fct_sellers ............................ [RUN]
[0m07:57:13.626498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_summary_values, now model.buy_box_gcp_1.fct_sellers)
[0m07:57:13.626498 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.fct_sellers
[0m07:57:13.626498 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.fct_sellers"
[0m07:57:13.626498 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.fct_sellers
[0m07:57:13.626498 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.fct_sellers"
[0m07:57:13.626498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:13.670277 [debug] [Thread-1 (]: On model.buy_box_gcp_1.fct_sellers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.fct_sellers"} */


  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data
),

flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),

flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)

SELECT 
    EventTime,
    SellerId,
    CASE 
        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'
        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'
        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'
        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'
        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'
        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'
        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'
        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'
        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'
        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'
        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'
        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'
        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'
        ELSE 'Unknown Seller'
    END AS SellerName,
    IsFeaturedMerchant,
    IsFulfilledByAmazon
FROM 
    flattened_offers
ORDER BY 
    SellerId;


[0m07:57:14.945697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c431bd6f-62b8-4678-a463-e377808f8a87&page=queryresults
[0m07:57:15.877322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C475C230>]}
[0m07:57:15.877322 [info ] [Thread-1 (]: 6 of 16 OK created sql view model wellbefore.fct_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m07:57:15.877322 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.fct_sellers
[0m07:57:15.877322 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_buybox_offers
[0m07:57:15.877322 [info ] [Thread-1 (]: 7 of 16 START sql table model wellbefore.src_buybox_offers ..................... [RUN]
[0m07:57:15.877322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.fct_sellers, now model.buy_box_gcp_1.src_buybox_offers)
[0m07:57:15.877322 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_buybox_offers
[0m07:57:15.889025 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_buybox_offers"
[0m07:57:15.890565 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_buybox_offers
[0m07:57:15.902516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:17.061171 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_buybox_offers"
[0m07:57:17.061171 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_buybox_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices

    FROM source_data

),

flatten_data_1 AS (

    SELECT

        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,

        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,

        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,



        JSON_VALUE(noo.Condition)AS NumberOfferCondition,

        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,

        JSON_VALUE(noo.OfferCount)AS NumberOfferCount

    FROM flatten_data,

        UNNEST(buyboxprices) AS bop,

        UNNEST(numberOfOffers) AS noo

)



SELECT * FROM flatten_data_1
    );
  
[0m07:57:17.824466 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e3a50210-f741-4a5b-8d89-2aec3125ccb6&page=queryresults
[0m07:57:20.730210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C4778DD0>]}
[0m07:57:20.730210 [info ] [Thread-1 (]: 7 of 16 OK created sql table model wellbefore.src_buybox_offers ................ [[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)[0m in 4.85s]
[0m07:57:20.730210 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_buybox_offers
[0m07:57:20.735365 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m07:57:20.735365 [info ] [Thread-1 (]: 8 of 16 START sql table model wellbefore.src_notification_lowest_prices ........ [RUN]
[0m07:57:20.735365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)
[0m07:57:20.736877 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices
[0m07:57:20.736877 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m07:57:20.736877 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_lowest_prices
[0m07:57:20.742092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:22.015436 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_lowest_prices"
[0m07:57:22.015436 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_lowest_prices"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices

    FROM source_data

),

flatten_data_1 AS (

    SELECT

        NotificationId,

        JSON_VALUE(lp.Condition)AS Condition,

        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,



        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,

        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,



        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,

        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,



        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,

    FROM flatten_data,

        UNNEST(lowestPrices) AS lp

)



SELECT * FROM flatten_data_1
    );
  
[0m07:57:22.940048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:76154b91-c489-4057-b210-da5640db6678&page=queryresults
[0m07:57:25.808855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C46A03B0>]}
[0m07:57:25.808855 [info ] [Thread-1 (]: 8 of 16 OK created sql table model wellbefore.src_notification_lowest_prices ... [[32mCREATE TABLE (28.0 rows, 120.8 KiB processed)[0m in 5.07s]
[0m07:57:25.808855 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_lowest_prices
[0m07:57:25.808855 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notification_summary
[0m07:57:25.808855 [info ] [Thread-1 (]: 9 of 16 START sql table model wellbefore.src_notification_summary .............. [RUN]
[0m07:57:25.808855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)
[0m07:57:25.808855 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notification_summary
[0m07:57:25.808855 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notification_summary"
[0m07:57:25.808855 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notification_summary
[0m07:57:25.827025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:27.035485 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notification_summary"
[0m07:57:27.035485 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notification_summary"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,

        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,

        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice



    FROM source_data

),

flatten_data_1 AS (

    SELECT

        NotificationId,

        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,

        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,



        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,

        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        

        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,

        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,



        ListPriceAmount

        

    FROM flatten_data,

        UNNEST(buyboxprice) AS bp

)



SELECT * FROM flatten_data_1
    );
  
[0m07:57:27.752045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2608a884-6f1d-4f5c-9ea1-11a4c586858c&page=queryresults
[0m07:57:30.624420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C475C230>]}
[0m07:57:30.624420 [info ] [Thread-1 (]: 9 of 16 OK created sql table model wellbefore.src_notification_summary ......... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.82s]
[0m07:57:30.624420 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notification_summary
[0m07:57:30.624420 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_notifications
[0m07:57:30.624420 [info ] [Thread-1 (]: 10 of 16 START sql table model wellbefore.src_notifications .................... [RUN]
[0m07:57:30.624420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)
[0m07:57:30.624420 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_notifications
[0m07:57:30.643539 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_notifications"
[0m07:57:30.645092 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_notifications
[0m07:57:30.647185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:31.850545 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_notifications"
[0m07:57:31.850545 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_notifications"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

        PARSE_JSON(data.message_body).Payload AS offer

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,

        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,

        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,

        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,

        JSON_VALUE(raw_data.NotificationType) AS NotificationType,

        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,

        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,

FROM source_data

)



SELECT * FROM flatten_data
    );
  
[0m07:57:32.566975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:766c47a7-6a57-41a5-bd4b-2272bc1945c1&page=queryresults
[0m07:57:37.476879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47810A0>]}
[0m07:57:37.476879 [info ] [Thread-1 (]: 10 of 16 OK created sql table model wellbefore.src_notifications ............... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 6.85s]
[0m07:57:37.492530 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_notifications
[0m07:57:37.492530 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offer_change_trigger
[0m07:57:37.492530 [info ] [Thread-1 (]: 11 of 16 START sql table model wellbefore.src_offer_change_trigger ............. [RUN]
[0m07:57:37.492530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)
[0m07:57:37.492530 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offer_change_trigger
[0m07:57:37.492530 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m07:57:37.492530 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offer_change_trigger
[0m07:57:37.501006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:38.709111 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offer_change_trigger"
[0m07:57:38.709111 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offer_change_trigger"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT

        PARSE_JSON(data.message_body) AS raw_data,

        PARSE_JSON(data.message_body).Payload AS offer

    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,

        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,

        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,

    FROM source_data

)

 

SELECT * FROM flatten_data
    );
  
[0m07:57:39.396643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e8eef358-8edb-4434-9b2b-c805dd14458a&page=queryresults
[0m07:57:41.978265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47810A0>]}
[0m07:57:41.993923 [info ] [Thread-1 (]: 11 of 16 OK created sql table model wellbefore.src_offer_change_trigger ........ [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.49s]
[0m07:57:41.993923 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offer_change_trigger
[0m07:57:41.993923 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m07:57:41.993923 [info ] [Thread-1 (]: 12 of 16 START sql table model wellbefore.src_offers ........................... [RUN]
[0m07:57:41.993923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)
[0m07:57:41.993923 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m07:57:41.993923 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m07:57:41.993923 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m07:57:41.993923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:43.216178 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m07:57:43.216178 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data

),

flatten_data AS (

    SELECT

        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer

    FROM source_data

),

flatten_data_1 AS (

    SELECT

        NotificationId,

        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,

        ASIN,

        JSON_VALUE(offer, "$.SellerId") AS SellerId,

        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,

        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,

        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,

        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation

    FROM flatten_data,

    UNNEST(offer) AS offer

)



SELECT * 

FROM flatten_data_1
    );
  
[0m07:57:43.928439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7334c199-2631-45c3-8ad4-2629ffc5e6d7&page=queryresults
[0m07:57:46.900527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47BBF80>]}
[0m07:57:46.900527 [info ] [Thread-1 (]: 12 of 16 OK created sql table model wellbefore.src_offers ...................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.91s]
[0m07:57:46.900527 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m07:57:46.900527 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_products
[0m07:57:46.900527 [info ] [Thread-1 (]: 13 of 16 START sql table model wellbefore.src_products ......................... [RUN]
[0m07:57:46.900527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)
[0m07:57:46.900527 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_products
[0m07:57:46.919671 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_products"
[0m07:57:46.921728 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_products
[0m07:57:46.921728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:48.123827 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_products"
[0m07:57:48.123827 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_products: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_products"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_products`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data,

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_data AS (

    SELECT

        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,

        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId

    FROM source_data

)

SELECT * FROM flatten_data
    );
  
[0m07:57:48.849694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:46bd6469-e4b7-44a2-82d9-2c5d5262b845&page=queryresults
[0m07:57:51.615937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47D35F0>]}
[0m07:57:51.615937 [info ] [Thread-1 (]: 13 of 16 OK created sql table model wellbefore.src_products .................... [[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)[0m in 4.72s]
[0m07:57:51.615937 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_products
[0m07:57:51.615937 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_sales_ranking
[0m07:57:51.618956 [info ] [Thread-1 (]: 14 of 16 START sql table model wellbefore.src_sales_ranking .................... [RUN]
[0m07:57:51.618956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)
[0m07:57:51.618956 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_sales_ranking
[0m07:57:51.618956 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_sales_ranking"
[0m07:57:51.618956 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_sales_ranking
[0m07:57:51.630970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:52.842900 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_sales_ranking"
[0m07:57:52.842900 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_sales_ranking"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,

      PARSE_JSON(data.message_body) as parse_data

    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_payload AS (

    SELECT 

        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,

        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings

    FROM source_data

),

flatten_offers AS (

    SELECT 

        GENERATE_UUID() as SurrogateKey,

        ASIN,

        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,

        JSON_EXTRACT(sr, '$.Rank') AS Ranking

    FROM flatten_payload, UNNEST(SalesRankings) AS sr 

)

SELECT * FROM flatten_offers
    );
  
[0m07:57:53.457280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:bc2b7d9f-f89b-459f-94a2-a680cb6ca88d&page=queryresults
[0m07:57:56.316219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47D1850>]}
[0m07:57:56.316219 [info ] [Thread-1 (]: 14 of 16 OK created sql table model wellbefore.src_sales_ranking ............... [[32mCREATE TABLE (43.0 rows, 120.8 KiB processed)[0m in 4.70s]
[0m07:57:56.331680 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_sales_ranking
[0m07:57:56.331680 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_shipping
[0m07:57:56.331680 [info ] [Thread-1 (]: 15 of 16 START sql table model wellbefore.src_shipping ......................... [RUN]
[0m07:57:56.331680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_shipping)
[0m07:57:56.331680 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_shipping
[0m07:57:56.331680 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_shipping"
[0m07:57:56.331680 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_shipping
[0m07:57:56.331680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:57.546517 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_shipping"
[0m07:57:57.546517 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_shipping"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`
      
    
    

    OPTIONS()
    as (
      -- WITH source_data AS (

--     SELECT 

--         PARSE_JSON(data.message_body) AS raw_data,

--     FROM 

--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data

-- ),

-- flatten_data AS (

--     SELECT

--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,

--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers

--     FROM source_data

-- )

-- SELECT

--     NotificationId,

--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,

--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,

--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,

--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,

--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,

--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,

-- FROM

--     flatten_data, UNNEST(offers) AS offers



WITH source_data AS (

    SELECT 

      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,

      PARSE_JSON(data.message_body) as parse_data

    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data

),

flatten_payload AS (

    SELECT 

        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,

        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers

    FROM source_data

),

flatten_offers AS (

    SELECT 

        GENERATE_UUID() as SurrogateKey,

        NotificationId,

        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,

        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,

        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,

        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,

        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,

        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,

        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically



    FROM flatten_payload, UNNEST(offers) AS offer 

)

SELECT * FROM flatten_offers
    );
  
[0m07:57:58.365671 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a79a7c76-cb95-428e-b780-6297f79a851e&page=queryresults
[0m07:58:01.232184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C47D1CA0>]}
[0m07:58:01.232184 [info ] [Thread-1 (]: 15 of 16 OK created sql table model wellbefore.src_shipping .................... [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.90s]
[0m07:58:01.232184 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_shipping
[0m07:58:01.232184 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m07:58:01.247809 [info ] [Thread-1 (]: 16 of 16 START sql table model wellbefore.variable_summary_table ............... [RUN]
[0m07:58:01.247809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_shipping, now model.buy_box_gcp_1.variable_summary_table)
[0m07:58:01.247809 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m07:58:01.247809 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m07:58:01.247809 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m07:58:01.247809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:02.462992 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m07:58:02.477510 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    `dbt-437212`.`wellbefore`.`dim_all_columns` AS offers

LEFT JOIN 
        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary
    ON 
        offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m07:58:03.269589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:367e5474-5dfe-4012-b9d4-760f038c5858&page=queryresults
[0m07:58:11.288992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfb101-d3e8-4570-8270-049fc8d19528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AC115700>]}
[0m07:58:11.290415 [info ] [Thread-1 (]: 16 of 16 OK created sql table model wellbefore.variable_summary_table .......... [[32mCREATE TABLE (43.8k rows, 120.8 KiB processed)[0m in 10.04s]
[0m07:58:11.291489 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m07:58:11.292510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:11.293541 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m07:58:11.293541 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m07:58:11.294751 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m07:58:11.294751 [info ] [MainThread]: 
[0m07:58:11.295761 [info ] [MainThread]: Finished running 6 view models, 10 table models in 0 hours 1 minutes and 13.88 seconds (73.88s).
[0m07:58:11.304511 [debug] [MainThread]: Command end result
[0m07:58:11.339519 [info ] [MainThread]: 
[0m07:58:11.339519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:58:11.339519 [info ] [MainThread]: 
[0m07:58:11.339519 [error] [MainThread]:   Database Error in model dim_all_columns_using_join (models\dim\dim_all_columns_using_join.sql)
  CREATE VIEW has columns with duplicate name EventTime at [6:6]
  compiled Code at target\run\buy_box_gcp_1\models\dim\dim_all_columns_using_join.sql
[0m07:58:11.339519 [info ] [MainThread]: 
[0m07:58:11.339519 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m07:58:11.339519 [debug] [MainThread]: Command `dbt run` failed at 07:58:11.339519 after 76.02 seconds
[0m07:58:11.339519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF8E26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C309E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD85DA00>]}
[0m07:58:11.352130 [debug] [MainThread]: Flushing usage events
[0m08:01:30.699061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026647F85F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026647F85640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026647F86180>]}


============================== 08:01:30.699061 | 3a3651ac-cedb-43e1-a713-c4fa451b60b1 ==============================
[0m08:01:30.699061 [info ] [MainThread]: Running with dbt=1.8.8
[0m08:01:30.699061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select variable_summary_table', 'send_anonymous_usage_stats': 'True'}
[0m08:01:31.978560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026648406360>]}
[0m08:01:32.042577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665A7A0BC0>]}
[0m08:01:32.056186 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:01:32.056186 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m08:01:32.195536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:32.195536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:32.226692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665B5589B0>]}
[0m08:01:32.321253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026645F73680>]}
[0m08:01:32.321253 [info ] [MainThread]: Found 16 models, 2 seeds, 2 sources, 478 macros
[0m08:01:32.321253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665B7D48C0>]}
[0m08:01:32.321253 [info ] [MainThread]: 
[0m08:01:32.321253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:01:32.321253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m08:01:32.321253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:33.623898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m08:01:33.628682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:34.863261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665B55B4D0>]}
[0m08:01:34.866583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:34.866583 [info ] [MainThread]: 
[0m08:01:34.866583 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.variable_summary_table
[0m08:01:34.866583 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.variable_summary_table ................. [RUN]
[0m08:01:34.866583 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.variable_summary_table'
[0m08:01:34.866583 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.variable_summary_table
[0m08:01:34.881563 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.variable_summary_table"
[0m08:01:34.881563 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.variable_summary_table
[0m08:01:34.892092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:01:36.092545 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.variable_summary_table"
[0m08:01:36.092545 [debug] [Thread-1 (]: On model.buy_box_gcp_1.variable_summary_table: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.variable_summary_table"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`
      
    
    

    OPTIONS()
    as (
      

WITH base AS (
    SELECT 
        offers.ASIN,
        offers.SELLERID,
        offers.NOTIFICATIONID,
        offers.ISBUYBOXWINNER,
        offers.ISOFFERPRIME,
        offers.SHIPSDOMESTICALLY,
        offers.PUBLISHTIME,
        offers.LISTINGPRICEAMOUNT,
        offers.SELLERFEEDBACKCOUNT,
        offers.SELLERPOSITIVEFEEDBACKRATING,
        offers.SHIPPINGAMOUNT,
        offers.SHIPPINGMINHOURS,
        offers.SHIPPINGMAXHOURS,
        summary.BUYBOXLISTINGPRICEAMOUNT,

        -- Difference between seller's listing price and mean listing price at publish time.
        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,
        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,

        -- Difference between seller's listing price and lowest listing price at publish time.
        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,
        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,

        -- Difference between seller's average shipping hours and mean average hours at publish time.
        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,

        -- Difference between seller's average shipping hours and lowest average hours at publish time.
        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,
        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,
        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,

        -- Difference between seller's feedback count and mean feedback count at publish time.
        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,

        -- Difference between seller's feedback count and highest feedback count at publish time.
        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,
        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,

        -- Difference between seller's feedback rating and mean feedback rating at publish time.
        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,

        -- Difference between seller's feedback rating and highest feedback rating at publish time.
        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,
        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,

        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).
        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,

        -- Ratio of seller's rating to their listing price (rating per dollar).
        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,

        -- Ratio of seller's feedback count to their listing price (feedback per dollar).
        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,

        -- Ratio between seller's current listing price and their BuyBox listing price.
        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,

        -- Total number of assessments or reviews the product has received from customers.
        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,

        -- Indicates if the seller is domestic (1=True, 0=False).
        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,

        -- Cost of shipping the product offered by the seller.
        offers.ShippingAmount AS shipping_price,

        -- Estimated shipping time (in hours).
        offers.ShippingMaxHours AS shipping_time_in_hours

    FROM 
    `dbt-437212`.`wellbefore`.`dim_offers_values` AS offers

LEFT JOIN 
        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary
    ON 
        offers.NotificationId = summary.NotificationId
)

SELECT * FROM base
ORDER BY ASIN
    );
  
[0m08:01:36.996959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:264cedbd-6332-46a9-b0b9-cbbd1c200946&page=queryresults
[0m08:01:41.330338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3651ac-cedb-43e1-a713-c4fa451b60b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665AE4BB30>]}
[0m08:01:41.330872 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wellbefore.variable_summary_table ............ [[32mCREATE TABLE (2.1k rows, 120.8 KiB processed)[0m in 6.46s]
[0m08:01:41.332454 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.variable_summary_table
[0m08:01:41.334566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:41.335085 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m08:01:41.335602 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m08:01:41.335602 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.
[0m08:01:41.336120 [info ] [MainThread]: 
[0m08:01:41.337166 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m08:01:41.338897 [debug] [MainThread]: Command end result
[0m08:01:41.384643 [info ] [MainThread]: 
[0m08:01:41.392086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:41.393517 [info ] [MainThread]: 
[0m08:01:41.393517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:01:41.393517 [debug] [MainThread]: Command `dbt run` succeeded at 08:01:41.393517 after 10.86 seconds
[0m08:01:41.393517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002664838AAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026645F5D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002665B4F6D80>]}
[0m08:01:41.393517 [debug] [MainThread]: Flushing usage events
[0m08:02:31.044512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021342A23080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021342A23170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213428AE0F0>]}


============================== 08:02:31.044512 | d457833b-049e-425a-8fae-c35b799ddab0 ==============================
[0m08:02:31.044512 [info ] [MainThread]: Running with dbt=1.8.8
[0m08:02:31.044512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:31.079856 [info ] [MainThread]: dbt version: 1.8.8
[0m08:02:31.079856 [info ] [MainThread]: python version: 3.12.6
[0m08:02:31.079856 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m08:02:31.079856 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m08:02:32.379421 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1
[0m08:02:32.379421 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1\profiles.yml
[0m08:02:32.379421 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1\dbt_project.yml
[0m08:02:32.379421 [info ] [MainThread]: adapter type: bigquery
[0m08:02:32.391765 [info ] [MainThread]: adapter version: 1.8.3
[0m08:02:32.503412 [info ] [MainThread]: Configuration:
[0m08:02:32.503412 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:02:32.503412 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:02:32.503412 [info ] [MainThread]: Required dependencies:
[0m08:02:32.503412 [debug] [MainThread]: Executing "git --help"
[0m08:02:32.560781 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:02:32.562791 [debug] [MainThread]: STDERR: "b''"
[0m08:02:32.562791 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:02:32.562791 [info ] [MainThread]: Connection:
[0m08:02:32.562791 [info ] [MainThread]:   method: service-account
[0m08:02:32.562791 [info ] [MainThread]:   database: dbt-437212
[0m08:02:32.562791 [info ] [MainThread]:   execution_project: dbt-437212
[0m08:02:32.562791 [info ] [MainThread]:   schema: wellbefore
[0m08:02:32.562791 [info ] [MainThread]:   location: US
[0m08:02:32.562791 [info ] [MainThread]:   priority: interactive
[0m08:02:32.562791 [info ] [MainThread]:   maximum_bytes_billed: None
[0m08:02:32.562791 [info ] [MainThread]:   impersonate_service_account: None
[0m08:02:32.562791 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m08:02:32.562791 [info ] [MainThread]:   job_retries: 1
[0m08:02:32.562791 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m08:02:32.562791 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m08:02:32.562791 [info ] [MainThread]:   timeout_seconds: 300
[0m08:02:32.562791 [info ] [MainThread]:   client_id: None
[0m08:02:32.562791 [info ] [MainThread]:   token_uri: None
[0m08:02:32.573302 [info ] [MainThread]:   dataproc_region: None
[0m08:02:32.573302 [info ] [MainThread]:   dataproc_cluster_name: None
[0m08:02:32.573302 [info ] [MainThread]:   gcs_bucket: None
[0m08:02:32.575131 [info ] [MainThread]:   dataproc_batch: None
[0m08:02:32.575131 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:02:32.578300 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m08:02:32.578300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:02:32.637329 [debug] [MainThread]: On debug: select 1 as id
[0m08:02:34.085269 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:b09e6365-423a-422e-9d01-c16385a5dc33&page=queryresults
[0m08:02:35.057455 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:02:35.057455 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:02:35.057455 [debug] [MainThread]: Command `dbt debug` succeeded at 08:02:35.057455 after 4.17 seconds
[0m08:02:35.069468 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:02:35.069468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021355BD84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021355B3C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021355B71640>]}
[0m08:02:35.069468 [debug] [MainThread]: Flushing usage events
[0m15:33:59.622415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8FB71D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8FB71D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8FB712B0>]}


============================== 15:33:59.636599 | c425da83-99ae-4afd-bcf1-4dd4e1631e08 ==============================
[0m15:33:59.636599 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:33:59.637693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:33:59.654282 [info ] [MainThread]: dbt version: 1.8.8
[0m15:33:59.655117 [info ] [MainThread]: python version: 3.12.6
[0m15:33:59.656168 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m15:33:59.657142 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:34:00.907134 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1
[0m15:34:00.908130 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1\profiles.yml
[0m15:34:00.909128 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\buy_box_gcp_1\dbt_project.yml
[0m15:34:00.910193 [info ] [MainThread]: adapter type: bigquery
[0m15:34:00.910193 [info ] [MainThread]: adapter version: 1.8.3
[0m15:34:01.011218 [info ] [MainThread]: Configuration:
[0m15:34:01.012217 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:34:01.012217 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:34:01.013220 [info ] [MainThread]: Required dependencies:
[0m15:34:01.014218 [debug] [MainThread]: Executing "git --help"
[0m15:34:01.057843 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:34:01.059357 [debug] [MainThread]: STDERR: "b''"
[0m15:34:01.059357 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:34:01.060370 [info ] [MainThread]: Connection:
[0m15:34:01.060370 [info ] [MainThread]:   method: service-account
[0m15:34:01.061370 [info ] [MainThread]:   database: dbt-437212
[0m15:34:01.062367 [info ] [MainThread]:   execution_project: dbt-437212
[0m15:34:01.062367 [info ] [MainThread]:   schema: wellbefore
[0m15:34:01.063364 [info ] [MainThread]:   location: US
[0m15:34:01.063364 [info ] [MainThread]:   priority: interactive
[0m15:34:01.064365 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:34:01.064365 [info ] [MainThread]:   impersonate_service_account: None
[0m15:34:01.065363 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:34:01.065363 [info ] [MainThread]:   job_retries: 1
[0m15:34:01.066363 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:34:01.066363 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:34:01.066363 [info ] [MainThread]:   timeout_seconds: 300
[0m15:34:01.067364 [info ] [MainThread]:   client_id: None
[0m15:34:01.067364 [info ] [MainThread]:   token_uri: None
[0m15:34:01.067364 [info ] [MainThread]:   dataproc_region: None
[0m15:34:01.068363 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:34:01.069371 [info ] [MainThread]:   gcs_bucket: None
[0m15:34:01.069893 [info ] [MainThread]:   dataproc_batch: None
[0m15:34:01.070906 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:34:01.071942 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:34:01.072915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:01.110938 [debug] [MainThread]: On debug: select 1 as id
[0m15:34:03.322388 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e2d9a7b7-7be2-4b75-a6d1-d543779ce557&page=queryresults
[0m15:34:04.247430 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:34:04.248437 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:34:04.250962 [debug] [MainThread]: Command `dbt debug` succeeded at 15:34:04.250962 after 4.78 seconds
[0m15:34:04.250962 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:34:04.252052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2CA3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F433AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8EFE80B0>]}
[0m15:34:04.252052 [debug] [MainThread]: Flushing usage events
[0m07:40:20.659774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6C397B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6C61DBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6C375BE60>]}


============================== 07:40:20.659774 | 479daea0-2197-4fc9-a5da-f74efde308a4 ==============================
[0m07:40:20.659774 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:40:20.659774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:40:20.674887 [info ] [MainThread]: dbt version: 1.8.8
[0m07:40:20.674887 [info ] [MainThread]: python version: 3.12.6
[0m07:40:20.674887 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m07:40:20.674887 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m07:40:21.820652 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1
[0m07:40:21.820652 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1\profiles.yml
[0m07:40:21.820652 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1\dbt_project.yml
[0m07:40:21.820652 [info ] [MainThread]: adapter type: bigquery
[0m07:40:21.820652 [info ] [MainThread]: adapter version: 1.8.3
[0m07:40:21.909470 [info ] [MainThread]: Configuration:
[0m07:40:21.909470 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:40:21.909470 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:40:21.909470 [info ] [MainThread]: Required dependencies:
[0m07:40:21.909470 [debug] [MainThread]: Executing "git --help"
[0m07:40:21.964972 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:40:21.964972 [debug] [MainThread]: STDERR: "b''"
[0m07:40:21.964972 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:40:21.964972 [info ] [MainThread]: Connection:
[0m07:40:21.964972 [info ] [MainThread]:   method: service-account
[0m07:40:21.964972 [info ] [MainThread]:   database: dbt-437212
[0m07:40:21.964972 [info ] [MainThread]:   execution_project: dbt-437212
[0m07:40:21.964972 [info ] [MainThread]:   schema: wellbefore
[0m07:40:21.964972 [info ] [MainThread]:   location: US
[0m07:40:21.974958 [info ] [MainThread]:   priority: interactive
[0m07:40:21.975966 [info ] [MainThread]:   maximum_bytes_billed: None
[0m07:40:21.976550 [info ] [MainThread]:   impersonate_service_account: None
[0m07:40:21.977404 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m07:40:21.978413 [info ] [MainThread]:   job_retries: 1
[0m07:40:21.978413 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m07:40:21.979411 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m07:40:21.980411 [info ] [MainThread]:   timeout_seconds: 300
[0m07:40:21.980411 [info ] [MainThread]:   client_id: None
[0m07:40:21.981413 [info ] [MainThread]:   token_uri: None
[0m07:40:21.982409 [info ] [MainThread]:   dataproc_region: None
[0m07:40:21.982409 [info ] [MainThread]:   dataproc_cluster_name: None
[0m07:40:21.983229 [info ] [MainThread]:   gcs_bucket: None
[0m07:40:21.984236 [info ] [MainThread]:   dataproc_batch: None
[0m07:40:21.984236 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:40:21.985258 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m07:40:21.985258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:40:21.986254 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-d8b5c64d8b36.json''
[0m07:40:21.986254 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:40:21.987144 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:40:21.987144 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: 'C:/Users/SAILS-DM204/OneDrive - Sails Software Solutions Pvt Ltd/Desktop/Junk Folder/DBT/dbt-437212-d8b5c64d8b36.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:40:21.990097 [debug] [MainThread]: Command `dbt debug` failed at 07:40:21.990097 after 1.46 seconds
[0m07:40:21.990097 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:40:21.990097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6C397B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6D90AE240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6D8F6A840>]}
[0m07:40:21.991096 [debug] [MainThread]: Flushing usage events
[0m07:40:38.064963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6480E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6480E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6480DBB0>]}


============================== 07:40:38.064963 | bda90f99-6829-4e06-bad7-2699aac0ba69 ==============================
[0m07:40:38.064963 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:40:38.064963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:40:38.096228 [info ] [MainThread]: dbt version: 1.8.8
[0m07:40:38.096228 [info ] [MainThread]: python version: 3.12.6
[0m07:40:38.097993 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m07:40:38.098731 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m07:40:39.396794 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1
[0m07:40:39.396794 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1\profiles.yml
[0m07:40:39.396794 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\New folder\gcp_dagster\buy_box_gcp_1\dbt_project.yml
[0m07:40:39.396794 [info ] [MainThread]: adapter type: bigquery
[0m07:40:39.396794 [info ] [MainThread]: adapter version: 1.8.3
[0m07:40:39.522888 [info ] [MainThread]: Configuration:
[0m07:40:39.522888 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:40:39.522888 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:40:39.522888 [info ] [MainThread]: Required dependencies:
[0m07:40:39.522888 [debug] [MainThread]: Executing "git --help"
[0m07:40:39.592599 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:40:39.592599 [debug] [MainThread]: STDERR: "b''"
[0m07:40:39.592599 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:40:39.592599 [info ] [MainThread]: Connection:
[0m07:40:39.592599 [info ] [MainThread]:   method: service-account
[0m07:40:39.592599 [info ] [MainThread]:   database: dbt-437212
[0m07:40:39.592599 [info ] [MainThread]:   execution_project: dbt-437212
[0m07:40:39.592599 [info ] [MainThread]:   schema: wellbefore
[0m07:40:39.592599 [info ] [MainThread]:   location: US
[0m07:40:39.592599 [info ] [MainThread]:   priority: interactive
[0m07:40:39.592599 [info ] [MainThread]:   maximum_bytes_billed: None
[0m07:40:39.592599 [info ] [MainThread]:   impersonate_service_account: None
[0m07:40:39.592599 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m07:40:39.602722 [info ] [MainThread]:   job_retries: 1
[0m07:40:39.602722 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m07:40:39.603733 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m07:40:39.604730 [info ] [MainThread]:   timeout_seconds: 300
[0m07:40:39.604730 [info ] [MainThread]:   client_id: None
[0m07:40:39.605729 [info ] [MainThread]:   token_uri: None
[0m07:40:39.606729 [info ] [MainThread]:   dataproc_region: None
[0m07:40:39.606729 [info ] [MainThread]:   dataproc_cluster_name: None
[0m07:40:39.607630 [info ] [MainThread]:   gcs_bucket: None
[0m07:40:39.608546 [info ] [MainThread]:   dataproc_batch: None
[0m07:40:39.609060 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:40:39.609060 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m07:40:39.609060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:40:39.675988 [debug] [MainThread]: On debug: select 1 as id
[0m07:40:41.403826 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:676e0cab-0f14-42f0-ade3-aed1652280dc&page=queryresults
[0m07:40:42.440109 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:40:42.440109 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:40:42.440109 [debug] [MainThread]: Command `dbt debug` succeeded at 07:40:42.440109 after 4.50 seconds
[0m07:40:42.440109 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:40:42.440109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC637AB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC772715B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC77648FB0>]}
[0m07:40:42.440109 [debug] [MainThread]: Flushing usage events
[0m07:56:41.102832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D62E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D62DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D62E540>]}


============================== 07:56:41.102832 | 7a328e6e-0006-4237-9079-871628b04432 ==============================
[0m07:56:41.102832 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:56:41.102832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:56:42.501093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D62E5D0>]}
[0m07:56:42.548394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002462092B350>]}
[0m07:56:42.548394 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:56:42.564667 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:56:42.715469 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m07:56:42.716467 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp_1://seeds\B00KJ75ISS_1_month.csv
[0m07:56:42.779185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024620B8A030>]}
[0m07:56:42.885083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024620DCF260>]}
[0m07:56:42.885083 [info ] [MainThread]: Found 16 models, 1 seed, 2 sources, 478 macros
[0m07:56:42.885083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024620AE9220>]}
[0m07:56:42.896952 [info ] [MainThread]: 
[0m07:56:42.897962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:56:42.899960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m07:56:42.900963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:44.150952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m07:56:44.151646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:45.321188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024620BAECF0>]}
[0m07:56:45.323185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:45.323185 [info ] [MainThread]: 
[0m07:56:45.326183 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m07:56:45.327182 [info ] [Thread-1 (]: 1 of 1 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m07:56:45.327182 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries'
[0m07:56:45.327182 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m07:56:45.328182 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m07:56:45.362253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:56:55.617104 [debug] [Thread-1 (]: On seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"} */

    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m07:56:56.212057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:1dbea695-4aa6-44e9-916f-723c6125aa12&page=queryresults
[0m07:56:57.026255 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"
[0m07:56:57.044933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a328e6e-0006-4237-9079-871628b04432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460B110A10>]}
[0m07:56:57.044933 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 11.72s]
[0m07:56:57.045916 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries
[0m07:56:57.047678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:57.047678 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m07:56:57.047678 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m07:56:57.047678 [debug] [MainThread]: Connection 'seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries' was properly closed.
[0m07:56:57.047678 [info ] [MainThread]: 
[0m07:56:57.048805 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 14.15 seconds (14.15s).
[0m07:56:57.048805 [debug] [MainThread]: Command end result
[0m07:56:57.087407 [info ] [MainThread]: 
[0m07:56:57.088306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:57.089305 [info ] [MainThread]: 
[0m07:56:57.090303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:56:57.091403 [debug] [MainThread]: Command `dbt seed` succeeded at 07:56:57.091403 after 16.11 seconds
[0m07:56:57.091403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460CDF2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D501520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460D501340>]}
[0m07:56:57.092402 [debug] [MainThread]: Flushing usage events
[0m07:57:15.155633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99CA5DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99C726600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99C8B48C0>]}


============================== 07:57:15.156645 | b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f ==============================
[0m07:57:15.156645 [info ] [MainThread]: Running with dbt=1.8.8
[0m07:57:15.156645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_offers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:57:16.492079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9AF0AC140>]}
[0m07:57:16.555290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9AEF2F980>]}
[0m07:57:16.555290 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:57:16.555290 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m07:57:16.694206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:57:16.694206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:57:16.725572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9AFF17440>]}
[0m07:57:16.820335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9B022CC80>]}
[0m07:57:16.820335 [info ] [MainThread]: Found 16 models, 1 seed, 2 sources, 478 macros
[0m07:57:16.820335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9B0023F20>]}
[0m07:57:16.820335 [info ] [MainThread]: 
[0m07:57:16.820335 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:57:16.820335 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m07:57:16.820335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:17.902745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m07:57:17.902745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:19.076550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9AF0E0890>]}
[0m07:57:19.076550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:19.076550 [info ] [MainThread]: 
[0m07:57:19.076550 [debug] [Thread-1 (]: Began running node model.buy_box_gcp_1.src_offers
[0m07:57:19.076550 [info ] [Thread-1 (]: 1 of 1 START sql table model wellbefore.src_offers ............................. [RUN]
[0m07:57:19.076550 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp_1.src_offers'
[0m07:57:19.076550 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp_1.src_offers
[0m07:57:19.076550 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp_1.src_offers"
[0m07:57:19.101013 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp_1.src_offers
[0m07:57:19.118008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:57:20.260292 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp_1.src_offers"
[0m07:57:20.284735 [debug] [Thread-1 (]: On model.buy_box_gcp_1.src_offers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "buy_box_gcp_1", "target_name": "dev", "node_id": "model.buy_box_gcp_1.src_offers"} */

  
    

    create or replace table `dbt-437212`.`wellbefore`.`src_offers`
      
    
    

    OPTIONS()
    as (
      WITH source_data AS (

    SELECT 

        PARSE_JSON(data.message_body) AS raw_data

    FROM 

        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data

),

flatten_data AS (

    SELECT

        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,

        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,

        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer

    FROM source_data

),

flatten_data_1 AS (

    SELECT

        NotificationId,

        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,

        ASIN,

        JSON_VALUE(offer, "$.SellerId") AS SellerId,

        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,

        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,

        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,

        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,

        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation

    FROM flatten_data,

    UNNEST(offer) AS offer

)



SELECT * 

FROM flatten_data_1
    );
  
[0m07:57:21.260188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:f84307bb-fa64-46f4-9ea6-4760bcfc94a5&page=queryresults
[0m07:57:24.026404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b81559e9-8ef7-4b55-a8f1-95a1be1e7b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E9AF4A2480>]}
[0m07:57:24.027415 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wellbefore.src_offers ........................ [[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)[0m in 4.95s]
[0m07:57:24.027415 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp_1.src_offers
[0m07:57:24.027415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:24.027415 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m07:57:24.031172 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m07:57:24.031172 [debug] [MainThread]: Connection 'model.buy_box_gcp_1.src_offers' was properly closed.
[0m07:57:24.031172 [info ] [MainThread]: 
[0m07:57:24.032179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m07:57:24.032179 [debug] [MainThread]: Command end result
[0m07:57:24.055663 [info ] [MainThread]: 
[0m07:57:24.055663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:57:24.055663 [info ] [MainThread]: 
[0m07:57:24.055663 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:57:24.065500 [debug] [MainThread]: Command `dbt run` succeeded at 07:57:24.065500 after 9.03 seconds
[0m07:57:24.065500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99C5EACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99C7B4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E99C7B4F20>]}
[0m07:57:24.065500 [debug] [MainThread]: Flushing usage events

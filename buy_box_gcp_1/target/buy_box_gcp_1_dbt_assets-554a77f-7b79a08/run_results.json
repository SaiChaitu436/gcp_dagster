{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-20T06:18:39.555130Z", "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:01.634337Z", "completed_at": "2024-11-20T06:17:01.649100Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:01.649100Z", "completed_at": "2024-11-20T06:17:04.174822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5501019954681396, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "11c338f4-ff70-472a-984c-5eaf45c97950", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_all_columns", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\n\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\n\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\n\n\nSELECT *\n\nFROM flattened_payload", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:04.192257Z", "completed_at": "2024-11-20T06:17:04.198285Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:04.199665Z", "completed_at": "2024-11-20T06:17:06.741966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5584802627563477, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "0717f1c5-a969-413d-bf12-08aa2809640e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month", "compiled": true, "compiled_code": "WITH source_data AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\n\r\n    FROM\r\n\r\n        dbt-437212.wellbefore.B00KJ75ISS_1_month\r\n\r\n),\r\n\r\n\r\n\r\nflatten_payload AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\n\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\n\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\n\r\n    FROM\r\n\r\n        source_data\r\n\r\n),\r\n\r\n\r\n\r\nflattened_payload AS (\r\n\r\n    SELECT\r\n\r\n        EventTime,\r\n\r\n        ApplicationId,\r\n\r\n        NotificationId,\r\n\r\n        PublishTime,\r\n\r\n        SubscriptionId,\r\n\r\n        NotificationType,\r\n\r\n        NotificationVersion,\r\n\r\n        ASIN,\r\n\r\n        ItemCondition,\r\n\r\n        MarketplaceId,\r\n\r\n        OfferChangeType,\r\n\r\n        TimeOfOfferChange,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\n\r\n\r\n\r\n    FROM\r\n\r\n        flatten_payload,\r\n\r\n        UNNEST(offers) AS offer,\r\n\r\n        UNNEST(bbp) AS bbp,\r\n\r\n        UNNEST(lop) AS lop,\r\n\r\n        UNNEST(neo) AS neo,\r\n\r\n        UNNEST(noo) AS noo,\r\n\r\n        UNNEST(sr) AS sr\r\n\r\n)\r\n\r\n\r\n\r\nSELECT *\r\n\r\nFROM flattened_payload", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`"}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:06.759293Z", "completed_at": "2024-11-20T06:17:06.771851Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:06.774140Z", "completed_at": "2024-11-20T06:17:10.757935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.017725944519043, "adapter_response": {}, "message": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join", "compiled": true, "compiled_code": "SELECT *\r\nFROM dbt-437212.wellbefore.dim_offers_values AS offers\r\nJOIN dbt-437212.wellbefore.dim_summary_values AS summary\r\nON \r\n    offers.ASIN = summary.ASIN \r\n    AND offers.EventTime = summary.EventTime", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:10.798526Z", "completed_at": "2024-11-20T06:17:10.812913Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:10.812913Z", "completed_at": "2024-11-20T06:17:13.207996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.411176919937134, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "7b0ef210-afd5-4cc1-a0eb-6ca43a2a792f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_offers_values", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer\n)\n\nSELECT *\n\nFROM flattened_payload order by ASIN", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:13.207996Z", "completed_at": "2024-11-20T06:17:13.207996Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:13.207996Z", "completed_at": "2024-11-20T06:17:15.726763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5187675952911377, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "c80b029e-46ee-422b-9de6-d81fae5e70fa", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_summary_values", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\nSELECT *\n\nFROM flattened_payload", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:15.743953Z", "completed_at": "2024-11-20T06:17:15.743953Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:15.743953Z", "completed_at": "2024-11-20T06:17:18.208816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.46486234664917, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "dcd09ad5-1299-45f8-8eef-e82a6202deb5", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.fct_sellers", "compiled": true, "compiled_code": "WITH source_data AS (\n    SELECT \n        PARSE_JSON(data.message_body) AS raw_data\n    FROM \n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n),\n\nflatten_data AS (\n    SELECT\n        JSON_VALUE(raw_data, \"$.EventTime\") AS EventTime,\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n    FROM source_data\n),\n\nflattened_offers AS (\n    SELECT \n        EventTime,\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n        JSON_VALUE(offer, \"$.IsFeaturedMerchant\") AS IsFeaturedMerchant,\n        JSON_VALUE(offer, \"$.IsFulfilledByAmazon\") AS IsFulfilledByAmazon\n    FROM \n        flatten_data,\n        UNNEST(offers) AS offer\n)\n\nSELECT \n    EventTime,\n    SellerId,\n    CASE \n        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'\n        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'\n        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'\n        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'\n        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'\n        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'\n        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'\n        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'\n        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'\n        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'\n        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'\n        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'\n        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'\n        ELSE 'Unknown Seller'\n    END AS SellerName,\n    IsFeaturedMerchant,\n    IsFulfilledByAmazon\nFROM \n    flattened_offers\nORDER BY \n    SellerId", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:18.208816Z", "completed_at": "2024-11-20T06:17:18.231208Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:18.232817Z", "completed_at": "2024-11-20T06:17:23.248280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.039463996887207, "adapter_response": {"_message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 44, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "2b1372b1-0556-49ce-ac75-c1c201258352", "slot_ms": 4396}, "message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_buybox_offers", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,\n\n        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,\n\n        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,\n\n\n\n        JSON_VALUE(noo.Condition)AS NumberOfferCondition,\n\n        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,\n\n        JSON_VALUE(noo.OfferCount)AS NumberOfferCount\n\n    FROM flatten_data,\n\n        UNNEST(buyboxprices) AS bop,\n\n        UNNEST(numberOfOffers) AS noo\n\n)\n\n\n\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:23.266277Z", "completed_at": "2024-11-20T06:17:23.276323Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:23.279876Z", "completed_at": "2024-11-20T06:17:28.514945Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.250906705856323, "adapter_response": {"_message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 28, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "9a701bc8-5fff-4ed4-bf0c-c0f3b77a6b21", "slot_ms": 5005}, "message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(lp.Condition)AS Condition,\n\n        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,\n\n\n\n        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,\n\n    FROM flatten_data,\n\n        UNNEST(lowestPrices) AS lp\n\n)\n\n\n\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:28.516736Z", "completed_at": "2024-11-20T06:17:28.536327Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:28.537328Z", "completed_at": "2024-11-20T06:17:33.525131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.008394956588745, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "8746235c-b51f-45f5-bc7b-f1f1d0bc4937", "slot_ms": 5237}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notification_summary", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice\n\n\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n        \n\n        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,\n\n        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,\n\n\n\n        ListPriceAmount\n\n        \n\n    FROM flatten_data,\n\n        UNNEST(buyboxprice) AS bp\n\n)\n\n\n\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:33.538225Z", "completed_at": "2024-11-20T06:17:33.562452Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:33.563450Z", "completed_at": "2024-11-20T06:17:38.347744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.809519052505493, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "3e671740-5974-4a87-b3a7-c5d0cebcae05", "slot_ms": 3748}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notifications", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.NotificationType) AS NotificationType,\n\n        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\nFROM source_data\n\n)\n\n\n\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:38.361129Z", "completed_at": "2024-11-20T06:17:38.372896Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:38.373844Z", "completed_at": "2024-11-20T06:17:43.010302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.662558317184448, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "2d4bd65f-91c0-45f0-80a5-608fa109c108", "slot_ms": 3657}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT\n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\n    FROM source_data\n\n)\n\n \n\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:43.010302Z", "completed_at": "2024-11-20T06:17:43.035555Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:43.036735Z", "completed_at": "2024-11-20T06:17:47.881154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.870851993560791, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "3f0acd28-fa7d-45dd-a314-43f90b073357", "slot_ms": 14005}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_offers", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        JSON_VALUE(raw_data, \"$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offer\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,\n\n        ASIN,\n\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n\n        JSON_VALUE(offer, \"$.IsBuyBoxWinner\") AS IsBuyBoxWinner,\n\n        JSON_VALUE(offer, \"$.ListingPrice.Amount\") AS ListingPriceAmount,\n\n        JSON_VALUE(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS IsOfferNationalPrime,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferPrime\") AS PrimeInformation\n\n    FROM flatten_data,\n\n    UNNEST(offer) AS offer\n\n)\n\n\n\nSELECT * \n\nFROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:47.897095Z", "completed_at": "2024-11-20T06:17:47.918446Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:47.919457Z", "completed_at": "2024-11-20T06:17:52.660630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.7794764041900635, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "d059c9df-c5cb-400e-8359-bedf1864d3c3", "slot_ms": 3115}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_products", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId\n\n    FROM source_data\n\n)\n\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:52.676921Z", "completed_at": "2024-11-20T06:17:52.692905Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:52.694644Z", "completed_at": "2024-11-20T06:17:57.626093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.9502787590026855, "adapter_response": {"_message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 43, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "7e58c87e-4faf-4717-afee-96c07f54b4b9", "slot_ms": 4898}, "message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_sales_ranking", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        ASIN,\n\n        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,\n\n        JSON_EXTRACT(sr, '$.Rank') AS Ranking\n\n    FROM flatten_payload, UNNEST(SalesRankings) AS sr \n\n)\n\nSELECT * FROM flatten_offers", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:17:57.642975Z", "completed_at": "2024-11-20T06:17:57.651522Z"}, {"name": "execute", "started_at": "2024-11-20T06:17:57.652545Z", "completed_at": "2024-11-20T06:18:02.128757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.485781669616699, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "65a1dd57-d9da-48bd-9764-96c052bdd504", "slot_ms": 3184}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_shipping", "compiled": true, "compiled_code": "-- WITH source_data AS (\n\n--     SELECT \n\n--         PARSE_JSON(data.message_body) AS raw_data,\n\n--     FROM \n\n--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\n\n-- ),\n\n-- flatten_data AS (\n\n--     SELECT\n\n--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers\n\n--     FROM source_data\n\n-- )\n\n-- SELECT\n\n--     NotificationId,\n\n--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,\n\n--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,\n\n--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,\n\n--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,\n\n--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,\n\n--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,\n\n-- FROM\n\n--     flatten_data, UNNEST(offers) AS offers\n\n\n\nWITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        NotificationId,\n\n        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,\n\n        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,\n\n        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically\n\n\n\n    FROM flatten_payload, UNNEST(offers) AS offer \n\n)\n\nSELECT * FROM flatten_offers", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:18:02.135775Z", "completed_at": "2024-11-20T06:18:02.135775Z"}, {"name": "execute", "started_at": "2024-11-20T06:18:02.137767Z", "completed_at": "2024-11-20T06:18:25.086863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 22.953094720840454, "adapter_response": {"_message": "INSERT 4834", "code": "INSERT", "rows_affected": 4834}, "message": "INSERT 4834", "failures": null, "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:18:25.086863Z", "completed_at": "2024-11-20T06:18:25.086863Z"}, {"name": "execute", "started_at": "2024-11-20T06:18:25.086863Z", "completed_at": "2024-11-20T06:18:33.987400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.900537252426147, "adapter_response": {"_message": "INSERT 20", "code": "INSERT", "rows_affected": 20}, "message": "INSERT 20", "failures": null, "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T06:18:34.000408Z", "completed_at": "2024-11-20T06:18:34.007162Z"}, {"name": "execute", "started_at": "2024-11-20T06:18:34.008172Z", "completed_at": "2024-11-20T06:18:39.524577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.537176847457886, "adapter_response": {"_message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 2143, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "451c2882-8444-4869-a09c-73eeebe889ad", "slot_ms": 43311}, "message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.variable_summary_table", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT \n        offers.ASIN,\n        offers.SELLERID,\n        offers.NOTIFICATIONID,\n        offers.ISBUYBOXWINNER,\n        offers.ISOFFERPRIME,\n        offers.SHIPSDOMESTICALLY,\n        offers.PUBLISHTIME,\n        offers.LISTINGPRICEAMOUNT,\n        offers.SELLERFEEDBACKCOUNT,\n        offers.SELLERPOSITIVEFEEDBACKRATING,\n        offers.SHIPPINGAMOUNT,\n        offers.SHIPPINGMINHOURS,\n        offers.SHIPPINGMAXHOURS,\n        summary.BUYBOXLISTINGPRICEAMOUNT,\n\n        -- Difference between seller's listing price and mean listing price at publish time.\n        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,\n        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,\n\n        -- Difference between seller's listing price and lowest listing price at publish time.\n        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,\n        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,\n\n        -- Difference between seller's average shipping hours and mean average hours at publish time.\n        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,\n\n        -- Difference between seller's average shipping hours and lowest average hours at publish time.\n        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,\n        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,\n\n        -- Difference between seller's feedback count and mean feedback count at publish time.\n        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,\n\n        -- Difference between seller's feedback count and highest feedback count at publish time.\n        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,\n\n        -- Difference between seller's feedback rating and mean feedback rating at publish time.\n        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,\n\n        -- Difference between seller's feedback rating and highest feedback rating at publish time.\n        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,\n\n        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).\n        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,\n\n        -- Ratio of seller's rating to their listing price (rating per dollar).\n        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,\n\n        -- Ratio of seller's feedback count to their listing price (feedback per dollar).\n        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,\n\n        -- Ratio between seller's current listing price and their BuyBox listing price.\n        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,\n\n        -- Total number of assessments or reviews the product has received from customers.\n        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,\n\n        -- Indicates if the seller is domestic (1=True, 0=False).\n        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,\n\n        -- Cost of shipping the product offered by the seller.\n        offers.ShippingAmount AS shipping_price,\n\n        -- Estimated shipping time (in hours).\n        offers.ShippingMaxHours AS shipping_time_in_hours\n\n    FROM \n    `dbt-437212`.`wellbefore`.`dim_offers_values` AS offers\n\nLEFT JOIN \n        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary\n    ON \n        offers.NotificationId = summary.NotificationId\n)\n\nSELECT * FROM base\nORDER BY ASIN", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`"}], "elapsed_time": 102.26588678359985, "args": {"source_freshness_run_project_hooks": false, "indirect_selection": "eager", "export_saved_queries": false, "version_check": true, "favor_state": false, "exclude_resource_types": [], "static_parser": true, "profiles_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1", "populate_cache": true, "use_colors_file": true, "include_saved_query": false, "cache_selected_only": false, "log_format": "json", "introspect": true, "macro_debugging": false, "partial_parse": true, "target_path": "target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08", "which": "build", "printer_width": 80, "exclude": [], "enable_legacy_logger": false, "log_level_file": "debug", "write_json": true, "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08", "empty": false, "partial_parse_file_diff": true, "quiet": false, "resource_types": [], "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "select": ["fqn:*"], "log_format_file": "json", "vars": {}, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "show": false, "strict_mode": false, "invocation_command": "dbt build --select fqn:*", "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": false, "defer": false, "print": true, "use_colors": true, "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1", "log_level": "info"}}
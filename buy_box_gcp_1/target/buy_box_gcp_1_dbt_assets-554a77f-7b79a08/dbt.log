{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:55.361691Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select fqn:*", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1\\target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\gcp_dagster\\buy_box_gcp_1", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\\\Users\\\\SAILS-DM204\\\\OneDrive - Sails Software Solutions Pvt Ltd\\\\Desktop\\\\New folder\\\\gcp_dagster\\\\buy_box_gcp_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\\\Users\\\\SAILS-DM204\\\\OneDrive - Sails Software Solutions Pvt Ltd\\\\Desktop\\\\New folder\\\\gcp_dagster\\\\buy_box_gcp_1\\\\target\\\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'json', 'target_path': 'target\\\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08', 'invocation_command': 'dbt build --select fqn:*', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:55.372114Z"}}
{"data": {"adapter_name": "bigquery", "adapter_version": "=1.8.3"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Registered adapter: bigquery=1.8.3", "name": "AdapterRegistered", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:56.907444Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:56.907444Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:57.082845Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:57.082845Z"}}
{"data": {"stat_line": "16 models, 2 seeds, 2 sources, 478 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Found 16 models, 2 seeds, 2 sources, 478 macros", "name": "FoundStats", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:57.273045Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:57.274287Z"}}
{"data": {"conn_name": "master", "conn_type": "bigquery"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Acquiring new bigquery connection 'master'", "name": "NewConnection", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:16:57.274287Z"}}
{"data": {"conn_name": "list_dbt-437212", "conn_type": "bigquery"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Acquiring new bigquery connection 'list_dbt-437212'", "name": "NewConnection", "pid": 38152, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-20T06:16:57.285649Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 38152, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-20T06:16:57.285649Z"}}
{"data": {"conn_name": "list_dbt-437212_wellbefore", "conn_type": "bigquery"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Acquiring new bigquery connection 'list_dbt-437212_wellbefore'", "name": "NewConnection", "pid": 38152, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-11-20T06:16:59.808506Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 38152, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-11-20T06:16:59.808506Z"}}
{"data": {"node_count": 18, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:17:01.608324Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:17:01.608324Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.dim_all_columns", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.624720Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "1 of 18 START sql view model wellbefore.dim_all_columns ........................ [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.624720Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns", "conn_type": "bigquery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Acquiring new bigquery connection 'model.buy_box_gcp_1.dim_all_columns'", "name": "NewConnection", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.624720Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.dim_all_columns", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.633846Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.dim_all_columns\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.646326Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.dim_all_columns", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.649100Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.685476Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.690345Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\n\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\n\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\n\n\nSELECT *\n\nFROM flattened_payload;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.dim_all_columns: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\n\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\n\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\n\n\nSELECT *\n\nFROM flattened_payload;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:01.730569Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:11c338f4-ff70-472a-984c-5eaf45c97950&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:11c338f4-ff70-472a-984c-5eaf45c97950&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:03.275740Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns", "execution_time": 2.550102, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:04.174822", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}, "status": "CREATE VIEW (0 processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "1 of 18 OK created sql view model wellbefore.dim_all_columns ................... [\u001b[32mCREATE VIEW (0 processed)\u001b[0m in 2.55s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.183486Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:04.174822", "node_name": "dim_all_columns", "node_path": "dim\\dim_all_columns.sql", "node_relation": {"alias": "dim_all_columns", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:01.624720", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "11c338f4-ff70-472a-984c-5eaf45c97950", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.550102, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:01.649100Z", "name": "compile", "started_at": "2024-11-20T06:17:01.634337Z"}, {"completed_at": "2024-11-20T06:17:04.174822Z", "name": "execute", "started_at": "2024-11-20T06:17:01.649100Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.dim_all_columns", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.183486Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.dim_all_columns_1_month", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.183486Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns_1_month", "index": 2, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "2 of 18 START sql view model wellbefore.dim_all_columns_1_month ................ [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.183486Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns_1_month", "orig_conn_name": "model.buy_box_gcp_1.dim_all_columns"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns, now model.buy_box_gcp_1.dim_all_columns_1_month)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.190Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.dim_all_columns_1_month", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.191477Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.dim_all_columns_1_month\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.196165Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.dim_all_columns_1_month", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.198285Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns_1_month\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns_1_month\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.200914Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.203221Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns_1_month", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns_1_month\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_1_month`\n  OPTIONS()\n  as WITH source_data AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\n\r\n    FROM\r\n\r\n        dbt-437212.wellbefore.B00KJ75ISS_1_month\r\n\r\n),\r\n\r\n\r\n\r\nflatten_payload AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\n\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\n\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\n\r\n    FROM\r\n\r\n        source_data\r\n\r\n),\r\n\r\n\r\n\r\nflattened_payload AS (\r\n\r\n    SELECT\r\n\r\n        EventTime,\r\n\r\n        ApplicationId,\r\n\r\n        NotificationId,\r\n\r\n        PublishTime,\r\n\r\n        SubscriptionId,\r\n\r\n        NotificationType,\r\n\r\n        NotificationVersion,\r\n\r\n        ASIN,\r\n\r\n        ItemCondition,\r\n\r\n        MarketplaceId,\r\n\r\n        OfferChangeType,\r\n\r\n        TimeOfOfferChange,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\n\r\n\r\n\r\n    FROM\r\n\r\n        flatten_payload,\r\n\r\n        UNNEST(offers) AS offer,\r\n\r\n        UNNEST(bbp) AS bbp,\r\n\r\n        UNNEST(lop) AS lop,\r\n\r\n        UNNEST(neo) AS neo,\r\n\r\n        UNNEST(noo) AS noo,\r\n\r\n        UNNEST(sr) AS sr\r\n\r\n)\r\n\r\n\r\n\r\nSELECT *\r\n\r\nFROM flattened_payload;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.dim_all_columns_1_month: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns_1_month\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_1_month`\n  OPTIONS()\n  as WITH source_data AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\n\r\n    FROM\r\n\r\n        dbt-437212.wellbefore.B00KJ75ISS_1_month\r\n\r\n),\r\n\r\n\r\n\r\nflatten_payload AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\n\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\n\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\n\r\n    FROM\r\n\r\n        source_data\r\n\r\n),\r\n\r\n\r\n\r\nflattened_payload AS (\r\n\r\n    SELECT\r\n\r\n        EventTime,\r\n\r\n        ApplicationId,\r\n\r\n        NotificationId,\r\n\r\n        PublishTime,\r\n\r\n        SubscriptionId,\r\n\r\n        NotificationType,\r\n\r\n        NotificationVersion,\r\n\r\n        ASIN,\r\n\r\n        ItemCondition,\r\n\r\n        MarketplaceId,\r\n\r\n        OfferChangeType,\r\n\r\n        TimeOfOfferChange,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\n\r\n\r\n\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\n\r\n\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\n\r\n\r\n\r\n    FROM\r\n\r\n        flatten_payload,\r\n\r\n        UNNEST(offers) AS offer,\r\n\r\n        UNNEST(bbp) AS bbp,\r\n\r\n        UNNEST(lop) AS lop,\r\n\r\n        UNNEST(neo) AS neo,\r\n\r\n        UNNEST(noo) AS noo,\r\n\r\n        UNNEST(sr) AS sr\r\n\r\n)\r\n\r\n\r\n\r\nSELECT *\r\n\r\nFROM flattened_payload;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:04.245413Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0717f1c5-a969-413d-bf12-08aa2809640e&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:0717f1c5-a969-413d-bf12-08aa2809640e&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:05.896239Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns_1_month", "execution_time": 2.5584803, "index": 2, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:06.741966", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}, "status": "CREATE VIEW (0 processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "2 of 18 OK created sql view model wellbefore.dim_all_columns_1_month ........... [\u001b[32mCREATE VIEW (0 processed)\u001b[0m in 2.56s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.741966Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:06.741966", "node_name": "dim_all_columns_1_month", "node_path": "dim\\dim_all_columns_1_month.sql", "node_relation": {"alias": "dim_all_columns_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:04.183486", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_1_month"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "0717f1c5-a969-413d-bf12-08aa2809640e", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.5584803, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:04.198285Z", "name": "compile", "started_at": "2024-11-20T06:17:04.192257Z"}, {"completed_at": "2024-11-20T06:17:06.741966Z", "name": "execute", "started_at": "2024-11-20T06:17:04.199665Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.dim_all_columns_1_month", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.741966Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.dim_all_columns_using_join", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.741966Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns_using_join", "index": 3, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "3 of 18 START sql view model wellbefore.dim_all_columns_using_join ............. [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.741966Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns_using_join", "orig_conn_name": "model.buy_box_gcp_1.dim_all_columns_1_month"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_1_month, now model.buy_box_gcp_1.dim_all_columns_using_join)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.757534Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.dim_all_columns_using_join", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.758547Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.dim_all_columns_using_join\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.762987Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.dim_all_columns_using_join", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.771851Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns_using_join\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_all_columns_using_join\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.779566Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.781584Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_all_columns_using_join", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns_using_join\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_using_join`\n  OPTIONS()\n  as SELECT *\r\nFROM dbt-437212.wellbefore.dim_offers_values AS offers\r\nJOIN dbt-437212.wellbefore.dim_summary_values AS summary\r\nON \r\n    offers.ASIN = summary.ASIN \r\n    AND offers.EventTime = summary.EventTime;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.dim_all_columns_using_join: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_all_columns_using_join\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_all_columns_using_join`\n  OPTIONS()\n  as SELECT *\r\nFROM dbt-437212.wellbefore.dim_offers_values AS offers\r\nJOIN dbt-437212.wellbefore.dim_summary_values AS summary\r\nON \r\n    offers.ASIN = summary.ASIN \r\n    AND offers.EventTime = summary.EventTime;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:06.840904Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9110c52a-2fb1-4880-93e8-31077c9229f0&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9110c52a-2fb1-4880-93e8-31077c9229f0&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:08.457587Z"}}
{"data": {"args": [], "base_msg": "Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name EventTime at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name EventTime at [6:6]')", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name EventTime at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name EventTime at [6:6]')", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:08.890874Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b283c75-2f83-4aa9-abce-e233416ed699&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b283c75-2f83-4aa9-abce-e233416ed699&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.374130Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b283c75-2f83-4aa9-abce-e233416ed699&page=queryresults", "exc_info": "", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "E004", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "error", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b283c75-2f83-4aa9-abce-e233416ed699&page=queryresults", "name": "AdapterEventError", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.757935Z"}}
{"data": {"exc": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 247, in exception_handler\n    yield\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 762, in _retry_and_handle\n    return retry.retry_target(\n           ^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 144, in retry_target\n    result = target()\n             ^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 487, in fn\n    return self._query_and_results(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 745, in _query_and_results\n    iterator = query_job.result(max_results=limit, timeout=job_execution_timeout)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\cloud\\bigquery\\job\\query.py\", line 1688, in result\n    while not is_job_done():\n              ^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n           ^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 144, in retry_target\n    result = target()\n             ^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\google\\cloud\\bigquery\\job\\query.py\", line 1630, in is_job_done\n    raise job_failed_exception\ngoogle.api_core.exceptions.BadRequest: 400 CREATE VIEW has columns with duplicate name EventTime at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name EventTime at [6:6]\n\nLocation: US\nJob ID: 7b283c75-2f83-4aa9-abce-e233416ed699\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\task\\base.py\", line 368, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\task\\base.py\", line 314, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\task\\base.py\", line 415, in run\n    return self.execute(compiled_node, manifest)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\task\\run.py\", line 298, in execute\n    result = MacroGenerator(\n             ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\clients\\jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt_common\\clients\\jinja.py\", line 299, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 31, in macro\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\clients\\jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt_common\\clients\\jinja.py\", line 299, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 65, in macro\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\clients\\jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt_common\\clients\\jinja.py\", line 299, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 52, in macro\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\jinja2\\runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\base\\impl.py\", line 380, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 505, in execute\n    query_job, iterator = self.raw_execute(sql, limit=limit)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 496, in raw_execute\n    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 761, in _retry_and_handle\n    with self.exception_handler(msg):\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 251, in exception_handler\n    self.handle_error(e, message)\n  File \"C:\\Users\\SAILS-DM204\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\adapters\\bigquery\\connections.py\", line 239, in handle_error\n    raise DbtDatabaseError(error_msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql\n", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "name": "CatchableExceptionOnRun", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.774711Z"}}
{"data": {"description": "sql view model wellbefore.dim_all_columns_using_join", "execution_time": 4.017726, "index": 3, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:10.774711", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "error", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}, "status": "error", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "error", "msg": "3 of 18 ERROR creating sql view model wellbefore.dim_all_columns_using_join .... [\u001b[31mERROR\u001b[0m in 4.02s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.791120Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:10.774711", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:06.741966", "node_status": "error", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}, "run_result": {"adapter_response": {}, "execution_time": 4.017726, "message": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "num_failures": 0, "status": "error", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:06.771851Z", "name": "compile", "started_at": "2024-11-20T06:17:06.759293Z"}, {"completed_at": "2024-11-20T06:17:10.757935Z", "name": "execute", "started_at": "2024-11-20T06:17:06.774140Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.dim_all_columns_using_join", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.793315Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.dim_offers_values", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.793315Z"}}
{"data": {"description": "sql view model wellbefore.dim_offers_values", "index": 4, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "4 of 18 START sql view model wellbefore.dim_offers_values ...................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.795751Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_offers_values", "orig_conn_name": "model.buy_box_gcp_1.dim_all_columns_using_join"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_all_columns_using_join, now model.buy_box_gcp_1.dim_offers_values)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.796819Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.dim_offers_values", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.798526Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.dim_offers_values\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.812913Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.dim_offers_values", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.812913Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_offers_values\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_offers_values\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.812913Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.812913Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_offers_values", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_offers_values\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer\n)\n\nSELECT *\n\nFROM flattened_payload order by ASIN;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.dim_offers_values: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_offers_values\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_offers_values`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer\n)\n\nSELECT *\n\nFROM flattened_payload order by ASIN;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:10.858797Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b0ef210-afd5-4cc1-a0eb-6ca43a2a792f&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7b0ef210-afd5-4cc1-a0eb-6ca43a2a792f&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:12.374762Z"}}
{"data": {"description": "sql view model wellbefore.dim_offers_values", "execution_time": 2.411177, "index": 4, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:13.207996", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}, "status": "CREATE VIEW (0 processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "4 of 18 OK created sql view model wellbefore.dim_offers_values ................. [\u001b[32mCREATE VIEW (0 processed)\u001b[0m in 2.41s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:13.207996", "node_name": "dim_offers_values", "node_path": "dim\\dim_offers_values.sql", "node_relation": {"alias": "dim_offers_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_offers_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:10.793315", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_offers_values"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "7b0ef210-afd5-4cc1-a0eb-6ca43a2a792f", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.411177, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:10.812913Z", "name": "compile", "started_at": "2024-11-20T06:17:10.798526Z"}, {"completed_at": "2024-11-20T06:17:13.207996Z", "name": "execute", "started_at": "2024-11-20T06:17:10.812913Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.dim_offers_values", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.dim_summary_values", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"description": "sql view model wellbefore.dim_summary_values", "index": 5, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "5 of 18 START sql view model wellbefore.dim_summary_values ..................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_summary_values", "orig_conn_name": "model.buy_box_gcp_1.dim_offers_values"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_offers_values, now model.buy_box_gcp_1.dim_summary_values)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.dim_summary_values", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.dim_summary_values\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.dim_summary_values", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.207996Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_summary_values\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.dim_summary_values\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.228764Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.230656Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.dim_summary_values", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_summary_values\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\nSELECT *\n\nFROM flattened_payload;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.dim_summary_values: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.dim_summary_values\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`dim_summary_values`\n  OPTIONS()\n  as WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`\n\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\nSELECT *\n\nFROM flattened_payload;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:13.279252Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c80b029e-46ee-422b-9de6-d81fae5e70fa&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:c80b029e-46ee-422b-9de6-d81fae5e70fa&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:14.858960Z"}}
{"data": {"description": "sql view model wellbefore.dim_summary_values", "execution_time": 2.5187676, "index": 5, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:15.726763", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}, "status": "CREATE VIEW (0 processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "5 of 18 OK created sql view model wellbefore.dim_summary_values ................ [\u001b[32mCREATE VIEW (0 processed)\u001b[0m in 2.52s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.726763Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:15.726763", "node_name": "dim_summary_values", "node_path": "dim\\dim_summary_values.sql", "node_relation": {"alias": "dim_summary_values", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:13.207996", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_summary_values"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "c80b029e-46ee-422b-9de6-d81fae5e70fa", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.5187676, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:13.207996Z", "name": "compile", "started_at": "2024-11-20T06:17:13.207996Z"}, {"completed_at": "2024-11-20T06:17:15.726763Z", "name": "execute", "started_at": "2024-11-20T06:17:13.207996Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.dim_summary_values", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.741195Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.fct_sellers", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.742231Z"}}
{"data": {"description": "sql view model wellbefore.fct_sellers", "index": 6, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "6 of 18 START sql view model wellbefore.fct_sellers ............................ [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743230Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.fct_sellers", "orig_conn_name": "model.buy_box_gcp_1.dim_summary_values"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.dim_summary_values, now model.buy_box_gcp_1.fct_sellers)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743953Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.fct_sellers", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743953Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.fct_sellers\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743953Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.fct_sellers", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743953Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.fct_sellers\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.fct_sellers\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.743953Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.757686Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.fct_sellers", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.fct_sellers\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`\n  OPTIONS()\n  as WITH source_data AS (\n    SELECT \n        PARSE_JSON(data.message_body) AS raw_data\n    FROM \n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n),\n\nflatten_data AS (\n    SELECT\n        JSON_VALUE(raw_data, \"$.EventTime\") AS EventTime,\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n    FROM source_data\n),\n\nflattened_offers AS (\n    SELECT \n        EventTime,\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n        JSON_VALUE(offer, \"$.IsFeaturedMerchant\") AS IsFeaturedMerchant,\n        JSON_VALUE(offer, \"$.IsFulfilledByAmazon\") AS IsFulfilledByAmazon\n    FROM \n        flatten_data,\n        UNNEST(offers) AS offer\n)\n\nSELECT \n    EventTime,\n    SellerId,\n    CASE \n        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'\n        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'\n        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'\n        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'\n        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'\n        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'\n        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'\n        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'\n        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'\n        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'\n        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'\n        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'\n        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'\n        ELSE 'Unknown Seller'\n    END AS SellerName,\n    IsFeaturedMerchant,\n    IsFulfilledByAmazon\nFROM \n    flattened_offers\nORDER BY \n    SellerId;\n\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.fct_sellers: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.fct_sellers\"} */\n\n\n  create or replace view `dbt-437212`.`wellbefore`.`fct_sellers`\n  OPTIONS()\n  as WITH source_data AS (\n    SELECT \n        PARSE_JSON(data.message_body) AS raw_data\n    FROM \n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n),\n\nflatten_data AS (\n    SELECT\n        JSON_VALUE(raw_data, \"$.EventTime\") AS EventTime,\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\n    FROM source_data\n),\n\nflattened_offers AS (\n    SELECT \n        EventTime,\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n        JSON_VALUE(offer, \"$.IsFeaturedMerchant\") AS IsFeaturedMerchant,\n        JSON_VALUE(offer, \"$.IsFulfilledByAmazon\") AS IsFulfilledByAmazon\n    FROM \n        flatten_data,\n        UNNEST(offers) AS offer\n)\n\nSELECT \n    EventTime,\n    SellerId,\n    CASE \n        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'\n        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'\n        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'\n        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'\n        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'\n        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'\n        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'\n        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'\n        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'\n        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'\n        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'\n        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'\n        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'\n        ELSE 'Unknown Seller'\n    END AS SellerName,\n    IsFeaturedMerchant,\n    IsFulfilledByAmazon\nFROM \n    flattened_offers\nORDER BY \n    SellerId;\n\n", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:15.829400Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:dcd09ad5-1299-45f8-8eef-e82a6202deb5&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:dcd09ad5-1299-45f8-8eef-e82a6202deb5&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:17.367039Z"}}
{"data": {"description": "sql view model wellbefore.fct_sellers", "execution_time": 2.4648623, "index": 6, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:18.208816", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}, "status": "CREATE VIEW (0 processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "6 of 18 OK created sql view model wellbefore.fct_sellers ....................... [\u001b[32mCREATE VIEW (0 processed)\u001b[0m in 2.46s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-11-20T06:17:18.208816", "node_name": "fct_sellers", "node_path": "fact\\fct_sellers.sql", "node_relation": {"alias": "fct_sellers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`fct_sellers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:15.742231", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.fct_sellers"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "dcd09ad5-1299-45f8-8eef-e82a6202deb5", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.4648623, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:15.743953Z", "name": "compile", "started_at": "2024-11-20T06:17:15.743953Z"}, {"completed_at": "2024-11-20T06:17:18.208816Z", "name": "execute", "started_at": "2024-11-20T06:17:15.743953Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.fct_sellers", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_buybox_offers", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"description": "sql table model wellbefore.src_buybox_offers", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "7 of 18 START sql table model wellbefore.src_buybox_offers ..................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_buybox_offers", "orig_conn_name": "model.buy_box_gcp_1.fct_sellers"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.fct_sellers, now model.buy_box_gcp_1.src_buybox_offers)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_buybox_offers", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.208816Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_buybox_offers\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.227862Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_buybox_offers", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.231208Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:18.258702Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_buybox_offers\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_buybox_offers\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:19.694344Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_buybox_offers", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_buybox_offers\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,\n\n        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,\n\n        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,\n\n\n\n        JSON_VALUE(noo.Condition)AS NumberOfferCondition,\n\n        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,\n\n        JSON_VALUE(noo.OfferCount)AS NumberOfferCount\n\n    FROM flatten_data,\n\n        UNNEST(buyboxprices) AS bop,\n\n        UNNEST(numberOfOffers) AS noo\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_buybox_offers: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_buybox_offers\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_buybox_offers`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,\n\n        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,\n\n        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,\n\n\n\n        JSON_VALUE(noo.Condition)AS NumberOfferCondition,\n\n        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,\n\n        JSON_VALUE(noo.OfferCount)AS NumberOfferCount\n\n    FROM flatten_data,\n\n        UNNEST(buyboxprices) AS bop,\n\n        UNNEST(numberOfOffers) AS noo\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:19.696244Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2b1372b1-0556-49ce-ac75-c1c201258352&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2b1372b1-0556-49ce-ac75-c1c201258352&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:20.455077Z"}}
{"data": {"description": "sql table model wellbefore.src_buybox_offers", "execution_time": 5.039464, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:23.248280", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}, "status": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "7 of 18 OK created sql table model wellbefore.src_buybox_offers ................ [\u001b[32mCREATE TABLE (44.0 rows, 120.8 KiB processed)\u001b[0m in 5.04s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.248280Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:23.248280", "node_name": "src_buybox_offers", "node_path": "src\\src_buybox_offers.sql", "node_relation": {"alias": "src_buybox_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:18.208816", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_buybox_offers"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "2b1372b1-0556-49ce-ac75-c1c201258352", "location": "US", "project_id": "dbt-437212", "rows_affected": 44.0, "slot_ms": 4396.0}, "execution_time": 5.039464, "message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:18.231208Z", "name": "compile", "started_at": "2024-11-20T06:17:18.208816Z"}, {"completed_at": "2024-11-20T06:17:23.248280Z", "name": "execute", "started_at": "2024-11-20T06:17:18.232817Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_buybox_offers", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.248280Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_notification_lowest_prices", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.248280Z"}}
{"data": {"description": "sql table model wellbefore.src_notification_lowest_prices", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "8 of 18 START sql table model wellbefore.src_notification_lowest_prices ........ [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.248280Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notification_lowest_prices", "orig_conn_name": "model.buy_box_gcp_1.src_buybox_offers"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_buybox_offers, now model.buy_box_gcp_1.src_notification_lowest_prices)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.264038Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_notification_lowest_prices", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.264038Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_notification_lowest_prices\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.274155Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_notification_lowest_prices", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.276323Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:23.285422Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notification_lowest_prices\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notification_lowest_prices\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:24.642598Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notification_lowest_prices", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notification_lowest_prices\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(lp.Condition)AS Condition,\n\n        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,\n\n\n\n        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,\n\n    FROM flatten_data,\n\n        UNNEST(lowestPrices) AS lp\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_notification_lowest_prices: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notification_lowest_prices\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notification_lowest_prices`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(lp.Condition)AS Condition,\n\n        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,\n\n\n\n        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n\n\n        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,\n\n    FROM flatten_data,\n\n        UNNEST(lowestPrices) AS lp\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:24.642598Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9a701bc8-5fff-4ed4-bf0c-c0f3b77a6b21&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:9a701bc8-5fff-4ed4-bf0c-c0f3b77a6b21&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:25.968271Z"}}
{"data": {"description": "sql table model wellbefore.src_notification_lowest_prices", "execution_time": 5.250907, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:28.514945", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}, "status": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "8 of 18 OK created sql table model wellbefore.src_notification_lowest_prices ... [\u001b[32mCREATE TABLE (28.0 rows, 120.8 KiB processed)\u001b[0m in 5.25s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516051Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:28.514945", "node_name": "src_notification_lowest_prices", "node_path": "src\\src_notification_lowest_prices.sql", "node_relation": {"alias": "src_notification_lowest_prices", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:23.248280", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "9a701bc8-5fff-4ed4-bf0c-c0f3b77a6b21", "location": "US", "project_id": "dbt-437212", "rows_affected": 28.0, "slot_ms": 5005.0}, "execution_time": 5.250907, "message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:23.276323Z", "name": "compile", "started_at": "2024-11-20T06:17:23.266277Z"}, {"completed_at": "2024-11-20T06:17:28.514945Z", "name": "execute", "started_at": "2024-11-20T06:17:23.279876Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_notification_lowest_prices", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516736Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_notification_summary", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516736Z"}}
{"data": {"description": "sql table model wellbefore.src_notification_summary", "index": 9, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "9 of 18 START sql table model wellbefore.src_notification_summary .............. [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516736Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notification_summary", "orig_conn_name": "model.buy_box_gcp_1.src_notification_lowest_prices"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_lowest_prices, now model.buy_box_gcp_1.src_notification_summary)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516736Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_notification_summary", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.516736Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_notification_summary\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.528955Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_notification_summary", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.537328Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:28.541288Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notification_summary\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notification_summary\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:30.024356Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notification_summary", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notification_summary\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice\n\n\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n        \n\n        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,\n\n        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,\n\n\n\n        ListPriceAmount\n\n        \n\n    FROM flatten_data,\n\n        UNNEST(buyboxprice) AS bp\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_notification_summary: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notification_summary\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notification_summary`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,\n\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice\n\n\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,\n\n        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\n\n\n\n        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,\n\n        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\n\n        \n\n        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,\n\n        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,\n\n\n\n        ListPriceAmount\n\n        \n\n    FROM flatten_data,\n\n        UNNEST(buyboxprice) AS bp\n\n)\n\n\n\nSELECT * FROM flatten_data_1\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:30.050837Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:8746235c-b51f-45f5-bc7b-f1f1d0bc4937&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:8746235c-b51f-45f5-bc7b-f1f1d0bc4937&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:30.749355Z"}}
{"data": {"description": "sql table model wellbefore.src_notification_summary", "execution_time": 5.008395, "index": 9, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:33.525131", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}, "status": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "9 of 18 OK created sql table model wellbefore.src_notification_summary ......... [\u001b[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)\u001b[0m in 5.01s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.525131Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:33.525131", "node_name": "src_notification_summary", "node_path": "src\\src_notification_summary.sql", "node_relation": {"alias": "src_notification_summary", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:28.516736", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notification_summary"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "8746235c-b51f-45f5-bc7b-f1f1d0bc4937", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 5237.0}, "execution_time": 5.008395, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:28.536327Z", "name": "compile", "started_at": "2024-11-20T06:17:28.516736Z"}, {"completed_at": "2024-11-20T06:17:33.525131Z", "name": "execute", "started_at": "2024-11-20T06:17:28.537328Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_notification_summary", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.538225Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_notifications", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.538225Z"}}
{"data": {"description": "sql table model wellbefore.src_notifications", "index": 10, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "10 of 18 START sql table model wellbefore.src_notifications .................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.538225Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notifications", "orig_conn_name": "model.buy_box_gcp_1.src_notification_summary"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notification_summary, now model.buy_box_gcp_1.src_notifications)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.538225Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_notifications", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.538225Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_notifications\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.560538Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_notifications", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.562452Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:33.566587Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notifications\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_notifications\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:34.967286Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_notifications", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notifications\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.NotificationType) AS NotificationType,\n\n        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\nFROM source_data\n\n)\n\n\n\nSELECT * FROM flatten_data\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_notifications: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_notifications\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_notifications`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,\n\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_VALUE(raw_data.NotificationType) AS NotificationType,\n\n        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\nFROM source_data\n\n)\n\n\n\nSELECT * FROM flatten_data\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:34.967725Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3e671740-5974-4a87-b3a7-c5d0cebcae05&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3e671740-5974-4a87-b3a7-c5d0cebcae05&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:35.580166Z"}}
{"data": {"description": "sql table model wellbefore.src_notifications", "execution_time": 4.809519, "index": 10, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:38.347744", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}, "status": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "10 of 18 OK created sql table model wellbefore.src_notifications ............... [\u001b[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)\u001b[0m in 4.81s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.347744Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:38.347744", "node_name": "src_notifications", "node_path": "src\\src_notifications.sql", "node_relation": {"alias": "src_notifications", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:33.538225", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_notifications"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "3e671740-5974-4a87-b3a7-c5d0cebcae05", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3748.0}, "execution_time": 4.809519, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:33.562452Z", "name": "compile", "started_at": "2024-11-20T06:17:33.538225Z"}, {"completed_at": "2024-11-20T06:17:38.347744Z", "name": "execute", "started_at": "2024-11-20T06:17:33.563450Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_notifications", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.347744Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_offer_change_trigger", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.347744Z"}}
{"data": {"description": "sql table model wellbefore.src_offer_change_trigger", "index": 11, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "11 of 18 START sql table model wellbefore.src_offer_change_trigger ............. [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.347744Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_offer_change_trigger", "orig_conn_name": "model.buy_box_gcp_1.src_notifications"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_notifications, now model.buy_box_gcp_1.src_offer_change_trigger)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.347744Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_offer_change_trigger", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.359302Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_offer_change_trigger\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.366490Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_offer_change_trigger", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.372896Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:38.378659Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_offer_change_trigger\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_offer_change_trigger\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:39.763712Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_offer_change_trigger", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_offer_change_trigger\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT\n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\n    FROM source_data\n\n)\n\n \n\nSELECT * FROM flatten_data\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_offer_change_trigger: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_offer_change_trigger\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_offer_change_trigger`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT\n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n        PARSE_JSON(data.message_body).Payload AS offer\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,\n\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\n\n    FROM source_data\n\n)\n\n \n\nSELECT * FROM flatten_data\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:39.765297Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2d4bd65f-91c0-45f0-80a5-608fa109c108&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:2d4bd65f-91c0-45f0-80a5-608fa109c108&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:40.476001Z"}}
{"data": {"description": "sql table model wellbefore.src_offer_change_trigger", "execution_time": 4.6625586, "index": 11, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:43.010302", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}, "status": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "11 of 18 OK created sql table model wellbefore.src_offer_change_trigger ........ [\u001b[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)\u001b[0m in 4.66s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:43.010302", "node_name": "src_offer_change_trigger", "node_path": "src\\src_offer_change_trigger.sql", "node_relation": {"alias": "src_offer_change_trigger", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:38.347744", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "2d4bd65f-91c0-45f0-80a5-608fa109c108", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3657.0}, "execution_time": 4.6625586, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:38.372896Z", "name": "compile", "started_at": "2024-11-20T06:17:38.361129Z"}, {"completed_at": "2024-11-20T06:17:43.010302Z", "name": "execute", "started_at": "2024-11-20T06:17:38.373844Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_offer_change_trigger", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_offers", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"description": "sql table model wellbefore.src_offers", "index": 12, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "12 of 18 START sql table model wellbefore.src_offers ........................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_offers", "orig_conn_name": "model.buy_box_gcp_1.src_offer_change_trigger"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offer_change_trigger, now model.buy_box_gcp_1.src_offers)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_offers", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.010302Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_offers\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.026606Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_offers", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.036735Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:43.043360Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_offers\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_offers\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:44.408651Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_offers", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_offers\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_offers`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        JSON_VALUE(raw_data, \"$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offer\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,\n\n        ASIN,\n\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n\n        JSON_VALUE(offer, \"$.IsBuyBoxWinner\") AS IsBuyBoxWinner,\n\n        JSON_VALUE(offer, \"$.ListingPrice.Amount\") AS ListingPriceAmount,\n\n        JSON_VALUE(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS IsOfferNationalPrime,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferPrime\") AS PrimeInformation\n\n    FROM flatten_data,\n\n    UNNEST(offer) AS offer\n\n)\n\n\n\nSELECT * \n\nFROM flatten_data_1\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_offers: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_offers\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_offers`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        JSON_VALUE(raw_data, \"$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offer\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,\n\n        ASIN,\n\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n\n        JSON_VALUE(offer, \"$.IsBuyBoxWinner\") AS IsBuyBoxWinner,\n\n        JSON_VALUE(offer, \"$.ListingPrice.Amount\") AS ListingPriceAmount,\n\n        JSON_VALUE(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS IsOfferNationalPrime,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferPrime\") AS PrimeInformation\n\n    FROM flatten_data,\n\n    UNNEST(offer) AS offer\n\n)\n\n\n\nSELECT * \n\nFROM flatten_data_1\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:44.408651Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3f0acd28-fa7d-45dd-a314-43f90b073357&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:3f0acd28-fa7d-45dd-a314-43f90b073357&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:45.094069Z"}}
{"data": {"description": "sql table model wellbefore.src_offers", "execution_time": 4.870852, "index": 12, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:47.881154", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}, "status": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "12 of 18 OK created sql table model wellbefore.src_offers ...................... [\u001b[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)\u001b[0m in 4.87s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.881154Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:47.881154", "node_name": "src_offers", "node_path": "src\\src_offers.sql", "node_relation": {"alias": "src_offers", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:43.010302", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_offers"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "3f0acd28-fa7d-45dd-a314-43f90b073357", "location": "US", "project_id": "dbt-437212", "rows_affected": 172.0, "slot_ms": 14005.0}, "execution_time": 4.870852, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:43.035555Z", "name": "compile", "started_at": "2024-11-20T06:17:43.010302Z"}, {"completed_at": "2024-11-20T06:17:47.881154Z", "name": "execute", "started_at": "2024-11-20T06:17:43.036735Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_offers", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.881154Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_products", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.881154Z"}}
{"data": {"description": "sql table model wellbefore.src_products", "index": 13, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "13 of 18 START sql table model wellbefore.src_products ......................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.881154Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_products", "orig_conn_name": "model.buy_box_gcp_1.src_offers"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_offers, now model.buy_box_gcp_1.src_products)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.891846Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_products", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.895112Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_products\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.917201Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_products", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.918446Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:47.929411Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_products\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_products\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:49.209524Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_products", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_products\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_products`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId\n\n    FROM source_data\n\n)\n\nSELECT * FROM flatten_data\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_products: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_products\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_products`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data,\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\n\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId\n\n    FROM source_data\n\n)\n\nSELECT * FROM flatten_data\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:49.209524Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d059c9df-c5cb-400e-8359-bedf1864d3c3&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d059c9df-c5cb-400e-8359-bedf1864d3c3&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:49.908729Z"}}
{"data": {"description": "sql table model wellbefore.src_products", "execution_time": 4.779476, "index": 13, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:52.660630", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}, "status": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "13 of 18 OK created sql table model wellbefore.src_products .................... [\u001b[32mCREATE TABLE (20.0 rows, 120.8 KiB processed)\u001b[0m in 4.78s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.660630Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:52.660630", "node_name": "src_products", "node_path": "src\\src_products.sql", "node_relation": {"alias": "src_products", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:47.881154", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_products"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "d059c9df-c5cb-400e-8359-bedf1864d3c3", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3115.0}, "execution_time": 4.779476, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:47.918446Z", "name": "compile", "started_at": "2024-11-20T06:17:47.897095Z"}, {"completed_at": "2024-11-20T06:17:52.660630Z", "name": "execute", "started_at": "2024-11-20T06:17:47.919457Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_products", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.660630Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_sales_ranking", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.660630Z"}}
{"data": {"description": "sql table model wellbefore.src_sales_ranking", "index": 14, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "14 of 18 START sql table model wellbefore.src_sales_ranking .................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.660630Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_sales_ranking", "orig_conn_name": "model.buy_box_gcp_1.src_products"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_products, now model.buy_box_gcp_1.src_sales_ranking)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.675814Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_sales_ranking", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.676921Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_sales_ranking\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.682211Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_sales_ranking", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.693856Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:52.694644Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_sales_ranking\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_sales_ranking\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:54.075886Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_sales_ranking", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_sales_ranking\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        ASIN,\n\n        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,\n\n        JSON_EXTRACT(sr, '$.Rank') AS Ranking\n\n    FROM flatten_payload, UNNEST(SalesRankings) AS sr \n\n)\n\nSELECT * FROM flatten_offers\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_sales_ranking: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_sales_ranking\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_sales_ranking`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      WITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        ASIN,\n\n        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,\n\n        JSON_EXTRACT(sr, '$.Rank') AS Ranking\n\n    FROM flatten_payload, UNNEST(SalesRankings) AS sr \n\n)\n\nSELECT * FROM flatten_offers\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:54.075886Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7e58c87e-4faf-4717-afee-96c07f54b4b9&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:7e58c87e-4faf-4717-afee-96c07f54b4b9&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:54.846393Z"}}
{"data": {"description": "sql table model wellbefore.src_sales_ranking", "execution_time": 4.9502788, "index": 14, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:57.626093", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}, "status": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "14 of 18 OK created sql table model wellbefore.src_sales_ranking ............... [\u001b[32mCREATE TABLE (43.0 rows, 120.8 KiB processed)\u001b[0m in 4.95s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.626093Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:17:57.626093", "node_name": "src_sales_ranking", "node_path": "src\\src_sales_ranking.sql", "node_relation": {"alias": "src_sales_ranking", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:52.660630", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_sales_ranking"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "7e58c87e-4faf-4717-afee-96c07f54b4b9", "location": "US", "project_id": "dbt-437212", "rows_affected": 43.0, "slot_ms": 4898.0}, "execution_time": 4.9502788, "message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:52.692905Z", "name": "compile", "started_at": "2024-11-20T06:17:52.676921Z"}, {"completed_at": "2024-11-20T06:17:57.626093Z", "name": "execute", "started_at": "2024-11-20T06:17:52.694644Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_sales_ranking", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.626093Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.src_shipping", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.626093Z"}}
{"data": {"description": "sql table model wellbefore.src_shipping", "index": 15, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "15 of 18 START sql table model wellbefore.src_shipping ......................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.642975Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_shipping", "orig_conn_name": "model.buy_box_gcp_1.src_sales_ranking"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_sales_ranking, now model.buy_box_gcp_1.src_shipping)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.642975Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.src_shipping", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.642975Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.src_shipping\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.650434Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.src_shipping", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.651522Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:57.654785Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_shipping\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.src_shipping\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:59.007898Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.src_shipping", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_shipping\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      -- WITH source_data AS (\n\n--     SELECT \n\n--         PARSE_JSON(data.message_body) AS raw_data,\n\n--     FROM \n\n--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\n\n-- ),\n\n-- flatten_data AS (\n\n--     SELECT\n\n--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers\n\n--     FROM source_data\n\n-- )\n\n-- SELECT\n\n--     NotificationId,\n\n--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,\n\n--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,\n\n--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,\n\n--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,\n\n--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,\n\n--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,\n\n-- FROM\n\n--     flatten_data, UNNEST(offers) AS offers\n\n\n\nWITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        NotificationId,\n\n        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,\n\n        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,\n\n        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically\n\n\n\n    FROM flatten_payload, UNNEST(offers) AS offer \n\n)\n\nSELECT * FROM flatten_offers\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.src_shipping: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.src_shipping\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`src_shipping`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      -- WITH source_data AS (\n\n--     SELECT \n\n--         PARSE_JSON(data.message_body) AS raw_data,\n\n--     FROM \n\n--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\n\n-- ),\n\n-- flatten_data AS (\n\n--     SELECT\n\n--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers\n\n--     FROM source_data\n\n-- )\n\n-- SELECT\n\n--     NotificationId,\n\n--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,\n\n--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,\n\n--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,\n\n--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,\n\n--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,\n\n--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,\n\n-- FROM\n\n--     flatten_data, UNNEST(offers) AS offers\n\n\n\nWITH source_data AS (\n\n    SELECT \n\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,\n\n      PARSE_JSON(data.message_body) as parse_data\n\n    FROM `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` as data\n\n),\n\nflatten_payload AS (\n\n    SELECT \n\n        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,\n\n        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers\n\n    FROM source_data\n\n),\n\nflatten_offers AS (\n\n    SELECT \n\n        GENERATE_UUID() as SurrogateKey,\n\n        NotificationId,\n\n        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,\n\n        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,\n\n        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,\n\n        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically\n\n\n\n    FROM flatten_payload, UNNEST(offers) AS offer \n\n)\n\nSELECT * FROM flatten_offers\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:59.010084Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:65a1dd57-d9da-48bd-9764-96c052bdd504&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:65a1dd57-d9da-48bd-9764-96c052bdd504&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:17:59.688510Z"}}
{"data": {"description": "sql table model wellbefore.src_shipping", "execution_time": 4.4857817, "index": 15, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:18:02.128757", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}, "status": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "15 of 18 OK created sql table model wellbefore.src_shipping .................... [\u001b[32mCREATE TABLE (172.0 rows, 120.8 KiB processed)\u001b[0m in 4.49s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.129758Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:18:02.128757", "node_name": "src_shipping", "node_path": "src\\src_shipping.sql", "node_relation": {"alias": "src_shipping", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:17:57.626093", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.src_shipping"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "65a1dd57-d9da-48bd-9764-96c052bdd504", "location": "US", "project_id": "dbt-437212", "rows_affected": 172.0, "slot_ms": 3184.0}, "execution_time": 4.4857817, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:57.651522Z", "name": "compile", "started_at": "2024-11-20T06:17:57.642975Z"}, {"completed_at": "2024-11-20T06:18:02.128757Z", "name": "execute", "started_at": "2024-11-20T06:17:57.652545Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.src_shipping", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.130757Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "started", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node seed.buy_box_gcp_1.B00KJ75ISS_1_month", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.131771Z"}}
{"data": {"description": "seed file wellbefore.B00KJ75ISS_1_month", "index": 16, "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "started", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "16 of 18 START seed file wellbefore.B00KJ75ISS_1_month ......................... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.132767Z"}}
{"data": {"conn_name": "seed.buy_box_gcp_1.B00KJ75ISS_1_month", "orig_conn_name": "model.buy_box_gcp_1.src_shipping"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.buy_box_gcp_1.src_shipping, now seed.buy_box_gcp_1.B00KJ75ISS_1_month)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.133768Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "compiling", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node seed.buy_box_gcp_1.B00KJ75ISS_1_month", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.134773Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node seed.buy_box_gcp_1.B00KJ75ISS_1_month", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:02.135775Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:03.045209Z"}}
{"data": {"conn_name": "seed.buy_box_gcp_1.B00KJ75ISS_1_month", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"seed.buy_box_gcp_1.B00KJ75ISS_1_month\"} */\n\n    alter table `dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month` set OPTIONS()\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On seed.buy_box_gcp_1.B00KJ75ISS_1_month: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"seed.buy_box_gcp_1.B00KJ75ISS_1_month\"} */\n\n    alter table `dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month` set OPTIONS()\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:23.448367Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fbdca239-d1c9-4fd7-8eb3-356adf4acbe1&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:fbdca239-d1c9-4fd7-8eb3-356adf4acbe1&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:24.046165Z"}}
{"data": {"msg": "Writing runtime SQL for node \"seed.buy_box_gcp_1.B00KJ75ISS_1_month\"", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime SQL for node \"seed.buy_box_gcp_1.B00KJ75ISS_1_month\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.071257Z"}}
{"data": {"execution_time": 22.953094, "index": 16, "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "2024-11-20T06:18:25.086863", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "success", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}, "relation": "B00KJ75ISS_1_month", "result_message": "INSERT 4834", "schema": "wellbefore", "status": "success", "total": 18}, "info": {"category": "", "code": "Q016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "16 of 18 OK loaded seed file wellbefore.B00KJ75ISS_1_month ..................... [\u001b[32mINSERT 4834\u001b[0m in 22.95s]", "name": "LogSeedResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "2024-11-20T06:18:25.086863", "node_name": "B00KJ75ISS_1_month", "node_path": "B00KJ75ISS_1_month.csv", "node_relation": {"alias": "B00KJ75ISS_1_month", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`B00KJ75ISS_1_month`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:02.131771", "node_status": "success", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}, "run_result": {"adapter_response": {"_message": "INSERT 4834", "code": "INSERT", "rows_affected": 4834.0}, "execution_time": 22.953094, "message": "INSERT 4834", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:02.135775Z", "name": "compile", "started_at": "2024-11-20T06:18:02.135775Z"}, {"completed_at": "2024-11-20T06:18:25.086863Z", "name": "execute", "started_at": "2024-11-20T06:18:02.137767Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node seed.buy_box_gcp_1.B00KJ75ISS_1_month", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "started", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"description": "seed file wellbefore.BuyBox_raw_ds_first20_entries", "index": 17, "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "started", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "17 of 18 START seed file wellbefore.BuyBox_raw_ds_first20_entries .............. [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"conn_name": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "orig_conn_name": "seed.buy_box_gcp_1.B00KJ75ISS_1_month"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly seed.buy_box_gcp_1.B00KJ75ISS_1_month, now seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "compiling", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.086863Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:25.099035Z"}}
{"data": {"conn_name": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries\"} */\n\n    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries\"} */\n\n    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:32.470430Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a30a5b73-ffd4-41f5-8339-ced6abd4949d&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:a30a5b73-ffd4-41f5-8339-ced6abd4949d&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.149583Z"}}
{"data": {"msg": "Writing runtime SQL for node \"seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries\"", "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "executing", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime SQL for node \"seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.985872Z"}}
{"data": {"execution_time": 8.9005375, "index": 17, "node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "2024-11-20T06:18:33.987400", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "success", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}, "relation": "BuyBox_raw_ds_first20_entries", "result_message": "INSERT 20", "schema": "wellbefore", "status": "success", "total": 18}, "info": {"category": "", "code": "Q016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "17 of 18 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries .......... [\u001b[32mINSERT 20\u001b[0m in 8.90s]", "name": "LogSeedResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"node_info": {"materialized": "seed", "meta": {}, "node_finished_at": "2024-11-20T06:18:33.987400", "node_name": "BuyBox_raw_ds_first20_entries", "node_path": "BuyBox_raw_ds_first20_entries.csv", "node_relation": {"alias": "BuyBox_raw_ds_first20_entries", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:25.086863", "node_status": "success", "resource_type": "seed", "unique_id": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}, "run_result": {"adapter_response": {"_message": "INSERT 20", "code": "INSERT", "rows_affected": 20.0}, "execution_time": 8.9005375, "message": "INSERT 20", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:25.086863Z", "name": "compile", "started_at": "2024-11-20T06:18:25.086863Z"}, {"completed_at": "2024-11-20T06:18:33.987400Z", "name": "execute", "started_at": "2024-11-20T06:18:25.086863Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began running node model.buy_box_gcp_1.variable_summary_table", "name": "NodeStart", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"description": "sql table model wellbefore.variable_summary_table", "index": 18, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "started", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}, "total": 18}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "18 of 18 START sql table model wellbefore.variable_summary_table ............... [RUN]", "name": "LogStartLine", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.variable_summary_table", "orig_conn_name": "seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Re-using an available connection from the pool (formerly seed.buy_box_gcp_1.BuyBox_raw_ds_first20_entries, now model.buy_box_gcp_1.variable_summary_table)", "name": "ConnectionReused", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began compiling node model.buy_box_gcp_1.variable_summary_table", "name": "NodeCompiling", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:33.987400Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "compiling", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing injected SQL for node \"model.buy_box_gcp_1.variable_summary_table\"", "name": "WritingInjectedSQLForNode", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:34.005067Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Began executing node model.buy_box_gcp_1.variable_summary_table", "name": "NodeExecuting", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:34.007162Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:34.011269Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.buy_box_gcp_1.variable_summary_table\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Writing runtime sql for node \"model.buy_box_gcp_1.variable_summary_table\"", "name": "JinjaLogDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:35.261298Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.variable_summary_table", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.variable_summary_table\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      \n\nWITH base AS (\n    SELECT \n        offers.ASIN,\n        offers.SELLERID,\n        offers.NOTIFICATIONID,\n        offers.ISBUYBOXWINNER,\n        offers.ISOFFERPRIME,\n        offers.SHIPSDOMESTICALLY,\n        offers.PUBLISHTIME,\n        offers.LISTINGPRICEAMOUNT,\n        offers.SELLERFEEDBACKCOUNT,\n        offers.SELLERPOSITIVEFEEDBACKRATING,\n        offers.SHIPPINGAMOUNT,\n        offers.SHIPPINGMINHOURS,\n        offers.SHIPPINGMAXHOURS,\n        summary.BUYBOXLISTINGPRICEAMOUNT,\n\n        -- Difference between seller's listing price and mean listing price at publish time.\n        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,\n        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,\n\n        -- Difference between seller's listing price and lowest listing price at publish time.\n        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,\n        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,\n\n        -- Difference between seller's average shipping hours and mean average hours at publish time.\n        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,\n\n        -- Difference between seller's average shipping hours and lowest average hours at publish time.\n        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,\n        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,\n\n        -- Difference between seller's feedback count and mean feedback count at publish time.\n        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,\n\n        -- Difference between seller's feedback count and highest feedback count at publish time.\n        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,\n\n        -- Difference between seller's feedback rating and mean feedback rating at publish time.\n        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,\n\n        -- Difference between seller's feedback rating and highest feedback rating at publish time.\n        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,\n\n        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).\n        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,\n\n        -- Ratio of seller's rating to their listing price (rating per dollar).\n        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,\n\n        -- Ratio of seller's feedback count to their listing price (feedback per dollar).\n        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,\n\n        -- Ratio between seller's current listing price and their BuyBox listing price.\n        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,\n\n        -- Total number of assessments or reviews the product has received from customers.\n        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,\n\n        -- Indicates if the seller is domestic (1=True, 0=False).\n        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,\n\n        -- Cost of shipping the product offered by the seller.\n        offers.ShippingAmount AS shipping_price,\n\n        -- Estimated shipping time (in hours).\n        offers.ShippingMaxHours AS shipping_time_in_hours\n\n    FROM \n    `dbt-437212`.`wellbefore`.`dim_offers_values` AS offers\n\nLEFT JOIN \n        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary\n    ON \n        offers.NotificationId = summary.NotificationId\n)\n\nSELECT * FROM base\nORDER BY ASIN\n    );\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "On model.buy_box_gcp_1.variable_summary_table: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"buy_box_gcp_1\", \"target_name\": \"dev\", \"node_id\": \"model.buy_box_gcp_1.variable_summary_table\"} */\n\n  \n    \n\n    create or replace table `dbt-437212`.`wellbefore`.`variable_summary_table`\n      \n    \n    \n\n    OPTIONS()\n    as (\n      \n\nWITH base AS (\n    SELECT \n        offers.ASIN,\n        offers.SELLERID,\n        offers.NOTIFICATIONID,\n        offers.ISBUYBOXWINNER,\n        offers.ISOFFERPRIME,\n        offers.SHIPSDOMESTICALLY,\n        offers.PUBLISHTIME,\n        offers.LISTINGPRICEAMOUNT,\n        offers.SELLERFEEDBACKCOUNT,\n        offers.SELLERPOSITIVEFEEDBACKRATING,\n        offers.SHIPPINGAMOUNT,\n        offers.SHIPPINGMINHOURS,\n        offers.SHIPPINGMAXHOURS,\n        summary.BUYBOXLISTINGPRICEAMOUNT,\n\n        -- Difference between seller's listing price and mean listing price at publish time.\n        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,\n        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,\n\n        -- Difference between seller's listing price and lowest listing price at publish time.\n        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,\n        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,\n\n        -- Difference between seller's average shipping hours and mean average hours at publish time.\n        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,\n\n        -- Difference between seller's average shipping hours and lowest average hours at publish time.\n        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,\n        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,\n\n        -- Difference between seller's feedback count and mean feedback count at publish time.\n        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,\n\n        -- Difference between seller's feedback count and highest feedback count at publish time.\n        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,\n\n        -- Difference between seller's feedback rating and mean feedback rating at publish time.\n        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,\n\n        -- Difference between seller's feedback rating and highest feedback rating at publish time.\n        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,\n\n        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).\n        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,\n\n        -- Ratio of seller's rating to their listing price (rating per dollar).\n        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,\n\n        -- Ratio of seller's feedback count to their listing price (feedback per dollar).\n        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,\n\n        -- Ratio between seller's current listing price and their BuyBox listing price.\n        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,\n\n        -- Total number of assessments or reviews the product has received from customers.\n        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,\n\n        -- Indicates if the seller is domestic (1=True, 0=False).\n        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,\n\n        -- Cost of shipping the product offered by the seller.\n        offers.ShippingAmount AS shipping_price,\n\n        -- Estimated shipping time (in hours).\n        offers.ShippingMaxHours AS shipping_time_in_hours\n\n    FROM \n    `dbt-437212`.`wellbefore`.`dim_offers_values` AS offers\n\nLEFT JOIN \n        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary\n    ON \n        offers.NotificationId = summary.NotificationId\n)\n\nSELECT * FROM base\nORDER BY ASIN\n    );\n  ", "name": "SQLQuery", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:35.261298Z"}}
{"data": {"args": [], "base_msg": "https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:451c2882-8444-4869-a09c-73eeebe889ad&page=queryresults", "name": "BigQuery", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "executing", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:451c2882-8444-4869-a09c-73eeebe889ad&page=queryresults", "name": "AdapterEventDebug", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:36.059489Z"}}
{"data": {"description": "sql table model wellbefore.variable_summary_table", "execution_time": 5.537177, "index": 18, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:18:39.524577", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}, "status": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "total": 18}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "18 of 18 OK created sql table model wellbefore.variable_summary_table .......... [\u001b[32mCREATE TABLE (2.1k rows, 120.8 KiB processed)\u001b[0m in 5.54s]", "name": "LogModelResult", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:39.524577Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-20T06:18:39.524577", "node_name": "variable_summary_table", "node_path": "dim\\variable_summary_table.sql", "node_relation": {"alias": "variable_summary_table", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`", "schema": "wellbefore"}, "node_started_at": "2024-11-20T06:18:33.987400", "node_status": "success", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.variable_summary_table"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "451c2882-8444-4869-a09c-73eeebe889ad", "location": "US", "project_id": "dbt-437212", "rows_affected": 2143.0, "slot_ms": 43311.0}, "execution_time": 5.537177, "message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:34.007162Z", "name": "compile", "started_at": "2024-11-20T06:18:34.000408Z"}, {"completed_at": "2024-11-20T06:18:39.524577Z", "name": "execute", "started_at": "2024-11-20T06:18:34.008172Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Finished running node model.buy_box_gcp_1.variable_summary_table", "name": "NodeFinished", "pid": 38152, "thread": "Thread-1 (worker)", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"conn_name": "list_dbt-437212"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Connection 'list_dbt-437212' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"conn_name": "list_dbt-437212_wellbefore"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Connection 'list_dbt-437212_wellbefore' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"conn_name": "model.buy_box_gcp_1.variable_summary_table"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Connection 'model.buy_box_gcp_1.variable_summary_table' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.540174Z"}}
{"data": {"execution": " in 0 hours 1 minutes and 42.27 seconds", "execution_time": 102.265884, "stat_line": "6 view models, 10 table models, 2 seeds"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Finished running 6 view models, 10 table models, 2 seeds in 0 hours 1 minutes and 42.27 seconds (102.27s).", "name": "FinishedRunningStats", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.555130Z"}}
{"data": {"elapsed_time": 102.265884, "generated_at": "2024-11-20T06:18:39Z", "results": [{"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "11c338f4-ff70-472a-984c-5eaf45c97950", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.550102, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:01.649100Z", "name": "compile", "started_at": "2024-11-20T06:17:01.634337Z"}, {"completed_at": "2024-11-20T06:17:04.174822Z", "name": "execute", "started_at": "2024-11-20T06:17:01.649100Z"}]}, {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "0717f1c5-a969-413d-bf12-08aa2809640e", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.5584803, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:04.198285Z", "name": "compile", "started_at": "2024-11-20T06:17:04.192257Z"}, {"completed_at": "2024-11-20T06:17:06.741966Z", "name": "execute", "started_at": "2024-11-20T06:17:04.199665Z"}]}, {"adapter_response": {}, "execution_time": 4.017726, "message": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "num_failures": 0, "status": "error", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:06.771851Z", "name": "compile", "started_at": "2024-11-20T06:17:06.759293Z"}, {"completed_at": "2024-11-20T06:17:10.757935Z", "name": "execute", "started_at": "2024-11-20T06:17:06.774140Z"}]}, {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "7b0ef210-afd5-4cc1-a0eb-6ca43a2a792f", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.411177, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:10.812913Z", "name": "compile", "started_at": "2024-11-20T06:17:10.798526Z"}, {"completed_at": "2024-11-20T06:17:13.207996Z", "name": "execute", "started_at": "2024-11-20T06:17:10.812913Z"}]}, {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "c80b029e-46ee-422b-9de6-d81fae5e70fa", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.5187676, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:13.207996Z", "name": "compile", "started_at": "2024-11-20T06:17:13.207996Z"}, {"completed_at": "2024-11-20T06:17:15.726763Z", "name": "execute", "started_at": "2024-11-20T06:17:13.207996Z"}]}, {"adapter_response": {"_message": "CREATE VIEW (0 processed)", "bytes_billed": 0.0, "bytes_processed": 0.0, "code": "CREATE VIEW", "job_id": "dcd09ad5-1299-45f8-8eef-e82a6202deb5", "location": "US", "project_id": "dbt-437212", "slot_ms": 0.0}, "execution_time": 2.4648623, "message": "CREATE VIEW (0 processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:15.743953Z", "name": "compile", "started_at": "2024-11-20T06:17:15.743953Z"}, {"completed_at": "2024-11-20T06:17:18.208816Z", "name": "execute", "started_at": "2024-11-20T06:17:15.743953Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "2b1372b1-0556-49ce-ac75-c1c201258352", "location": "US", "project_id": "dbt-437212", "rows_affected": 44.0, "slot_ms": 4396.0}, "execution_time": 5.039464, "message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:18.231208Z", "name": "compile", "started_at": "2024-11-20T06:17:18.208816Z"}, {"completed_at": "2024-11-20T06:17:23.248280Z", "name": "execute", "started_at": "2024-11-20T06:17:18.232817Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "9a701bc8-5fff-4ed4-bf0c-c0f3b77a6b21", "location": "US", "project_id": "dbt-437212", "rows_affected": 28.0, "slot_ms": 5005.0}, "execution_time": 5.250907, "message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:23.276323Z", "name": "compile", "started_at": "2024-11-20T06:17:23.266277Z"}, {"completed_at": "2024-11-20T06:17:28.514945Z", "name": "execute", "started_at": "2024-11-20T06:17:23.279876Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "8746235c-b51f-45f5-bc7b-f1f1d0bc4937", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 5237.0}, "execution_time": 5.008395, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:28.536327Z", "name": "compile", "started_at": "2024-11-20T06:17:28.516736Z"}, {"completed_at": "2024-11-20T06:17:33.525131Z", "name": "execute", "started_at": "2024-11-20T06:17:28.537328Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "3e671740-5974-4a87-b3a7-c5d0cebcae05", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3748.0}, "execution_time": 4.809519, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:33.562452Z", "name": "compile", "started_at": "2024-11-20T06:17:33.538225Z"}, {"completed_at": "2024-11-20T06:17:38.347744Z", "name": "execute", "started_at": "2024-11-20T06:17:33.563450Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "2d4bd65f-91c0-45f0-80a5-608fa109c108", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3657.0}, "execution_time": 4.6625586, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:38.372896Z", "name": "compile", "started_at": "2024-11-20T06:17:38.361129Z"}, {"completed_at": "2024-11-20T06:17:43.010302Z", "name": "execute", "started_at": "2024-11-20T06:17:38.373844Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "3f0acd28-fa7d-45dd-a314-43f90b073357", "location": "US", "project_id": "dbt-437212", "rows_affected": 172.0, "slot_ms": 14005.0}, "execution_time": 4.870852, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:43.035555Z", "name": "compile", "started_at": "2024-11-20T06:17:43.010302Z"}, {"completed_at": "2024-11-20T06:17:47.881154Z", "name": "execute", "started_at": "2024-11-20T06:17:43.036735Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "d059c9df-c5cb-400e-8359-bedf1864d3c3", "location": "US", "project_id": "dbt-437212", "rows_affected": 20.0, "slot_ms": 3115.0}, "execution_time": 4.779476, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:47.918446Z", "name": "compile", "started_at": "2024-11-20T06:17:47.897095Z"}, {"completed_at": "2024-11-20T06:17:52.660630Z", "name": "execute", "started_at": "2024-11-20T06:17:47.919457Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "7e58c87e-4faf-4717-afee-96c07f54b4b9", "location": "US", "project_id": "dbt-437212", "rows_affected": 43.0, "slot_ms": 4898.0}, "execution_time": 4.9502788, "message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:52.692905Z", "name": "compile", "started_at": "2024-11-20T06:17:52.676921Z"}, {"completed_at": "2024-11-20T06:17:57.626093Z", "name": "execute", "started_at": "2024-11-20T06:17:52.694644Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "65a1dd57-d9da-48bd-9764-96c052bdd504", "location": "US", "project_id": "dbt-437212", "rows_affected": 172.0, "slot_ms": 3184.0}, "execution_time": 4.4857817, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:17:57.651522Z", "name": "compile", "started_at": "2024-11-20T06:17:57.642975Z"}, {"completed_at": "2024-11-20T06:18:02.128757Z", "name": "execute", "started_at": "2024-11-20T06:17:57.652545Z"}]}, {"adapter_response": {"_message": "INSERT 4834", "code": "INSERT", "rows_affected": 4834.0}, "execution_time": 22.953094, "message": "INSERT 4834", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:02.135775Z", "name": "compile", "started_at": "2024-11-20T06:18:02.135775Z"}, {"completed_at": "2024-11-20T06:18:25.086863Z", "name": "execute", "started_at": "2024-11-20T06:18:02.137767Z"}]}, {"adapter_response": {"_message": "INSERT 20", "code": "INSERT", "rows_affected": 20.0}, "execution_time": 8.9005375, "message": "INSERT 20", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:25.086863Z", "name": "compile", "started_at": "2024-11-20T06:18:25.086863Z"}, {"completed_at": "2024-11-20T06:18:33.987400Z", "name": "execute", "started_at": "2024-11-20T06:18:25.086863Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "bytes_billed": 10485760.0, "bytes_processed": 123696.0, "code": "CREATE TABLE", "job_id": "451c2882-8444-4869-a09c-73eeebe889ad", "location": "US", "project_id": "dbt-437212", "rows_affected": 2143.0, "slot_ms": 43311.0}, "execution_time": 5.537177, "message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-20T06:18:34.007162Z", "name": "compile", "started_at": "2024-11-20T06:18:34.000408Z"}, {"completed_at": "2024-11-20T06:18:39.524577Z", "name": "execute", "started_at": "2024-11-20T06:18:34.008172Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.560002Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.626427Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "\u001b[31mCompleted with 1 error and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.627454Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.627454Z"}}
{"data": {"msg": "Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "dim_all_columns_using_join", "node_path": "dim\\dim_all_columns_using_join.sql", "node_relation": {"alias": "dim_all_columns_using_join", "database": "dbt-437212", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns_using_join`", "schema": "wellbefore"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.buy_box_gcp_1.dim_all_columns_using_join"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "error", "msg": "  Database Error in model dim_all_columns_using_join (models\\dim\\dim_all_columns_using_join.sql)\n  CREATE VIEW has columns with duplicate name EventTime at [6:6]\n  compiled Code at target\\buy_box_gcp_1_dbt_assets-554a77f-7b79a08\\run\\buy_box_gcp_1\\models\\dim\\dim_all_columns_using_join.sql", "name": "RunResultError", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.629598Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "", "name": "Formatting", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.629598Z"}}
{"data": {"stats": {"error": 1, "pass": 17, "skip": 0, "total": 18, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "info", "msg": "Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18", "name": "StatsLine", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.629598Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-11-20T06:18:39.629598Z", "elapsed": 104.425804, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Command `dbt build` failed at 11:48:39.629598 after 104.43 seconds", "name": "CommandCompleted", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.629598Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "0ffdc667-4a09-4c6e-8c1a-e9b070b8ab27", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 38152, "thread": "MainThread", "ts": "2024-11-20T06:18:39.629598Z"}}
